[{"id":"ee99e200.220c5","type":"tab","label":"Flow 1","disabled":false,"info":""},{"id":"b7ea2501.259358","type":"tab","label":"switch","disabled":false,"info":""},{"id":"b6f7a7df.51a0e8","type":"tab","label":"Artist Menu","disabled":false,"info":""},{"id":"902edb22.d683d8","type":"tab","label":"Buyer Menu","disabled":false,"info":""},{"id":"7edc0cb0.8be9f4","type":"tab","label":"Contact with administrator","disabled":false,"info":""},{"id":"e35da61b.7ab028","type":"tab","label":"Base actions","disabled":false,"info":""},{"id":"85a5817c.1b7c5","type":"ui_tab","z":"","name":"Demo Tab Name","icon":"dashboard","disabled":false,"hidden":false},{"id":"7e6baf98.69239","type":"ui_group","z":"","name":"TEXT DEMO","tab":"85a5817c.1b7c5","order":1,"disp":true,"width":"6","collapse":false},{"id":"2dab8e98.6c5e72","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"39c087f6.158d88","type":"mqtt-broker","z":"","name":"","broker":"cow.rmq2.cloudamqp.com","port":"1883","clientid":"","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"c808fc29.f54e2","type":"dialogflowv2-token","z":"","name":"pdp-ira-bot-nqgr"},{"id":"4ebb61a7.26508","type":"mqtt-broker","z":"","name":"","broker":"cow.rmq2.cloudamqp.com","port":"1883","clientid":"","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"2da1a901.60cf06","type":"dialogflowv2-token","z":"","name":"pdp-ira-bot-nqgr"},{"id":"aab63993.aecb28","type":"http in","z":"ee99e200.220c5","name":"","url":"/webhook","method":"post","upload":false,"swaggerDoc":"","x":140,"y":120,"wires":[["bcfa7568.865768","a26de04b.51f91","85e29d7a.ee53"]]},{"id":"a26de04b.51f91","type":"debug","z":"ee99e200.220c5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":110,"y":80,"wires":[]},{"id":"bcfa7568.865768","type":"http response","z":"ee99e200.220c5","name":"","statusCode":"200","headers":{},"x":160,"y":160,"wires":[]},{"id":"65de9ef7.2c2ac","type":"function","z":"ee99e200.220c5","name":"","func":"if (msg.payload && msg.payload.callback_query) {\n    msg.text = msg.payload.callback_query.data;\n    msg.chat_id = msg.payload.callback_query.from.id;\n}\n\nif (msg.payload && msg.payload.message && msg.payload.message.contact) {\n    msg.text = msg.payload.message.contact.phone_number;\n    msg.chat_id = msg.payload.message.from.id;\n} else if (msg.payload && msg.payload.message && msg.payload.message.photo) {\n    msg.text = msg.payload.message.photo[1].file_id;\n    msg.chat_id = msg.payload.message.from.id;\n} else if (msg.payload && msg.payload.message && msg.payload.message.successful_payment) {\n    msg.text = msg.payload.message.successful_payment.invoice_payload;\n    msg.chat_id = msg.payload.message.from.id;\n} else if (msg.payload && msg.payload.message) {\n    msg.text = msg.payload.message.text;\n    msg.chat_id = msg.payload.message.from.id;\n}\n\n\nmsg.originalMessage = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":220,"wires":[["22377df7.05be42","54662e27.cb778"]]},{"id":"22377df7.05be42","type":"debug","z":"ee99e200.220c5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":690,"y":180,"wires":[]},{"id":"54662e27.cb778","type":"function","z":"ee99e200.220c5","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.chat_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":220,"wires":[["6cd24235.99836c","ad8fa9b.4de5958"]]},{"id":"6cd24235.99836c","type":"http request","z":"ee99e200.220c5","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1030,"y":220,"wires":[["51e2a8d3.5bce58"]]},{"id":"51e2a8d3.5bce58","type":"function","z":"ee99e200.220c5","name":"","func":"msg.lang = msg.payload.lang;\nmsg.type = msg.payload.type;\nmsg.nickname = msg.payload.nickname;\nmsg.phone = msg.payload.phone;\nmsg.state = msg.payload.state;\nmsg.settings = msg.payload.settings;\n\n\nmsg.picture = msg.payload.picture;\nif (msg.payload.settings){\nmsg.currentViewPicture = msg.payload.settings.currentViewPicture;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1180,"y":220,"wires":[["b1a56e0d.326a","4e5db960.ed6618"]]},{"id":"dcf449c3.ac8708","type":"switch","z":"b7ea2501.259358","name":"Artist ","property":"text","propertyType":"msg","rules":[{"t":"eq","v":"/start","vt":"str"},{"t":"regex","v":"((\\+38)?\\(?\\d{3}\\)?[\\s\\.-]?(\\d{7}|\\d{3}[\\s\\.-]\\d{2}[\\s\\.-]\\d{2}|\\d{3}-\\d{4}))","vt":"str","case":false},{"t":"eq","v":"uk","vt":"str"},{"t":"eq","v":"ru","vt":"str"},{"t":"eq","v":"en","vt":"str"},{"t":"eq","v":"artist","vt":"str"},{"t":"eq","v":"buyer","vt":"str"},{"t":"eq","v":"changeTypeToBuyer","vt":"str"},{"t":"eq","v":"artActionsWithPicturesHello","vt":"str"},{"t":"eq","v":"actionsWithPictures","vt":"str"},{"t":"eq","v":"advertisingPicture","vt":"str"},{"t":"eq","v":"advertising","vt":"str"},{"t":"eq","v":"viewStatistics","vt":"str"},{"t":"eq","v":"viewApplications","vt":"str"},{"t":"eq","v":"contactWithAdministrator","vt":"str"},{"t":"eq","v":"setting","vt":"str"},{"t":"eq","v":"exhibitPicture","vt":"str"},{"t":"eq","v":"editPostOfPicture","vt":"str"},{"t":"eq","v":"deletePainting","vt":"str"},{"t":"eq","v":"backToArtistMenu","vt":"str"},{"t":"cont","v":"categId","vt":"str"},{"t":"eq","v":"viewCreatedPost","vt":"str"},{"t":"eq","v":"moreAboutAdvertising","vt":"str"},{"t":"eq","v":"toAdvertisingPicture","vt":"str"},{"t":"eq","v":"artActionsPostPictureImage","vt":"str"},{"t":"eq","v":"artActionsPostPictureDescript","vt":"str"},{"t":"eq","v":"artActionsPostPictureSize","vt":"str"},{"t":"eq","v":"artActionsPostPictureHashtags","vt":"str"},{"t":"eq","v":"advertisingPicture","vt":"str"},{"t":"eq","v":"moreAboutAdvertising","vt":"str"},{"t":"eq","v":"thisPictureForAdvertising","vt":"str"},{"t":"eq","v":"statisticByHashtags","vt":"str"},{"t":"eq","v":"statisticByPictures","vt":"str"},{"t":"eq","v":"nextPicture","vt":"str"},{"t":"eq","v":"backPicture","vt":"str"},{"t":"cont","v":"deletePicture","vt":"str"},{"t":"cont","v":"deleteSelectedPicture","vt":"str"},{"t":"eq","v":"noDeleteSelectedPicture","vt":"str"},{"t":"cont","v":"editPicture","vt":"str"},{"t":"cont","v":"editCategory","vt":"str"},{"t":"cont","v":"editImage","vt":"str"},{"t":"cont","v":"editDescription","vt":"str"},{"t":"cont","v":"editSize","vt":"str"},{"t":"cont","v":"editHashtags","vt":"str"},{"t":"cont","v":"editNamePicture","vt":"str"},{"t":"eq","v":"viewEditedPost","vt":"str"},{"t":"eq","v":"backToEditPost","vt":"str"},{"t":"cont","v":"advertisePicture","vt":"str"},{"t":"eq","v":"payAdvertisingPicture","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":50,"x":610,"y":560,"wires":[["22220e0a.7fc6b2","31798697.3213ba"],["ec1f8f1e.fbe2d","b57a4fe2.3e82e"],["cc91bd2c.1d8fd","a95d6c5b.14709"],["cc91bd2c.1d8fd","84dab932.764ea8"],["cc91bd2c.1d8fd","91000579.7e8dd8"],[],["74fa1520.f431fc"],["74fa1520.f431fc","1eb44417.bf30dc"],["23b5459f.84d1aa","45a4e962.045d18"],["23b5459f.84d1aa","cd2ec8c6.b21218"],["23b5459f.84d1aa","7c7be9ea.669c88"],["23b5459f.84d1aa","823bce67.5b342"],["23b5459f.84d1aa","10dffdc1.982722"],["23b5459f.84d1aa","276ad627.ff898a"],["23b5459f.84d1aa","694de63.3d47c18"],["23b5459f.84d1aa","d088b9e3.1cb9f8"],["8df39faf.1ce92","c3fdfa2b.ffef28"],["8df39faf.1ce92","1ad93214.3e176e"],["8df39faf.1ce92"],["8df39faf.1ce92"],["a56cc0d7.e0581","521ecbf2.43eeb4"],["a56cc0d7.e0581"],[],[],["a56cc0d7.e0581"],["a56cc0d7.e0581"],["a56cc0d7.e0581"],["a56cc0d7.e0581"],["3f303ef5.45e5b2"],["3f303ef5.45e5b2"],["3f303ef5.45e5b2"],["3e636b9b.0723a4"],["3e636b9b.0723a4"],["c99446cc.b08098"],["c99446cc.b08098"],["c99446cc.b08098"],["c99446cc.b08098"],["c99446cc.b08098"],["c99446cc.b08098"],["bc83cf0b.a7f59"],["bc83cf0b.a7f59"],["bc83cf0b.a7f59"],["bc83cf0b.a7f59"],["bc83cf0b.a7f59"],["bc83cf0b.a7f59"],["a60376cb.2bb258"],["ac81cac7.c58c28"],["3f303ef5.45e5b2"],[],["ebb5d6c8.17eb18","a32b72d6.820b5"]]},{"id":"fa06a0ee.2607e","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1350,"y":300,"wires":[[]]},{"id":"22220e0a.7fc6b2","type":"function","z":"b7ea2501.259358","name":"startNumberMessage","func":"msg.url = msg.messageApiHost+\"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    templateName: \"startNumberMessage\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":300,"wires":[["fa06a0ee.2607e"]]},{"id":"7b468f47.4954e","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1350,"y":380,"wires":[["2a4932d6.ed34ae"]]},{"id":"cc91bd2c.1d8fd","type":"function","z":"b7ea2501.259358","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.text\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":380,"wires":[["7b468f47.4954e"]]},{"id":"b1a56e0d.326a","type":"link out","z":"ee99e200.220c5","name":"","links":["cfecf365.e050f"],"x":1295,"y":220,"wires":[]},{"id":"cfecf365.e050f","type":"link in","z":"b7ea2501.259358","name":"","links":["b1a56e0d.326a"],"x":35,"y":560,"wires":[["147c811e.91bcaf","d838944c.836b08"]]},{"id":"1e167ac1.a19af5","type":"function","z":"b7ea2501.259358","name":"artistMenu","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artistMenu\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2190,"y":520,"wires":[["86bffb4.19d1d08"]]},{"id":"86bffb4.19d1d08","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2370,"y":520,"wires":[[]]},{"id":"4e5db960.ed6618","type":"debug","z":"ee99e200.220c5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1190,"y":180,"wires":[]},{"id":"fd13988.5e80068","type":"function","z":"ee99e200.220c5","name":"","func":"msg.buyerType = \"buyer\";\nmsg.artistType = \"artist\";\nmsg.delete_picture_action = 'delete_picture';\nmsg.edit_picture_action = 'edit_picture';\nmsg.advertise_picture_action = 'advertise_picture';\nmsg.byArtistSearchType = 'byArtistSearchType';\nmsg.byCategorySearchType = 'byCategorySearchType';\nmsg.bySizeSearchType = 'bySizeSearchType';\nmsg.byHashtagSearchType = 'byHashtagSearchType';\nmsg.byHistorySearchType = 'byHistorySearchType';\nmsg.byLikedSearchType = 'byLikedSearchType';\nmsg.messageApiHost = \"https://messageapi-pdp-art-bot.herokuapp.com\";\nmsg.userApiHost = \"https://userapi-pdp-art-bot.herokuapp.com\";\nmsg.imageApiHost = \"https://imageapi-pdp-art-bot.herokuapp.com\";\n//msg.state = msg.payload.state;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":560,"y":220,"wires":[["65de9ef7.2c2ac"]]},{"id":"31e306e1.ad6a7a","type":"function","z":"b7ea2501.259358","name":"helloArtistStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"helloArtistStiker\",\n    type: msg.artistType,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1960,"y":420,"wires":[["3f3527c.7ef0bd8"]]},{"id":"3f3527c.7ef0bd8","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2210,"y":420,"wires":[["33c1b04e.0336e"]]},{"id":"c927d7f6.a60ce8","type":"switch","z":"b7ea2501.259358","name":"Buyer","property":"text","propertyType":"msg","rules":[{"t":"eq","v":"changeTypeToBuyer","vt":"str"},{"t":"eq","v":"changeTypeToArtist","vt":"str"},{"t":"eq","v":"buyer","vt":"str"},{"t":"eq","v":"searchPictures","vt":"str"},{"t":"eq","v":"searchByArtist","vt":"str"},{"t":"eq","v":"searchByCategory","vt":"str"},{"t":"eq","v":"searchBySize","vt":"str"},{"t":"eq","v":"searchByHashtag","vt":"str"},{"t":"cont","v":"artistIdSPic","vt":"str"},{"t":"cont","v":"categIdSPic","vt":"str"},{"t":"eq","v":"backPicture","vt":"str"},{"t":"eq","v":"nextPicture","vt":"str"},{"t":"eq","v":"viewHistory","vt":"str"},{"t":"eq","v":"viewLiked","vt":"str"},{"t":"eq","v":"contactWithAdministrator","vt":"str"},{"t":"eq","v":"backToBuyerMenu","vt":"str"},{"t":"eq","v":"backToArtistMenu","vt":"str"},{"t":"cont","v":"like","vt":"str"},{"t":"cont","v":"apply","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":20,"x":330,"y":1740,"wires":[["ce46050b.fb43a8"],["fb6cd115.dfff5"],["4921488f.f26bc8"],["c6c13a30.aa4188"],["c6c13a30.aa4188"],["c6c13a30.aa4188"],["c6c13a30.aa4188"],["c6c13a30.aa4188"],["c6c13a30.aa4188"],["c6c13a30.aa4188"],["c6c13a30.aa4188"],["c6c13a30.aa4188"],["937b6b69.86ea58"],["937b6b69.86ea58"],["6e67269d.60e138"],["b51dc91c.e2c9b8"],["b51dc91c.e2c9b8"],["3e7bb15c.c3fb5e"],["3e7bb15c.c3fb5e"],["d56bdfa4.887f6"]]},{"id":"53880733.6647b8","type":"link in","z":"b7ea2501.259358","name":"","links":["74fa1520.f431fc","9c03280d.669b18","8e4c78fd.0e8c98"],"x":175,"y":1760,"wires":[["c927d7f6.a60ce8","6797e2b1.6444dc"]]},{"id":"147c811e.91bcaf","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":70,"y":520,"wires":[]},{"id":"ad8fa9b.4de5958","type":"debug","z":"ee99e200.220c5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":850,"y":180,"wires":[]},{"id":"dac99d89.01091","type":"function","z":"b7ea2501.259358","name":"helloArtistMenu","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"helloArtistMenu\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1440,"y":920,"wires":[["2c581a6.a6578e6"]]},{"id":"2c581a6.a6578e6","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1630,"y":920,"wires":[["9a2ef62d.dcaf08"]]},{"id":"43872d37.d33304","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1770,"y":380,"wires":[[]]},{"id":"2a4932d6.ed34ae","type":"function","z":"b7ea2501.259358","name":"chooseWhoAreYou","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.text,\n    templateName: \"chooseWhoAreYou\"\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1550,"y":380,"wires":[["43872d37.d33304"]]},{"id":"a6dced9e.7eb03","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1970,"y":920,"wires":[["abb4587b.841b58"]]},{"id":"9a2ef62d.dcaf08","type":"function","z":"b7ea2501.259358","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    nickname: msg.text,\n    state: \"helloArtistMenu\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1800,"y":920,"wires":[["a6dced9e.7eb03"]]},{"id":"f945498b.755378","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1350,"y":340,"wires":[["96d84f03.b57a"]]},{"id":"ec1f8f1e.fbe2d","type":"function","z":"b7ea2501.259358","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    phone: msg.text,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":340,"wires":[["f945498b.755378"]]},{"id":"33c1b04e.0336e","type":"function","z":"b7ea2501.259358","name":"artistName","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artistName\",\n    type: msg.artistType,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2390,"y":420,"wires":[["3d0c77c6.674268"]]},{"id":"3d0c77c6.674268","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2570,"y":420,"wires":[["eba87b5d.fc1c28"]]},{"id":"b98dad6e.c74d6","type":"function","z":"b7ea2501.259358","name":"set state","func":"msg.payload = {  \n    \"state\": \"depSuccess\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2820,"y":300,"wires":[[]]},{"id":"fcd616f0.b24648","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2730,"y":380,"wires":[]},{"id":"eba87b5d.fc1c28","type":"function","z":"b7ea2501.259358","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"artistName\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2740,"y":420,"wires":[["fcd616f0.b24648","ca9af86a.bcb108"]]},{"id":"96d84f03.b57a","type":"function","z":"b7ea2501.259358","name":"succesRegistration","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"succesRegistration\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1550,"y":340,"wires":[["32a278a0.724238"]]},{"id":"32a278a0.724238","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1770,"y":340,"wires":[["d422e32b.bd002"]]},{"id":"eed65a95.69a818","type":"function","z":"b7ea2501.259358","name":"chooseLanguage","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    //lang: msg.lang,\n    templateName: \"chooseLanguage\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2410,"y":340,"wires":[["af3c08e6.e14dc8"]]},{"id":"af3c08e6.e14dc8","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2590,"y":340,"wires":[[]]},{"id":"d422e32b.bd002","type":"function","z":"b7ea2501.259358","name":"succesRegistrationStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    //lang: msg.lang,\n    templateName: \"succesRegistrationStiker\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1990,"y":340,"wires":[["2bfbc2a2.9e2dde"]]},{"id":"2bfbc2a2.9e2dde","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2210,"y":340,"wires":[["eed65a95.69a818"]]},{"id":"ca9af86a.bcb108","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2910,"y":420,"wires":[["2a375c8.81db9a4"]]},{"id":"2a375c8.81db9a4","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":3090,"y":420,"wires":[]},{"id":"a32b72d6.820b5","type":"switch","z":"b7ea2501.259358","name":"","property":"state","propertyType":"msg","rules":[{"t":"eq","v":"artistName","vt":"str"},{"t":"eq","v":"artActionsPostPictureImage","vt":"str"},{"t":"eq","v":"artActionsPostPictureDescript","vt":"str"},{"t":"eq","v":"addPictureSize","vt":"str"},{"t":"eq","v":"addPictureHashtags","vt":"str"},{"t":"eq","v":"addPictureName","vt":"str"},{"t":"eq","v":"contactWithAdministrator","vt":"str"},{"t":"cont","v":"editPostCategory","vt":"str"},{"t":"cont","v":"editPostImage","vt":"str"},{"t":"cont","v":"editPostDescription","vt":"str"},{"t":"cont","v":"editPostSize","vt":"str"},{"t":"cont","v":"editPostHashtags","vt":"str"},{"t":"cont","v":"editPostName","vt":"str"},{"t":"eq","v":"backToArtistMenu","vt":"str"},{"t":"eq","v":"startNumberMessage","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":16,"x":830,"y":1040,"wires":[["ae9f221e.804ca","21727057.3e2a4"],["b9648cf2.54311"],["b9648cf2.54311"],["b9648cf2.54311"],["b9648cf2.54311"],["b9648cf2.54311"],["5f310a11.e71d34"],["868e8f63.39a82"],["868e8f63.39a82"],["7ffe7719.cf69c8"],["7ffe7719.cf69c8"],["7ffe7719.cf69c8"],["7ffe7719.cf69c8"],["868e8f63.39a82"],["797efec.2a7aa","5bf54365.cb0fbc"],["823338d0.a93288","80ae6c1c.d4af6"]]},{"id":"ae9f221e.804ca","type":"function","z":"b7ea2501.259358","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    // nickname: msg.text,\n    nickname: msg.originalMessage.message.text\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":980,"wires":[["427e52a0.518aec","e42f1e02.5c28e"]]},{"id":"427e52a0.518aec","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1250,"y":980,"wires":[["dac99d89.01091"]]},{"id":"23b5459f.84d1aa","type":"link out","z":"b7ea2501.259358","name":"Artist Menu","links":["d85e2ca2.685e4"],"x":950,"y":560,"wires":[],"l":true},{"id":"aacb7396.55dd8","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"text","propertyType":"msg","rules":[{"t":"eq","v":"artActionsWithPicturesHello","vt":"str"},{"t":"eq","v":"actionsWithPictures","vt":"str"},{"t":"eq","v":"advertising","vt":"str"},{"t":"eq","v":"viewStatistics","vt":"str"},{"t":"eq","v":"viewApplications","vt":"str"},{"t":"eq","v":"contactWithAdministrator","vt":"str"},{"t":"eq","v":"setting","vt":"str"}],"checkall":"true","repair":false,"outputs":7,"x":310,"y":320,"wires":[["f7e43719.38b0f8","a9dbda8e.553648"],["a2c4bba1.00f718","d678038b.1e665"],["b930c753.29ac98","4678f874.6fc428"],["898774a7.c98a58","2d3aa77b.46ee78"],["ee3f7809.5e2028","3b149ca1.72d764"],["f6b1e7ef.e542d8","95c47108.3ebf1"],["62c5b998.c74128","57b91bf.d5a04e4"]]},{"id":"d85e2ca2.685e4","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["23b5459f.84d1aa"],"x":155,"y":320,"wires":[["aacb7396.55dd8"]]},{"id":"a2c4bba1.00f718","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsWithPictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsWithPictures\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":640,"y":160,"wires":[["f8626705.f93858"]]},{"id":"f8626705.f93858","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":890,"y":160,"wires":[[]]},{"id":"8df39faf.1ce92","type":"link out","z":"b7ea2501.259358","name":"Actions with pictures","links":["35ff0281.a7827e"],"x":980,"y":600,"wires":[],"l":true},{"id":"35ff0281.a7827e","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["8df39faf.1ce92","ffce86a9.8fcaa8"],"x":155,"y":1020,"wires":[["fcf50689.f69a48"]]},{"id":"fcf50689.f69a48","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"text","propertyType":"msg","rules":[{"t":"eq","v":"exhibitPicture","vt":"str"},{"t":"eq","v":"editPostOfPicture","vt":"str"},{"t":"eq","v":"deletePainting","vt":"str"},{"t":"eq","v":"backToArtistMenu","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":310,"y":1020,"wires":[["44d28768.619638","f6e07129.6ae1b"],["232c29d4.a64516","bc6c05ad.698d78"],["3fa41c55.a34e74","309bab3c.2ab2a4"],["8f6080bd.189da"]]},{"id":"2a266bc7.2df074","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsPostPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsPostPicture\",\n    templateVars: {\n      categories: msg.categories,  \n    },\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1000,"y":880,"wires":[["8434cca6.4b604","a31e298d.9ff7f8"]]},{"id":"8434cca6.4b604","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1190,"y":880,"wires":[["f3f05e71.b21a9","3242454e.4725da"]]},{"id":"c3e73adc.27ade8","type":"comment","z":"b6f7a7df.51a0e8","name":"Actions with pictures","info":"","x":240,"y":940,"wires":[]},{"id":"d3a69b29.16f678","type":"comment","z":"b6f7a7df.51a0e8","name":"Artist Menu","info":"","x":210,"y":240,"wires":[]},{"id":"b930c753.29ac98","type":"function","z":"b6f7a7df.51a0e8","name":"artAdvertising","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertising\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":620,"y":260,"wires":[["631e5613.ad5fb8"]]},{"id":"631e5613.ad5fb8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":890,"y":260,"wires":[["bc34d434.9e3008"]]},{"id":"898774a7.c98a58","type":"function","z":"b6f7a7df.51a0e8","name":"artViewStatistics","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artViewStatistics\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":630,"y":360,"wires":[["e55cd5d9.a06b48"]]},{"id":"ee3f7809.5e2028","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsWithPictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsWithPictures\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":640,"y":460,"wires":[["ef636511.c75148"]]},{"id":"ef636511.c75148","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":870,"y":460,"wires":[[]]},{"id":"f6b1e7ef.e542d8","type":"function","z":"b6f7a7df.51a0e8","name":"contactWithAdministratorStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"contactWithAdministratorStiker\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":670,"y":560,"wires":[["3fced84c.f8dde8"]]},{"id":"3fced84c.f8dde8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":890,"y":560,"wires":[["a2e213e8.f7a07"]]},{"id":"b1ea68f1.787d58","type":"function","z":"b6f7a7df.51a0e8","name":"changeTypeToBuyer","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    //templateName: \"changeWhoAreYou\"\n    templateName: \"changeTypeToBuyer\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":660,"wires":[["60d97fde.9a373"]]},{"id":"60d97fde.9a373","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1310,"y":660,"wires":[["1b52abbf.67cf34"]]},{"id":"8f6080bd.189da","type":"function","z":"b6f7a7df.51a0e8","name":"artistMenu","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artistMenu\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":1300,"wires":[["c4c84857.1eb948"]]},{"id":"c4c84857.1eb948","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":650,"y":1300,"wires":[["d5f58e9c.29b7c"]]},{"id":"45f5d81d.747448","type":"function","z":"b6f7a7df.51a0e8","name":"artistMenu","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artistMenu\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1970,"y":1540,"wires":[["36032f6f.47fc2"]]},{"id":"36032f6f.47fc2","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2130,"y":1540,"wires":[[]]},{"id":"1f0740da.c4156f","type":"function","z":"b6f7a7df.51a0e8","name":"перелік картин -карусель","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artistMenu\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1720,"y":760,"wires":[["ac76e48.7b63718"]]},{"id":"ac76e48.7b63718","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1950,"y":760,"wires":[[]]},{"id":"c3128dad.e2411","type":"comment","z":"b6f7a7df.51a0e8","name":"Post Picture","info":"","x":190,"y":1700,"wires":[]},{"id":"ddd62628.296c08","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["a56cc0d7.e0581","b9648cf2.54311"],"x":135,"y":1800,"wires":[["60185cfe.59d7f4"]]},{"id":"60185cfe.59d7f4","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"text","propertyType":"msg","rules":[{"t":"cont","v":"categId","vt":"str"},{"t":"eq","v":"artActionsPostPictureImage","vt":"str"},{"t":"eq","v":"artActionsPostPictureDescript","vt":"str"},{"t":"eq","v":"artActionsPostPictureSize","vt":"str"},{"t":"eq","v":"artActionsPostPictureHashtags","vt":"str"},{"t":"eq","v":"viewCreatedPost","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":7,"x":290,"y":1800,"wires":[["a8997c2b.06168","86f10cbf.427f5"],["a8997c2b.06168"],["c73d8690.b3ab58","5c335876.26c2e8"],["80f1d1e9.18cdc","e87223fe.b1d34"],["16eca614.c9448a","6f1d9c81.353f44"],["35be2573.b443fa","52d7705.7fea29"],["26330483.33664c","9d927498.49abd8"]]},{"id":"a8997c2b.06168","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsPostPictureImage","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsPostPictureImage\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":780,"y":1500,"wires":[["f0162471.3eab68"]]},{"id":"f0162471.3eab68","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1010,"y":1500,"wires":[["7847f12f.a9508"]]},{"id":"a56cc0d7.e0581","type":"link out","z":"b7ea2501.259358","name":"Post Picture","links":["ddd62628.296c08"],"x":950,"y":640,"wires":[],"l":true},{"id":"4abb8a3d.477ba4","type":"comment","z":"b6f7a7df.51a0e8","name":"1 ❤️ треба записувати в бд дану категорію картин","info":"","x":1000,"y":1460,"wires":[]},{"id":"7847f12f.a9508","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.chosed_category_id = msg.text.split('_')[1];\nmsg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"artActionsPostPictureImage\",\n    settings: {\n        chosed_category_id: msg.chosed_category_id,\n    }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1180,"y":1500,"wires":[["b825d715.fb44e8"]]},{"id":"b825d715.fb44e8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1350,"y":1500,"wires":[[]]},{"id":"b9648cf2.54311","type":"link out","z":"b7ea2501.259358","name":"to artist menu","links":["ddd62628.296c08"],"x":1100,"y":1020,"wires":[],"l":true},{"id":"8b432f14.79a5c","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsPostPictureDescript","func":"msg.picture = msg.payload;\nmsg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.picture = msg.payload;\nmsg.payload = {\n    id: msg.payload.id,\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsPostPictureDescript\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":790,"y":1620,"wires":[["1d03d45f.2bd93c"]]},{"id":"1d03d45f.2bd93c","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1030,"y":1620,"wires":[["3591cb48.6d6484"]]},{"id":"3591cb48.6d6484","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"artActionsPostPictureDescript\",\n    settings: {\n        picture_id: msg.picture.id\n    }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1200,"y":1620,"wires":[["528e30f4.e5e92"]]},{"id":"528e30f4.e5e92","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1370,"y":1620,"wires":[[]]},{"id":"26330483.33664c","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"state","propertyType":"msg","rules":[{"t":"eq","v":"artActionsPostPictureImage","vt":"str"},{"t":"eq","v":"artActionsPostPictureDescript","vt":"str"},{"t":"eq","v":"addPictureSize","vt":"str"},{"t":"eq","v":"addPictureHashtags","vt":"str"},{"t":"eq","v":"addPictureName","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":6,"x":470,"y":2180,"wires":[["26d0b29a.9a074e","222aa8ca.aae898"],["6680d6b0.d91438","68c17ed1.dec53"],["4abf6a55.318f24","293f5954.c36976"],["55fd9ba5.b4dae4","12957950.c19727"],["bad9bf81.9b8f6","d59e1b83.e24c58"],[]]},{"id":"80f1d1e9.18cdc","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsPostPictureSize","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.picture = msg.payload;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsPostPictureSize\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":770,"y":1740,"wires":[["6bc7e59a.9eff7c"]]},{"id":"6bc7e59a.9eff7c","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":990,"y":1740,"wires":[["1f5bfde9.bc1c32"]]},{"id":"1f5bfde9.bc1c32","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"addPictureSize\",\n    settings: {\n        picture_id: msg.picture.id\n    }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1160,"y":1740,"wires":[["474cea.b6965318"]]},{"id":"474cea.b6965318","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1330,"y":1740,"wires":[[]]},{"id":"16eca614.c9448a","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsPostPictureHashtags","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.picture = msg.payload;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsPostPictureHashtags\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":790,"y":1860,"wires":[["c608a9a1.808768"]]},{"id":"c608a9a1.808768","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1030,"y":1860,"wires":[["db599e17.a09a2"]]},{"id":"db599e17.a09a2","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"addPictureHashtags\",\n    settings: {\n        picture_id: msg.picture.id\n    }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1200,"y":1860,"wires":[["9074f11a.bb1b7"]]},{"id":"9074f11a.bb1b7","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1370,"y":1860,"wires":[[]]},{"id":"1e658aab.731a95","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsPostPictureDoneText","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsPostPictureDoneText\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1130,"y":2600,"wires":[["9361ea3b.4e4b18"]]},{"id":"9361ea3b.4e4b18","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1370,"y":2600,"wires":[["aa8c804f.66c07"]]},{"id":"aa8c804f.66c07","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsPostPictureDoneStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsPostPictureDoneStiker\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1620,"y":2600,"wires":[["2ab1fc27.8e6314"]]},{"id":"2ab1fc27.8e6314","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1870,"y":2600,"wires":[["215e8bda.7a7ac4"]]},{"id":"b4a57069.7bf2b","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsPostPictureCreated","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsPostPictureCreated\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags:msg.picture.hashtags ? '#' + msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1590,"y":1980,"wires":[["793671ce.cc2ed"]]},{"id":"793671ce.cc2ed","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1830,"y":1980,"wires":[["b1d9d24e.9a4c9"]]},{"id":"215e8bda.7a7ac4","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsPostPictureDoneView","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsPostPictureDoneView\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2110,"y":2600,"wires":[["8b8b13a8.3c"]]},{"id":"8b8b13a8.3c","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2350,"y":2600,"wires":[["f59a9c8f.1ff3"]]},{"id":"521ecbf2.43eeb4","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1870,"y":260,"wires":[]},{"id":"86f10cbf.427f5","type":"debug","z":"b6f7a7df.51a0e8","name":"121","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":710,"y":1460,"wires":[]},{"id":"cdaa3432.bd8818","type":"comment","z":"b6f7a7df.51a0e8","name":"Edit Post","info":"","x":240,"y":4160,"wires":[]},{"id":"5b55be20.c1f0a","type":"comment","z":"b6f7a7df.51a0e8","name":"Action With Post","info":"","x":220,"y":3020,"wires":[]},{"id":"b1d9d24e.9a4c9","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsPostPictureCreatedMenu","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsPostPictureCreatedMenu\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2080,"y":1980,"wires":[["caa59240.8870f"]]},{"id":"caa59240.8870f","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2330,"y":1980,"wires":[[]]},{"id":"f7e43719.38b0f8","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsWithPicturesHello","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsWithPicturesHello\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":660,"y":60,"wires":[["c9fccde9.b0ef8"]]},{"id":"c9fccde9.b0ef8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":890,"y":60,"wires":[[]]},{"id":"941bf354.72114","type":"function","z":"b6f7a7df.51a0e8","name":"artDeletePictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artDeletePictures\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1910,"y":1240,"wires":[["78a1544b.13e6ec"]]},{"id":"78a1544b.13e6ec","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2110,"y":1240,"wires":[["69e23f8b.a99ab"]]},{"id":"e2237e1d.513b","type":"comment","z":"b6f7a7df.51a0e8","name":"нема ще картин в художника","info":"","x":1510,"y":1100,"wires":[]},{"id":"9c03280d.669b18","type":"link out","z":"b7ea2501.259358","name":"","links":["53880733.6647b8"],"x":515,"y":800,"wires":[]},{"id":"bc3e2584.805b18","type":"function","z":"b7ea2501.259358","name":"helloArtist","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"helloArtist\"\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":420,"wires":[["73d4b4a8.5f7d7c"]]},{"id":"73d4b4a8.5f7d7c","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1350,"y":420,"wires":[["35d9486a.2a3ce8"]]},{"id":"72bdf77b.3b4568","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1770,"y":420,"wires":[["31e306e1.ad6a7a"]]},{"id":"35d9486a.2a3ce8","type":"function","z":"b7ea2501.259358","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    type: msg.artistType,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1520,"y":420,"wires":[["72bdf77b.3b4568"]]},{"id":"5f259431.22eb9c","type":"function","z":"b7ea2501.259358","name":"helloArtistStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"helloArtistStiker\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1300,"y":1580,"wires":[["f1b4161c.9c85c8"]]},{"id":"7a179422.5ce28c","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1130,"y":1580,"wires":[["5f259431.22eb9c"]]},{"id":"31b57029.dd1","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":730,"y":1580,"wires":[["f1d6a27b.f9267","eda21d5e.bdd5a"]]},{"id":"ce46050b.fb43a8","type":"function","z":"b7ea2501.259358","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    type: msg.buyerType,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":580,"y":1580,"wires":[["31b57029.dd1"]]},{"id":"f1b4161c.9c85c8","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1470,"y":1580,"wires":[["ea7c9960.522038"]]},{"id":"6797e2b1.6444dc","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":230,"y":1640,"wires":[]},{"id":"abb4587b.841b58","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2110,"y":920,"wires":[]},{"id":"f1d6a27b.f9267","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":710,"y":1560,"wires":[]},{"id":"ea7c9960.522038","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1450,"y":1540,"wires":[]},{"id":"eb2682b.220b48","type":"switch","z":"b7ea2501.259358","name":"","property":"type","propertyType":"msg","rules":[{"t":"eq","v":"artistType","vt":"msg"},{"t":"eq","v":"buyerType","vt":"msg"}],"checkall":"true","repair":false,"outputs":2,"x":450,"y":560,"wires":[["dcf449c3.ac8708","8a7934ba.085bc8"],["9c03280d.669b18","8a7934ba.085bc8"]]},{"id":"74fa1520.f431fc","type":"link out","z":"b7ea2501.259358","name":"buyer","links":["53880733.6647b8"],"x":930,"y":500,"wires":[],"l":true},{"id":"31798697.3213ba","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1030,"y":240,"wires":[]},{"id":"b57a4fe2.3e82e","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1870,"y":60,"wires":[]},{"id":"a95d6c5b.14709","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1870,"y":100,"wires":[]},{"id":"84dab932.764ea8","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1870,"y":140,"wires":[]},{"id":"91000579.7e8dd8","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1870,"y":180,"wires":[]},{"id":"1eb44417.bf30dc","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1868.5714721679688,"y":302.857177734375,"wires":[]},{"id":"ebb5d6c8.17eb18","type":"debug","z":"b7ea2501.259358","name":"otherwise","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1180,"y":860,"wires":[]},{"id":"45a4e962.045d18","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1812.857177734375,"y":818.5714111328125,"wires":[]},{"id":"cd2ec8c6.b21218","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1810,"y":860,"wires":[]},{"id":"7c7be9ea.669c88","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2030,"y":20,"wires":[]},{"id":"823bce67.5b342","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2030,"y":60,"wires":[]},{"id":"10dffdc1.982722","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2030,"y":100,"wires":[]},{"id":"276ad627.ff898a","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2030,"y":140,"wires":[]},{"id":"694de63.3d47c18","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2030,"y":180,"wires":[]},{"id":"d088b9e3.1cb9f8","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2030,"y":220,"wires":[]},{"id":"c3fdfa2b.ffef28","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2030,"y":260,"wires":[]},{"id":"1ad93214.3e176e","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2030,"y":300,"wires":[]},{"id":"417ce731.6f0a48","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1170,"y":2100,"wires":[["b42e5d77.f3abb"]]},{"id":"971d6799.da2188","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = \"https://api.telegram.org/bot1730284858:AAHdzHY6NkNnPRuHMtl6PF1evR8BpcejtyY/getFile\";\nmsg.method = \"GET\";\nmsg.payload = {\n    file_id: msg.text,\n    //url: msg.text\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1000,"y":2100,"wires":[["417ce731.6f0a48"]]},{"id":"9d927498.49abd8","type":"debug","z":"b6f7a7df.51a0e8","name":"6","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":470,"y":2100,"wires":[]},{"id":"926fc332.2f3af","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1510,"y":2100,"wires":[["e39e93bf.4db7b"]]},{"id":"b42e5d77.f3abb","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.payload = {\n    artist_id: msg.chat_id,\n    category_id: msg.settings.chosed_category_id,\n    //externalPictureUrl: \"https://api.telegram.org/file/bot1642349293:AAFs_rRylHYO5VWf0uJe-A897aBfjtoJdu8/\"+msg.payload.result.file_path,\n    externalPictureUrl: \"https://api.telegram.org/file/bot1730284858:AAHdzHY6NkNnPRuHMtl6PF1evR8BpcejtyY/\"+msg.payload.result.file_path,\n\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1340,"y":2100,"wires":[["926fc332.2f3af","bd8fb7db.064118"]]},{"id":"bbb6c5c.ea06b38","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsPostPictureName","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsPostPictureName\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1580,"y":2480,"wires":[["8497f676.809928"]]},{"id":"8497f676.809928","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1810,"y":2480,"wires":[["b3413c79.28828"]]},{"id":"b3413c79.28828","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"addPictureName\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1980,"y":2480,"wires":[["80143d70.05c5"]]},{"id":"80143d70.05c5","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2150,"y":2480,"wires":[[]]},{"id":"b3ec7501.beeeb8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1170,"y":2200,"wires":[["655af751.7b9bb8"]]},{"id":"e54631ad.9779f","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.payload = {\n    id: msg.payload.settings.picture_id,\n    description: msg.text,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1000,"y":2200,"wires":[["b3ec7501.beeeb8"]]},{"id":"66b99460.c13dac","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1790,"y":2440,"wires":[["a8f799cf.7dc4c8"]]},{"id":"691d07d6.5caae8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.size = msg.text.split(\"-\");\nmsg.payload = {\n    id: msg.payload.settings.picture_id,\n    //height: msg.text.split('-')[0],\n    //width: msg.text.split('-')[1]\n    height: msg.size[0],\n    width: msg.size[1]\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1620,"y":2440,"wires":[["66b99460.c13dac"]]},{"id":"dea033a2.2aaf8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1350,"y":2480,"wires":[["bbb6c5c.ea06b38"]]},{"id":"880f4a7f.dc3c78","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"let text = msg.text;\n\n//text = text.replace(/\\s/g, '');\n\ntext = text.replace(/# /g, \"#\");\n\ntext = text.replace(',', \"\");\n\nif(text[0] == '#') {\ntext = text.substring(1, text.length);\nconsole.log(text);\n}\n\nmsg.hashtags = text.split('#');\n\nreturn msg;\n//msg.picture.hashtags = msg.picture.hashtags.replace(/# /g, \"#\");","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":2480,"wires":[["c2979bd5.693e78"]]},{"id":"a2e213e8.f7a07","type":"function","z":"b6f7a7df.51a0e8","name":"contactWithAdministrator","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"contactWithAdministrator\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1090,"y":560,"wires":[["1c64d86d.f6c468"]]},{"id":"1c64d86d.f6c468","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1290,"y":560,"wires":[["91b26a5e.d84ac8"]]},{"id":"91b26a5e.d84ac8","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"contactWithAdministrator\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1480,"y":560,"wires":[["c6206c98.27106"]]},{"id":"c6206c98.27106","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1650,"y":560,"wires":[[]]},{"id":"5f310a11.e71d34","type":"link out","z":"b7ea2501.259358","name":"to contact with administrator","links":["78985f88.4f951"],"x":1140,"y":1040,"wires":[],"l":true},{"id":"af54f26c.dc5bf","type":"function","z":"7edc0cb0.8be9f4","name":"Set user text to payload","func":"msg.payload = msg.text;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":330,"y":260,"wires":[["72a28b6e.df0034"]]},{"id":"d54db84a.7b2298","type":"function","z":"7edc0cb0.8be9f4","name":"Set Dialogflow responce to msg.answer","func":"msg.answer = msg._dialogflow.fulfillmentText;\nmsg.intent = msg._dialogflow.intent.displayName;\n//msg.prevState = msg.user.state;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":840,"y":260,"wires":[["bab96781.8567c8"]]},{"id":"bab96781.8567c8","type":"function","z":"7edc0cb0.8be9f4","name":"","func":"msg.intent = msg._dialogflow.intent.displayName;\nif(msg.intent === \"Greetings\") {\n    msg.state = \"nlp_welcome\"\n}\nelse if(msg.intent === \"Додати категорію\") {\n    msg.state = \"nlp_addCategory\"\n}\nelse if(msg.intent === \"Кількість на рекламу\") {\n    msg.state = \"nlp_quantityForAdvertising\"\n}\nelse if(msg.intent === \"Не публікується\") {\n    msg.state = \"nlp_notPublishing\"\n}\nelse if(msg.intent === \"Не публікується - yes\") {\n    msg.state = \"nlp_notPublishing_yes\"\n}\nelse if(msg.state == \"nlp_notPublishing\") {\n    msg.intent === \"Не публікується - yes\";\n    msg.state = \"nlp_notPublishing_yes\"\n}\nelse if(msg.intent === \"Не рекламується\") {\n    msg.state = \"nlp_notAdvertising\"\n}\nelse if(msg.intent === \"Охоплення поста\") {\n    msg.state = \"nlp_сoverageOfPost\"\n}\nelse if(msg.intent === \"Попит\") {\n    msg.state = \"nlp_demand\"\n}\nelse if(msg.intent === \"Реклама\") {\n    msg.state = \"nlp_advertising\"\n}\nelse if(msg.intent === \"Час реклами\") {\n    msg.state = \"nlp_advertisingTime\"\n}\nelse if(msg.intent === \"Що публікується\") {\n    msg.state = \"nlp_whatIsPublishing\"\n}\nelse if(msg.intent === \"Що рекламується\") {\n    msg.state = \"nlp_whatIsAdvertising\"\n}\nelse if(msg.intent === \"До побачення\") {\n    msg.state = \"nlp_goodbye\"\n}\nelse if(msg.intent === \"Подяка\") {\n    msg.state = \"nlp_thank_you\"\n}\nelse if(msg.intent === \"Підтвердження\") {\n    msg.state = \"nlp_yes\"\n}\nelse if(msg.intent === \"Заперечення\") {\n    msg.state = \"nlp_no\"\n}\nelse if(msg.intent === \"Default Fallback Intent\") {\n    msg.state = \"nlp_noIntent\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1100,"y":260,"wires":[["b53d9d11.3ef8c"]]},{"id":"b938ebad.dece78","type":"function","z":"7edc0cb0.8be9f4","name":"helloArtistMenu","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"helloArtistMenu\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1900,"y":240,"wires":[["847f7310.797e2"]]},{"id":"847f7310.797e2","type":"http request","z":"7edc0cb0.8be9f4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2090,"y":240,"wires":[["70fda8aa.370158"]]},{"id":"b53d9d11.3ef8c","type":"switch","z":"7edc0cb0.8be9f4","name":"","property":"state","propertyType":"msg","rules":[{"t":"eq","v":"nlp_welcome","vt":"str"},{"t":"eq","v":"nlp_addCategory","vt":"str"},{"t":"eq","v":"nlp_quantityForAdvertising","vt":"str"},{"t":"eq","v":"nlp_notPublishing","vt":"str"},{"t":"eq","v":"nlp_notPublishing_yes","vt":"str"},{"t":"eq","v":"nlp_notAdvertising","vt":"str"},{"t":"eq","v":"nlp_сoverageOfPost","vt":"str"},{"t":"eq","v":"nlp_demand","vt":"str"},{"t":"eq","v":"nlp_advertising","vt":"str"},{"t":"eq","v":"nlp_advertisingTime","vt":"str"},{"t":"eq","v":"nlp_whatIsPublishing","vt":"str"},{"t":"eq","v":"nlp_whatIsAdvertising","vt":"str"},{"t":"eq","v":"nlp_yes","vt":"str"},{"t":"eq","v":"nlp_noIntent","vt":"str"},{"t":"eq","v":"nlp_goodbye","vt":"str"},{"t":"eq","v":"nlp_no","vt":"str"},{"t":"eq","v":"nlp_thank_you","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":18,"x":1270,"y":260,"wires":[["616920df.ffcc7","c95c9bee.9280b8"],["9091a39f.ed19d","c95c9bee.9280b8"],["c95c9bee.9280b8"],["c95c9bee.9280b8"],["c95c9bee.9280b8"],["c95c9bee.9280b8"],["c95c9bee.9280b8"],["c95c9bee.9280b8"],["c95c9bee.9280b8"],["c95c9bee.9280b8"],["c95c9bee.9280b8"],["c95c9bee.9280b8"],["c95c9bee.9280b8"],["c95c9bee.9280b8"],["10ff7e90.bc3841"],["10ff7e90.bc3841"],["c95c9bee.9280b8"],["b4bfe68a.d97a38","10ff7e90.bc3841"]]},{"id":"309fc404.89c55c","type":"function","z":"7edc0cb0.8be9f4","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    nickname: msg.text,\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1540,"y":240,"wires":[["3e467978.8a7ef6"]]},{"id":"3e467978.8a7ef6","type":"http request","z":"7edc0cb0.8be9f4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1710,"y":240,"wires":[["b938ebad.dece78"]]},{"id":"616920df.ffcc7","type":"debug","z":"7edc0cb0.8be9f4","name":"1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1530,"y":200,"wires":[]},{"id":"9091a39f.ed19d","type":"debug","z":"7edc0cb0.8be9f4","name":"2","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1530,"y":260,"wires":[]},{"id":"b4bfe68a.d97a38","type":"debug","z":"7edc0cb0.8be9f4","name":"3","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1530,"y":560,"wires":[]},{"id":"70fda8aa.370158","type":"debug","z":"7edc0cb0.8be9f4","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2250,"y":240,"wires":[]},{"id":"cb81bc1f.bb9e4","type":"debug","z":"7edc0cb0.8be9f4","name":"Dialogflow","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":800,"y":320,"wires":[]},{"id":"78985f88.4f951","type":"link in","z":"7edc0cb0.8be9f4","name":"","links":["5f310a11.e71d34","34fe999.b290166"],"x":155,"y":260,"wires":[["af54f26c.dc5bf"]]},{"id":"46e935ec.9a368c","type":"http request","z":"7edc0cb0.8be9f4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2050,"y":340,"wires":[["7f53092d.3ffbe8"]]},{"id":"c95c9bee.9280b8","type":"function","z":"7edc0cb0.8be9f4","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\n\nmsg.payload = {\n    chat_id: msg.chat_id,\n    \n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1540,"y":340,"wires":[["c1ed209c.efa5c"]]},{"id":"c1ed209c.efa5c","type":"http request","z":"7edc0cb0.8be9f4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1710,"y":340,"wires":[["28e1fa41.77a8b6"]]},{"id":"28e1fa41.77a8b6","type":"function","z":"7edc0cb0.8be9f4","name":"","func":"msg.url = \"https://api.telegram.org/bot1730284858:AAHdzHY6NkNnPRuHMtl6PF1evR8BpcejtyY/sendMessage\";\nmsg.method = \"POST\";\n\nlet answ = msg.answer.split(\"\\n\")\n\nif(msg.lang == \"uk\") {\n    msg.answ = answ[0]\n}\nelse if(msg.lang == \"ru\") {\n    msg.answ = answ[1]\n}\nelse msg.answ = answ[2]\n\nmsg.payload = {\n    \"text\": msg.answ,\n    \"chat_id\": msg.chat_id,\n}\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1880,"y":340,"wires":[["46e935ec.9a368c"]]},{"id":"7f53092d.3ffbe8","type":"debug","z":"7edc0cb0.8be9f4","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2210,"y":340,"wires":[]},{"id":"d7d77100.f37be","type":"function","z":"7edc0cb0.8be9f4","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\n\nmsg.payload = {\n    chat_id: msg.chat_id,\n    \n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1540,"y":420,"wires":[["8ce85a49.4c03c8"]]},{"id":"8ce85a49.4c03c8","type":"http request","z":"7edc0cb0.8be9f4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1710,"y":420,"wires":[["cc2c2f2e.5a278"]]},{"id":"cc2c2f2e.5a278","type":"function","z":"7edc0cb0.8be9f4","name":"artistMenu","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artistMenu\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1890,"y":420,"wires":[["36cd82ec.dce22e"]]},{"id":"36cd82ec.dce22e","type":"http request","z":"7edc0cb0.8be9f4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2090,"y":420,"wires":[["66eff138.b5531","7bbd4234.18c83c"]]},{"id":"66eff138.b5531","type":"debug","z":"7edc0cb0.8be9f4","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2390,"y":360,"wires":[]},{"id":"108fa482.4b6f0b","type":"inject","z":"ee99e200.220c5","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":120,"y":340,"wires":[["bfe66793.4c2bc8"]]},{"id":"bfe66793.4c2bc8","type":"function","z":"ee99e200.220c5","name":"","func":"msg.method = \"POST\";\nmsg.payload = {\n    \"url\": \"https://node-red-ira-art-bot.herokuapp.com/webhook\"\n};\n//msg.url = \"https://api.telegram.org/bot1642349293:AAFs_rRylHYO5VWf0uJe-A897aBfjtoJdu8/deleteWebhook\"\n//msg.url = \"https://api.telegram.org/bot1642349293:AAFs_rRylHYO5VWf0uJe-A897aBfjtoJdu8/setWebhook\"\nmsg.url = \"https://api.telegram.org/bot1730284858:AAHdzHY6NkNnPRuHMtl6PF1evR8BpcejtyY/setWebhook\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":280,"y":340,"wires":[["9fa3cc61.f50e"]]},{"id":"9fa3cc61.f50e","type":"http request","z":"ee99e200.220c5","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":450,"y":340,"wires":[["1368ae67.46c272"]]},{"id":"1368ae67.46c272","type":"debug","z":"ee99e200.220c5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":590,"y":340,"wires":[]},{"id":"35be2573.b443fa","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.payload = {\n    id: msg.payload.settings.picture_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":1980,"wires":[["580f54fe.5b89bc"]]},{"id":"580f54fe.5b89bc","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":890,"y":1980,"wires":[["700d303c.08e1c"]]},{"id":"700d303c.08e1c","type":"function","z":"b6f7a7df.51a0e8","name":" save picture","func":"msg.picture = msg.payload;\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1070,"y":1980,"wires":[["ebf845fd.12a5e8"]]},{"id":"c2979bd5.693e78","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/hashtags\";\nmsg.method = \"POST\";\nmsg.payload = {\n  picture_id: msg.settings.picture_id, \n  hashtags: msg.hashtags,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1180,"y":2480,"wires":[["dea033a2.2aaf8"]]},{"id":"dd0397f.87c7968","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.payload = {\n    id: msg.payload.settings.picture_id,\n    name: msg.text,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":2600,"wires":[["c9c3600d.3f86a"]]},{"id":"c9c3600d.3f86a","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":890,"y":2600,"wires":[["1e658aab.731a95"]]},{"id":"1b52abbf.67cf34","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"backToArtistMenu\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1480,"y":660,"wires":[["5e203d1a.051f84"]]},{"id":"5e203d1a.051f84","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1650,"y":660,"wires":[[]]},{"id":"3f303ef5.45e5b2","type":"link out","z":"b7ea2501.259358","name":"Advertising Picture","links":["8637a189.beaa4"],"x":970,"y":680,"wires":[],"l":true},{"id":"f19e7b21.2af218","type":"comment","z":"b6f7a7df.51a0e8","name":"Advertising Picture","info":"","x":210,"y":3680,"wires":[]},{"id":"8637a189.beaa4","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["3f303ef5.45e5b2"],"x":155,"y":3760,"wires":[["da41b35b.f636f"]]},{"id":"da41b35b.f636f","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"text","propertyType":"msg","rules":[{"t":"eq","v":"advertisingPicture","vt":"str"},{"t":"eq","v":"moreAboutAdvertising","vt":"str"},{"t":"cont","v":"advertisePicture","vt":"str"},{"t":"eq","v":"","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":260,"y":3760,"wires":[["9702caab.7fba78"],["b76171d6.7738a"],["f69244d3.060178","2d3f47ad.2f5888"],[]]},{"id":"b76171d6.7738a","type":"function","z":"b6f7a7df.51a0e8","name":"artAdvertisingMore","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertisingMore\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":3720,"wires":[["cd286740.43fe78"]]},{"id":"cd286740.43fe78","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":680,"y":3720,"wires":[[]]},{"id":"ce085968.b4dd78","type":"function","z":"b6f7a7df.51a0e8","name":"artAdvertisingAllPicturesText","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertisingAllPicturesText\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":3680,"wires":[["fd7ab7fc.b79628"]]},{"id":"fd7ab7fc.b79628","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":740,"y":3680,"wires":[["c8861ff8.214ba"]]},{"id":"c8861ff8.214ba","type":"function","z":"b6f7a7df.51a0e8","name":"artAdvertisingAllPicturesButton","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertisingAllPicturesButton\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":970,"y":3680,"wires":[["4b4a063.8b709f8"]]},{"id":"4b4a063.8b709f8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1190,"y":3680,"wires":[[]]},{"id":"8ba3148f.97f6e8","type":"function","z":"b6f7a7df.51a0e8","name":"artAdvertisingPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertisingSelectedPicture\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":3760,"wires":[["22385f5b.3d1fd"]]},{"id":"22385f5b.3d1fd","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":720,"y":3760,"wires":[["55d8f1f9.3204e"]]},{"id":"55d8f1f9.3204e","type":"function","z":"b6f7a7df.51a0e8","name":"artAdvertisingPictureButton","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertisingPictureButton\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":950,"y":3760,"wires":[["4c1a1878.a90048"]]},{"id":"4c1a1878.a90048","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1180,"y":3760,"wires":[[]]},{"id":"6c94daeb.3fea44","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"text","propertyType":"msg","rules":[{"t":"eq","v":"statisticByPictures","vt":"str"},{"t":"eq","v":"statisticByHashtags","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":260,"y":3920,"wires":[["151b0b6a.455ba5"],[]]},{"id":"9fd50b7f.17de68","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["3e636b9b.0723a4"],"x":145,"y":3920,"wires":[["6c94daeb.3fea44"]]},{"id":"3e636b9b.0723a4","type":"link out","z":"b7ea2501.259358","name":"Statistic","links":["9fd50b7f.17de68"],"x":940,"y":720,"wires":[],"l":true},{"id":"151b0b6a.455ba5","type":"function","z":"b6f7a7df.51a0e8","name":"statisticByPictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artViewStatistics\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":3900,"wires":[["1c853e70.de1102"]]},{"id":"1c853e70.de1102","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":720,"y":3900,"wires":[[]]},{"id":"e55cd5d9.a06b48","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":890,"y":360,"wires":[[]]},{"id":"f089ba12.afd128","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["c99446cc.b08098"],"x":175,"y":3140,"wires":[["1e6820.81fd47e"]]},{"id":"3fa41c55.a34e74","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost +`/picture?artist_id=${msg.chat_id}&limit=1`;\nmsg.method = \"GET\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":600,"y":1160,"wires":[["10a461c0.029c5e"]]},{"id":"10a461c0.029c5e","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":770,"y":1160,"wires":[["c6583379.d8be","15ecee0d.a0dd72"]]},{"id":"6a33e48a.fce9dc","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1300,"y":1240,"wires":[["5f023922.4a4fe8"]]},{"id":"c6583379.d8be","type":"debug","z":"b6f7a7df.51a0e8","name":"oooooooo","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":950,"y":1200,"wires":[]},{"id":"69e23f8b.a99ab","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: 0,\n        action: msg.delete_picture_action,\n    }\n};\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2280,"y":1240,"wires":[["c64b24d4.1cb498"]]},{"id":"c64b24d4.1cb498","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2450,"y":1240,"wires":[[]]},{"id":"c99446cc.b08098","type":"link out","z":"b7ea2501.259358","name":"Action With Post","links":["f089ba12.afd128"],"x":970,"y":760,"wires":[],"l":true},{"id":"1e6820.81fd47e","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"text","propertyType":"msg","rules":[{"t":"eq","v":"nextPicture","vt":"str"},{"t":"eq","v":"backPicture","vt":"str"},{"t":"cont","v":"deletePicture","vt":"str"},{"t":"cont","v":"deleteSelectedPicture","vt":"str"},{"t":"eq","v":"noDeleteSelectedPicture","vt":"str"},{"t":"cont","v":"editPicture","vt":"str"}],"checkall":"true","repair":false,"outputs":6,"x":290,"y":3140,"wires":[["4e75c510.b0a86c","a8a36198.d518f"],["d75b49d9.698e28"],["51184cc6.9d7504"],["f2a0f613.b398a8"],["665ef4d6.f9df8c"],["62e8d9bd.c34158"]]},{"id":"4e75c510.b0a86c","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + `/picture?artist_id=${msg.chat_id}&user_id=${msg.chat_id}`;\nmsg.method = \"GET\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":3000,"wires":[["a35f7dda.c6905"]]},{"id":"a35f7dda.c6905","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":630,"y":3000,"wires":[["7ae88330.09b1fc"]]},{"id":"7ae88330.09b1fc","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.numberOfArtistsPictures = msg.payload.length;\nmsg.picture_index = msg.settings.picture_index;\nif(!msg.picture_index) {\n    msg.picture_index = 1;\n} else {\n    msg.picture_index++;\n}\nif(msg.picture_index >= msg.numberOfArtistsPictures) {\n    msg.picture_index = 0;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":780,"y":3000,"wires":[["fb306f7a.220a1"]]},{"id":"b53e74d9.5e8f58","type":"comment","z":"ee99e200.220c5","name":"set webhook","info":"","x":130,"y":300,"wires":[]},{"id":"5f023922.4a4fe8","type":"function","z":"b6f7a7df.51a0e8","name":"artDeletePicturesText","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artDeletePicturesText\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1500,"y":1240,"wires":[["d0028c74.ad667"]]},{"id":"d0028c74.ad667","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1710,"y":1240,"wires":[["99ecc878.6190e8"]]},{"id":"c73d8690.b3ab58","type":"debug","z":"b6f7a7df.51a0e8","name":"122","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":710,"y":1540,"wires":[]},{"id":"e87223fe.b1d34","type":"debug","z":"b6f7a7df.51a0e8","name":"123","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":710,"y":1700,"wires":[]},{"id":"6f1d9c81.353f44","type":"debug","z":"b6f7a7df.51a0e8","name":"124","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":710,"y":1820,"wires":[]},{"id":"52d7705.7fea29","type":"debug","z":"b6f7a7df.51a0e8","name":"126","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":710,"y":1940,"wires":[]},{"id":"26d0b29a.9a074e","type":"debug","z":"b6f7a7df.51a0e8","name":"121","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":710,"y":2080,"wires":[]},{"id":"95353f6d.fca0c","type":"link out","z":"b6f7a7df.51a0e8","name":"","links":["abaa3c30.f425e"],"x":1895,"y":2100,"wires":[]},{"id":"abaa3c30.f425e","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["95353f6d.fca0c","cde2a2cf.442c"],"x":635,"y":1660,"wires":[["8b432f14.79a5c"]]},{"id":"6680d6b0.d91438","type":"debug","z":"b6f7a7df.51a0e8","name":"122","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":710,"y":2200,"wires":[]},{"id":"655af751.7b9bb8","type":"link out","z":"b6f7a7df.51a0e8","name":"","links":["5db8a0c.fd78a6"],"x":1295,"y":2200,"wires":[]},{"id":"5db8a0c.fd78a6","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["655af751.7b9bb8"],"x":635,"y":1780,"wires":[["80f1d1e9.18cdc"]]},{"id":"4abf6a55.318f24","type":"debug","z":"b6f7a7df.51a0e8","name":"123","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":710,"y":2360,"wires":[]},{"id":"a8f799cf.7dc4c8","type":"link out","z":"b6f7a7df.51a0e8","name":"","links":["2f8f2d9c.5fcee2"],"x":1915,"y":2440,"wires":[]},{"id":"2f8f2d9c.5fcee2","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["a8f799cf.7dc4c8","1d662f8c.d2422"],"x":635,"y":1900,"wires":[["16eca614.c9448a"]]},{"id":"55fd9ba5.b4dae4","type":"debug","z":"b6f7a7df.51a0e8","name":"124","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":710,"y":2440,"wires":[]},{"id":"bad9bf81.9b8f6","type":"debug","z":"b6f7a7df.51a0e8","name":"125","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":710,"y":2560,"wires":[]},{"id":"a9dbda8e.553648","type":"debug","z":"b6f7a7df.51a0e8","name":"1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":590,"y":20,"wires":[]},{"id":"d678038b.1e665","type":"debug","z":"b6f7a7df.51a0e8","name":"2","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":590,"y":120,"wires":[]},{"id":"4678f874.6fc428","type":"debug","z":"b6f7a7df.51a0e8","name":"3","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":590,"y":220,"wires":[]},{"id":"2d3aa77b.46ee78","type":"debug","z":"b6f7a7df.51a0e8","name":"4","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":590,"y":320,"wires":[]},{"id":"3b149ca1.72d764","type":"debug","z":"b6f7a7df.51a0e8","name":"5","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":590,"y":420,"wires":[]},{"id":"95c47108.3ebf1","type":"debug","z":"b6f7a7df.51a0e8","name":"6","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":590,"y":520,"wires":[]},{"id":"62c5b998.c74128","type":"debug","z":"b6f7a7df.51a0e8","name":"7","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":590,"y":620,"wires":[]},{"id":"44d28768.619638","type":"debug","z":"b6f7a7df.51a0e8","name":"12","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":350,"y":840,"wires":[]},{"id":"8e1a7350.8ca2f","type":"comment","z":"b6f7a7df.51a0e8","name":"2 ❤️ погано ропарсує хештеги","info":"","x":1130,"y":1940,"wires":[]},{"id":"232c29d4.a64516","type":"debug","z":"b6f7a7df.51a0e8","name":"21","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":590,"y":960,"wires":[]},{"id":"309bab3c.2ab2a4","type":"debug","z":"b6f7a7df.51a0e8","name":"31","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":590,"y":1120,"wires":[]},{"id":"15ecee0d.a0dd72","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"payload.length","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"gt","v":"0","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1130,"y":1160,"wires":[["2747fc31.a88774","d4ad4db2.780d5"],["2accea20.4cae36","6a33e48a.fce9dc"]]},{"id":"2accea20.4cae36","type":"debug","z":"b6f7a7df.51a0e8","name":"> 0","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1290,"y":1200,"wires":[]},{"id":"2747fc31.a88774","type":"debug","z":"b6f7a7df.51a0e8","name":"= 0","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1290,"y":1100,"wires":[]},{"id":"d4ad4db2.780d5","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsWithoutPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsWithoutPicture\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1350,"y":1140,"wires":[["24264bb0.74e184"]]},{"id":"24264bb0.74e184","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1570,"y":1140,"wires":[[]]},{"id":"bc6c05ad.698d78","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.payload = null;\nmsg.url = msg.imageApiHost +`/picture?artist_id=${msg.chat_id}&limit=1`;\nmsg.method = \"GET\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":600,"y":1000,"wires":[["383d49e5.3f7fd6","903cda02.b26e08"]]},{"id":"c720c195.f73e2","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":790,"y":1000,"wires":[[]]},{"id":"8bb219e2.720e78","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictures\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1880,"y":1060,"wires":[["ba4835ed.fb4fa8","55087ffc.f1128"]]},{"id":"ba4835ed.fb4fa8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2090,"y":1060,"wires":[["2bccac71.2c0934"]]},{"id":"269c6e2f.a61972","type":"comment","z":"b6f7a7df.51a0e8","name":"нема ще картин в художника","info":"","x":1510,"y":920,"wires":[]},{"id":"357b2154.28eebe","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1300,"y":1060,"wires":[["2cfd7b42.378b14"]]},{"id":"2bccac71.2c0934","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: 0,\n        action: msg.edit_picture_action,\n    }\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2260,"y":1060,"wires":[["a783d572.c12a28"]]},{"id":"a783d572.c12a28","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2430,"y":1060,"wires":[[]]},{"id":"2cfd7b42.378b14","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPicturesText","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPicturesText\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1490,"y":1060,"wires":[["5f6a6911.2ed588","3ff0bc6b.e56e84"]]},{"id":"b2a77674.009468","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"payload.length","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"gt","v":"0","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1130,"y":1000,"wires":[["a00f1c8b.21347","236c53aa.33ae9c"],["57c8b993.ce2e88","357b2154.28eebe"]]},{"id":"57c8b993.ce2e88","type":"debug","z":"b6f7a7df.51a0e8","name":"> 0","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1290,"y":1020,"wires":[]},{"id":"a00f1c8b.21347","type":"debug","z":"b6f7a7df.51a0e8","name":"= 0","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1290,"y":920,"wires":[]},{"id":"236c53aa.33ae9c","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsWithoutPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsWithoutPicture\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1350,"y":960,"wires":[["f4414eee.503f9"]]},{"id":"f4414eee.503f9","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1570,"y":960,"wires":[[]]},{"id":"5f6a6911.2ed588","type":"debug","z":"b6f7a7df.51a0e8","name":"oooooooo","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1690,"y":1020,"wires":[]},{"id":"55087ffc.f1128","type":"debug","z":"b6f7a7df.51a0e8","name":"oooooooo","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2010,"y":1000,"wires":[]},{"id":"3ff0bc6b.e56e84","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1690,"y":1060,"wires":[["287d158d.169a8a"]]},{"id":"531f7a74.7bf9a4","type":"comment","z":"b6f7a7df.51a0e8","name":"3 ❤️ натискання кнопки \"далі\" при видаленні чи редагуванні поста","info":"","x":670,"y":2960,"wires":[]},{"id":"16cba2f5.31d96d","type":"comment","z":"b6f7a7df.51a0e8","name":"4 ❤️ натискання кнопки \"назад\" при видаленні чи редагуванні поста","info":"","x":680,"y":3040,"wires":[]},{"id":"5be34a3d.137d54","type":"comment","z":"b6f7a7df.51a0e8","name":"5 ❤️ вибір поста для видалення","info":"","x":560,"y":3140,"wires":[]},{"id":"f1695778.91c908","type":"comment","z":"b6f7a7df.51a0e8","name":"7 ❤️ вибір поста для редагування","info":"","x":560,"y":3340,"wires":[]},{"id":"c28644d0.559388","type":"comment","z":"b6f7a7df.51a0e8","name":"8 ❤️ можливість перегляду зредагованого поста","info":"","x":610,"y":3420,"wires":[]},{"id":"51184cc6.9d7504","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture_id = msg.text.split('_')[1];\nmsg.url = msg.imageApiHost +`/picture?artist_id=${msg.chat_id}&id=${msg.picture_id}`;\nmsg.method = \"GET\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":3180,"wires":[["496931b6.a577c"]]},{"id":"496931b6.a577c","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":650,"y":3180,"wires":[["180eb294.5363dd"]]},{"id":"9a98b706.38f3f8","type":"function","z":"b6f7a7df.51a0e8","name":"artDeleteSelectedPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artDeleteSelectedPicture\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1030,"y":3180,"wires":[["cb239431.d9d318"]]},{"id":"cb239431.d9d318","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1230,"y":3180,"wires":[["da2917cc.ecc778"]]},{"id":"180eb294.5363dd","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\nmsg.picture.hashtags = msg.picture.Hashtags.map(hashtag => {return hashtag.tag; }).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":820,"y":3180,"wires":[["e13ff493.e9e8b8"]]},{"id":"259497ee.4e1d18","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        currentViewPicture: msg.picture\n    }\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1840,"y":3180,"wires":[["19dee649.6fdcfa"]]},{"id":"19dee649.6fdcfa","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2010,"y":3180,"wires":[[]]},{"id":"da2917cc.ecc778","type":"function","z":"b6f7a7df.51a0e8","name":"artDeleteSelectedPictureText","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artDeleteSelectedPictureButtons\",\n    templateVars: {\n        picture_id: msg.picture_id,\n    }\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1440,"y":3180,"wires":[["6652854b.e3d77c"]]},{"id":"6652854b.e3d77c","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1670,"y":3180,"wires":[["259497ee.4e1d18"]]},{"id":"62e8d9bd.c34158","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture_id = msg.text.split('_')[1];\nmsg.url = msg.imageApiHost +`/picture?artist_id=${msg.chat_id}&id=${msg.picture_id}`;\nmsg.method = \"GET\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":3380,"wires":[["b7f6e966.e178b8"]]},{"id":"b7f6e966.e178b8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":650,"y":3380,"wires":[["c568d4ad.16a038"]]},{"id":"37e47bc6.bc5ef4","type":"function","z":"b6f7a7df.51a0e8","name":"artEditSelectedPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditSelectedPicture\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":3380,"wires":[["a4e2e24a.3b7ef","c82f38d8.7887b8"]]},{"id":"a4e2e24a.3b7ef","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1210,"y":3380,"wires":[["75385ce9.6c3684"]]},{"id":"c568d4ad.16a038","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\nmsg.picture.hashtags = msg.picture.Hashtags.map(hashtag => {return hashtag.tag; }).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":820,"y":3380,"wires":[["15500165.01ad1f"]]},{"id":"3d1d2cb9.f13824","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    state: \"backFromEditPost\",\n    settings: {\n        currentViewPicture: msg.picture\n    }\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1820,"y":3380,"wires":[["3c55c789.043188"]]},{"id":"3c55c789.043188","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1990,"y":3380,"wires":[[]]},{"id":"75385ce9.6c3684","type":"function","z":"b6f7a7df.51a0e8","name":"artEditSelectedPictureButtons","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditSelectedPictureButtons\",\n    templateVars: {\n        picture_id: msg.picture_id,\n    },\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1430,"y":3380,"wires":[["6914b241.89065c","4643a2f1.d3a4fc"]]},{"id":"6914b241.89065c","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1650,"y":3380,"wires":[["3d1d2cb9.f13824"]]},{"id":"9267251d.052448","type":"comment","z":"b6f7a7df.51a0e8","name":"6 ❤️ видалення вибраного поста","info":"","x":560,"y":3220,"wires":[]},{"id":"f2a0f613.b398a8","type":"function","z":"b6f7a7df.51a0e8","name":"artDeleteSelectedPictureStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.picture = msg.payload;\nmsg.payload = {\n    id: msg.payload.id,\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artDeleteSelectedPictureStiker\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":550,"y":3260,"wires":[["11c230e2.f9e52f"]]},{"id":"11c230e2.f9e52f","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":790,"y":3260,"wires":[["6fb12f1a.377f8"]]},{"id":"6fb12f1a.377f8","type":"function","z":"b6f7a7df.51a0e8","name":"artDeleteSelectedPictureText","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.picture = msg.payload;\nmsg.payload = {\n    id: msg.payload.id,\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artDeleteSelectedPictureText\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":3260,"wires":[["2eb638a2.5b7ab8"]]},{"id":"2eb638a2.5b7ab8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1270,"y":3260,"wires":[["19616b87.51ef44"]]},{"id":"42cd7c08.51c8e4","type":"function","z":"b6f7a7df.51a0e8","name":"artNotDeleteSelectedPictureStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.picture = msg.payload;\nmsg.payload = {\n    id: msg.payload.id,\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artNotDeleteSelectedPictureStiker\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":3300,"wires":[["2cf56c81.ef46a4"]]},{"id":"2cf56c81.ef46a4","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1270,"y":3300,"wires":[["c4fe7b55.c7bb08"]]},{"id":"c4fe7b55.c7bb08","type":"link out","z":"b6f7a7df.51a0e8","name":"","links":["c9909643.6e5aa8"],"x":1395,"y":3300,"wires":[]},{"id":"c9909643.6e5aa8","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["c4fe7b55.c7bb08"],"x":515,"y":200,"wires":[["a2c4bba1.00f718"]]},{"id":"665ef4d6.f9df8c","type":"function","z":"b6f7a7df.51a0e8","name":"artNotDeleteSelectedPictureText","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.picture = msg.payload;\nmsg.payload = {\n    id: msg.payload.id,\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artNotDeleteSelectedPictureText\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":560,"y":3300,"wires":[["5f6f1be1.e2edf4"]]},{"id":"5f6f1be1.e2edf4","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":790,"y":3300,"wires":[["42cd7c08.51c8e4"]]},{"id":"bc83cf0b.a7f59","type":"link out","z":"b7ea2501.259358","name":"Edit Post","links":["fc87423e.db46d"],"x":940,"y":800,"wires":[],"l":true},{"id":"fc87423e.db46d","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["bc83cf0b.a7f59"],"x":75,"y":4260,"wires":[["99b2c437.0ffa98","9ac67ba9.d8a3a8"]]},{"id":"20641cc1.a0ff74","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"originalMessage.callback_query.data","propertyType":"msg","rules":[{"t":"cont","v":"editCategory","vt":"str"},{"t":"cont","v":"editImage","vt":"str"},{"t":"cont","v":"editDescription","vt":"str"},{"t":"cont","v":"editSize","vt":"str"},{"t":"cont","v":"editHashtags","vt":"str"},{"t":"cont","v":"editNamePicture","vt":"str"}],"checkall":"true","repair":false,"outputs":6,"x":330,"y":4260,"wires":[["c31ac440.30cea8","e741b180.299b3"],["b4f168af.6a9248","91920aae.f22be8"],["e9889d3c.dc8c4","c87d1e5c.c8666"],["7b68864c.a75228","5c6c1af5.ba9a14"],["ad0d1280.2d73b","b4788e18.8b3ca"],["b07b8acc.8c7038","971574be.c4e838"]]},{"id":"c31ac440.30cea8","type":"debug","z":"b6f7a7df.51a0e8","name":"editCategory","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":490,"y":4040,"wires":[]},{"id":"b4f168af.6a9248","type":"debug","z":"b6f7a7df.51a0e8","name":"editImage","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":480,"y":4120,"wires":[]},{"id":"e9889d3c.dc8c4","type":"debug","z":"b6f7a7df.51a0e8","name":"editDescription","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":500,"y":4200,"wires":[]},{"id":"7b68864c.a75228","type":"debug","z":"b6f7a7df.51a0e8","name":"editSize","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":480,"y":4280,"wires":[]},{"id":"ad0d1280.2d73b","type":"debug","z":"b6f7a7df.51a0e8","name":"editHashtags","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":490,"y":4360,"wires":[]},{"id":"b07b8acc.8c7038","type":"debug","z":"b6f7a7df.51a0e8","name":"editNamePicture","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":510,"y":4440,"wires":[]},{"id":"f6455bd6.715688","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":[],"x":635,"y":1540,"wires":[["a8997c2b.06168"]]},{"id":"fb306f7a.220a1","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost +`/picture?user_id=${msg.chat_id}&artist_id=${msg.chat_id}&limit=1&offset=${msg.picture_index}`;\nmsg.method = \"GET\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":920,"y":3000,"wires":[["b30be57d.4aa2b8"]]},{"id":"b30be57d.4aa2b8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1070,"y":3000,"wires":[["f19e1573.59d868"]]},{"id":"f19e1573.59d868","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1220,"y":3000,"wires":[["f0cf9153.86ffe"]]},{"id":"d75b49d9.698e28","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost +`/picture?artist_id=${msg.chat_id}&user_id=${msg.chat_id}`;\nmsg.method = \"GET\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":3080,"wires":[["4ce4bc23.2022f4"]]},{"id":"4ce4bc23.2022f4","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":630,"y":3080,"wires":[["9b45525.0e25cb"]]},{"id":"9b45525.0e25cb","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.numberOfArtistsPictures = msg.payload.length;\nmsg.picture_index = msg.settings.picture_index;\nif(!msg.picture_index) {\n    msg.picture_index = msg.numberOfArtistsPictures - 1;\n} else {\n    msg.picture_index--;\n}\nif(msg.picture_index < 0) {\n    msg.picture_index = msg.numberOfArtistsPictures - 1;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":780,"y":3080,"wires":[["492b8699.244628"]]},{"id":"2943c4d8.fcdb1c","type":"function","z":"b6f7a7df.51a0e8","name":"artEditDeletePictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    message_id: msg.originalMessage.callback_query.message.message_id,\n    templateName: \"artEditDeletePictures\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2580,"y":3220,"wires":[["2c5ef81a.269428"]]},{"id":"2c5ef81a.269428","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2770,"y":3220,"wires":[[]]},{"id":"492b8699.244628","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost +`/picture?user_id=${msg.chat_id}&artist_id=${msg.chat_id}&limit=1&offset=${msg.picture_index}`;\nmsg.method = \"GET\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":920,"y":3080,"wires":[["8645f7c6.db31d8"]]},{"id":"8645f7c6.db31d8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1070,"y":3080,"wires":[["5c115927.a28e78"]]},{"id":"5c115927.a28e78","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1220,"y":3080,"wires":[["f0cf9153.86ffe"]]},{"id":"19616b87.51ef44","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture_id = msg.text.split('_')[1];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1440,"y":3260,"wires":[["f03bdd6a.a75f"]]},{"id":"f03bdd6a.a75f","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.method = \"DELETE\";\nmsg.url = msg.imageApiHost +`/picture/${msg.picture_id}`;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1600,"y":3260,"wires":[["24bbc39c.9d47fc","f03bee49.86f9f"]]},{"id":"24bbc39c.9d47fc","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"txt","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1770,"y":3260,"wires":[["f03bee49.86f9f"]]},{"id":"f03bee49.86f9f","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1910,"y":3220,"wires":[]},{"id":"bfebcad7.172f28","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"settings.action","propertyType":"msg","rules":[{"t":"eq","v":"delete_picture_action","vt":"msg"},{"t":"eq","v":"edit_picture_action","vt":"msg"},{"t":"eq","v":"advertise_picture_action","vt":"msg"}],"checkall":"true","repair":false,"outputs":3,"x":1770,"y":3080,"wires":[["2c82cd85.3619d2"],["d29a7aeb.6b10a8"],["8cbb0dea.d36b3"]]},{"id":"81427b9d.a3af08","type":"function","z":"b6f7a7df.51a0e8","name":"artEditEditPictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    message_id: msg.originalMessage.callback_query.message.message_id,\n    templateName: \"artEditEditPictures\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2570,"y":3380,"wires":[["a8d4db2d.521548"]]},{"id":"a8d4db2d.521548","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2770,"y":3380,"wires":[[]]},{"id":"4e59b6d0.4fab78","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost +`/categories`;\nmsg.method = \"GET\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":900,"wires":[["d8a1f27c.8137a"]]},{"id":"d8a1f27c.8137a","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":650,"y":900,"wires":[["5a47a19a.25152","d828764.5a09888"]]},{"id":"5a47a19a.25152","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.categories = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":820,"y":880,"wires":[["2a266bc7.2df074","683d173a.825338"]]},{"id":"99b2c437.0ffa98","type":"debug","z":"b6f7a7df.51a0e8","name":"editCategory","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":270,"y":4080,"wires":[]},{"id":"b54cf8ed.beac38","type":"comment","z":"b6f7a7df.51a0e8","name":"9 ❤️ перезапис в бд кожного поля зробити треба","info":"","x":1590,"y":4340,"wires":[]},{"id":"c14cfddb.a461a","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":890,"y":1420,"wires":[[]]},{"id":"79f4ae8.374c75","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.payload = {\n    id: msg.payload.settings.picture_id,\n    description: msg.text,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":1420,"wires":[["c14cfddb.a461a"]]},{"id":"91920aae.f22be8","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictureImage","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictureImage\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":4160,"wires":[["6f1fbbf2.b64174"]]},{"id":"6f1fbbf2.b64174","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":770,"y":4160,"wires":[["407cd77e.a1b618"]]},{"id":"407cd77e.a1b618","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: `editPostImage_${msg.picture_id}`\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":4160,"wires":[["f1bf03bd.c7322"]]},{"id":"f1bf03bd.c7322","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1110,"y":4160,"wires":[[]]},{"id":"cd5c8af9.70b138","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"state","propertyType":"msg","rules":[{"t":"cont","v":"editPostCategory","vt":"str"},{"t":"cont","v":"editPostImage","vt":"str"},{"t":"cont","v":"editPostDescription","vt":"str"},{"t":"cont","v":"editPostSize","vt":"str"},{"t":"cont","v":"editPostHashtags","vt":"str"},{"t":"cont","v":"editPostName","vt":"str"}],"checkall":"true","repair":false,"outputs":6,"x":290,"y":4920,"wires":[["1be06dd7.9dcde2"],["469bbea9.cd848","9db0e866.4889a8"],["d0e4b7a6.099b88"],["e59950d7.3ef99"],["bb72b6e9.ba3008"],["22c0a752.a76dd8"]]},{"id":"e8bef9a8.d21e58","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["7ffe7719.cf69c8"],"x":55,"y":4920,"wires":[["25d71d10.662502"]]},{"id":"466b044.053cffc","type":"comment","z":"b6f7a7df.51a0e8","name":"Successfull Edit Post","info":"","x":180,"y":4840,"wires":[]},{"id":"46897755.5c0828","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictureCategoryDone","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictureCategoryDone\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1780,"y":4760,"wires":[["b5d0cdee.c8866"]]},{"id":"b5d0cdee.c8866","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1990,"y":4760,"wires":[["9258801.8190e8"]]},{"id":"7ffe7719.cf69c8","type":"link out","z":"b7ea2501.259358","name":"Successfull Edit Post","links":["e8bef9a8.d21e58"],"x":1280,"y":1080,"wires":[],"l":true},{"id":"6e803149.ef5d3","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1570,"y":4380,"wires":[["af8ce014.61a77"]]},{"id":"a7646f6c.8cdec","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = \"https://api.telegram.org/bot1642349293:AAFs_rRylHYO5VWf0uJe-A897aBfjtoJdu8/getFile\";\nmsg.method = \"GET\";\nmsg.payload = {\n    file_id: msg.text,\n    //url: msg.text\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1400,"y":4380,"wires":[["6e803149.ef5d3"]]},{"id":"2e04797.061a886","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1890,"y":4360,"wires":[[]]},{"id":"af8ce014.61a77","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.payload = {\n    artist_id: msg.chat_id,\n    externalPictureUrl: \"https://api.telegram.org/file/bot1642349293:AAFs_rRylHYO5VWf0uJe-A897aBfjtoJdu8/\"+msg.payload.result.file_path,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1740,"y":4380,"wires":[["2e04797.061a886"]]},{"id":"71a50dba.225434","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictureCategory","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictureCategory\",\n    templateVars: {\n        picture_id: msg.picture_id,\n        categories: msg.categories,\n    }\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":4080,"wires":[["b722ecd2.5fb9f"]]},{"id":"b722ecd2.5fb9f","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1190,"y":4080,"wires":[["d065cc2d.f4368"]]},{"id":"d065cc2d.f4368","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: `editPostCategory_${msg.picture_id}`\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1360,"y":4080,"wires":[["3650d0a2.f936c"]]},{"id":"3650d0a2.f936c","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1530,"y":4080,"wires":[[]]},{"id":"c87d1e5c.c8666","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictureDescription","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictureDescription\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":4240,"wires":[["bedb9682.2d7318"]]},{"id":"bedb9682.2d7318","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":770,"y":4240,"wires":[["b3e4ff8a.d0b35"]]},{"id":"b3e4ff8a.d0b35","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: `editPostDescription_${msg.picture_id}`,\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":4240,"wires":[["95037530.e33198"]]},{"id":"95037530.e33198","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1110,"y":4240,"wires":[[]]},{"id":"5c6c1af5.ba9a14","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictureSize","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictureSize\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":4320,"wires":[["a26a88d6.689cd8"]]},{"id":"a26a88d6.689cd8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":770,"y":4320,"wires":[["bc543e84.e952d"]]},{"id":"bc543e84.e952d","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: `editPostSize_${msg.picture_id}`,\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":4320,"wires":[["4333635.16eb69c"]]},{"id":"4333635.16eb69c","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1110,"y":4320,"wires":[[]]},{"id":"b4788e18.8b3ca","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictureHashtags","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictureHashtags\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":4400,"wires":[["3c93ed1a.738682"]]},{"id":"3c93ed1a.738682","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":770,"y":4400,"wires":[["505fd3b2.1989bc"]]},{"id":"505fd3b2.1989bc","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: `editPostHashtags_${msg.picture_id}`,\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":4400,"wires":[["98673de9.be032"]]},{"id":"98673de9.be032","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1110,"y":4400,"wires":[[]]},{"id":"971574be.c4e838","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictureName","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictureName\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":4480,"wires":[["ab479948.c06768"]]},{"id":"ab479948.c06768","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":770,"y":4480,"wires":[["4ecfd4e5.eb7e4c"]]},{"id":"4ecfd4e5.eb7e4c","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: `editPostName_${msg.picture_id}`,\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":4480,"wires":[["836bcb.1625f438"]]},{"id":"836bcb.1625f438","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1110,"y":4480,"wires":[[]]},{"id":"e6e4481.374acb8","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictureImageDone","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictureImageDone\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1870,"y":4800,"wires":[["ae23a741.eefb48"]]},{"id":"ae23a741.eefb48","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2070,"y":4800,"wires":[["9258801.8190e8"]]},{"id":"58c7a7f1.bb60c8","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictureDescriptionDone","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictureDescriptionDone\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1790,"y":4840,"wires":[["52bf2149.63f61"]]},{"id":"52bf2149.63f61","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2010,"y":4840,"wires":[["9258801.8190e8"]]},{"id":"af110d4b.240ca","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictureSizeDone","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictureSizeDone\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1770,"y":4880,"wires":[["a48398b2.b710f8"]]},{"id":"a48398b2.b710f8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1970,"y":4880,"wires":[["9258801.8190e8"]]},{"id":"db6d21a2.23f65","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictureHashtagsDone","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictureHashtagsDone\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1840,"y":4920,"wires":[["b193ed9d.4942a"]]},{"id":"b193ed9d.4942a","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2050,"y":4920,"wires":[["9258801.8190e8"]]},{"id":"787cf5ac.9539dc","type":"function","z":"b6f7a7df.51a0e8","name":"artEditPictureNameDone","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditPictureNameDone\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1770,"y":4960,"wires":[["9ae1f8db.013748"]]},{"id":"9ae1f8db.013748","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1970,"y":4960,"wires":[["9258801.8190e8"]]},{"id":"55d9536f.32858c","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["ac81cac7.c58c28","f8e8f451.93ac88","856c83b6.d33bf","fd36dae.09e2328"],"x":1275,"y":3420,"wires":[["75385ce9.6c3684","bf2ec33d.fd3b3"]]},{"id":"ac81cac7.c58c28","type":"link out","z":"b7ea2501.259358","name":"","links":["55d9536f.32858c","54afbb3f.87fd44"],"x":935,"y":860,"wires":[]},{"id":"d259be56.305d3","type":"function","z":"b6f7a7df.51a0e8","name":"artEditSelectedPictureDone","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artEditSelectedPictureDone\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags:msg.picture.hashtags ? '#' + msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1500,"y":4560,"wires":[["8651d3f1.8cdea"]]},{"id":"8651d3f1.8cdea","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1710,"y":4560,"wires":[["eb825791.635678"]]},{"id":"5eb11e16.1402","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.payload = {\n    id: msg.payload.settings.picture_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":4560,"wires":[["5c5be30a.1a292c"]]},{"id":"5c5be30a.1a292c","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":650,"y":4560,"wires":[["4e4a4499.f3277c"]]},{"id":"4e4a4499.f3277c","type":"function","z":"b6f7a7df.51a0e8","name":" save picture","func":"msg.picture = msg.payload;\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":830,"y":4560,"wires":[["f7b63d3b.ef3f8"]]},{"id":"469bbea9.cd848","type":"debug","z":"b6f7a7df.51a0e8","name":"126","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":350,"y":4780,"wires":[]},{"id":"85f0731a.bd2a3","type":"comment","z":"b6f7a7df.51a0e8","name":"10 ❤️підтянуввання зредагованої картинки зробити треба","info":"","x":800,"y":4520,"wires":[]},{"id":"a60376cb.2bb258","type":"link out","z":"b7ea2501.259358","name":"","links":["832ded42.3ac49"],"x":895,"y":840,"wires":[]},{"id":"832ded42.3ac49","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["a60376cb.2bb258"],"x":375,"y":4560,"wires":[["5eb11e16.1402"]]},{"id":"25345801.106e18","type":"comment","z":"b6f7a7df.51a0e8","name":"1 ❤️ через категоріі крашнулося і категоріі не приходять","info":"","x":660,"y":860,"wires":[]},{"id":"bc34d434.9e3008","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: 0,\n        action: msg.advertise_picture_action,\n    }\n};\nreturn msg;\n//msg.advertise_picture_action = 'advertise_picture';","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":260,"wires":[["51cedf92.4a6f3"]]},{"id":"51cedf92.4a6f3","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1250,"y":260,"wires":[[]]},{"id":"9eb618e6.fa1538","type":"function","z":"b6f7a7df.51a0e8","name":"artAdvertisingAllPicturesButton","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertisingAllPicturesButton\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   nickname: msg.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1130,"y":3640,"wires":[["f80ba26e.edf96"]]},{"id":"f80ba26e.edf96","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1350,"y":3640,"wires":[[]]},{"id":"3713a0a4.253ef","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":3640,"wires":[["9bd1dc22.0e411"]]},{"id":"e756983.cba4268","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: 0,\n        action: msg.delete_picture_action,\n    }\n};\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1520,"y":3640,"wires":[["8571f978.a8e7d8"]]},{"id":"8571f978.a8e7d8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1690,"y":3640,"wires":[[]]},{"id":"9bd1dc22.0e411","type":"function","z":"b6f7a7df.51a0e8","name":"artAdvertisingAllPicturesText","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertisingAllPicturesText\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":3640,"wires":[["ef36ffe3.3e749"]]},{"id":"ef36ffe3.3e749","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":910,"y":3640,"wires":[["9eb618e6.fa1538"]]},{"id":"4d7ef873.e644f8","type":"function","z":"b6f7a7df.51a0e8","name":"artAdvertisingAllPictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertisingAllPictures\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   nickname: msg.artist.nickname,\n\t   //nickname: msg.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2010,"y":3600,"wires":[["81405446.8ec568"]]},{"id":"81405446.8ec568","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2210,"y":3600,"wires":[["5406715f.a2eda"]]},{"id":"43c9a120.ab0c8","type":"comment","z":"b6f7a7df.51a0e8","name":"нема ще картин в художника","info":"","x":1530,"y":3460,"wires":[]},{"id":"9702caab.7fba78","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost +`/picture?artist_id=${msg.chat_id}&limit=1&user_id=${msg.chat_id}`;\nmsg.method = \"GET\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":620,"y":3520,"wires":[["cab6103d.2f6d8"]]},{"id":"cab6103d.2f6d8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":790,"y":3520,"wires":[["beea7bc1.957ac8"]]},{"id":"31cb66d9.cd59da","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1320,"y":3600,"wires":[["24fc9abe.319406"]]},{"id":"5406715f.a2eda","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: 0,\n        action: msg.advertise_picture_action,\n    }\n};\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2380,"y":3600,"wires":[["2e519e98.0b2622"]]},{"id":"2e519e98.0b2622","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2550,"y":3600,"wires":[[]]},{"id":"24fc9abe.319406","type":"function","z":"b6f7a7df.51a0e8","name":"artAdvertisingAllPicturesText","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertisingAllPicturesText\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1540,"y":3600,"wires":[["7abcfce0.a93e24"]]},{"id":"7abcfce0.a93e24","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1750,"y":3600,"wires":[["725b8f01.862b1"]]},{"id":"beea7bc1.957ac8","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"payload.length","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"gt","v":"0","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1150,"y":3520,"wires":[["be8dfd8d.8b9ed","c8722d60.b20f9"],["c6c2ac05.61cf9","31cb66d9.cd59da"]]},{"id":"c6c2ac05.61cf9","type":"debug","z":"b6f7a7df.51a0e8","name":"> 0","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1310,"y":3560,"wires":[]},{"id":"be8dfd8d.8b9ed","type":"debug","z":"b6f7a7df.51a0e8","name":"= 0","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1310,"y":3460,"wires":[]},{"id":"c8722d60.b20f9","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsWithoutPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertiseWithoutPicture\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1370,"y":3500,"wires":[["2dd550b7.27a0d"]]},{"id":"2dd550b7.27a0d","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1590,"y":3500,"wires":[[]]},{"id":"4948dd5a.965bc4","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2430,"y":2980,"wires":[]},{"id":"a8a36198.d518f","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":430,"y":2920,"wires":[]},{"id":"4ffabcb.23cff44","type":"function","z":"b6f7a7df.51a0e8","name":"artEditAdvertisingAllPictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    message_id: msg.originalMessage.callback_query.message.message_id,\n    templateName: \"artEditAdvertisingAllPictures\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2480,"y":3060,"wires":[["7567cfb3.013fc"]]},{"id":"7567cfb3.013fc","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2690,"y":3060,"wires":[[]]},{"id":"f6993b0e.0c3608","type":"comment","z":"b6f7a7df.51a0e8","name":"4 ❤️ коли вперід то нове повідомлення прихолить, а коли назад то все ок","info":"","x":2310,"y":2880,"wires":[]},{"id":"697579d5.ae23d8","type":"comment","z":"b6f7a7df.51a0e8","name":"8 ❤️ можливість перегляду зредагованого поста","info":"","x":610,"y":3840,"wires":[]},{"id":"f69244d3.060178","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture_id = msg.text.split('_')[1];\nmsg.url = msg.imageApiHost +`/picture?artist_id=${msg.chat_id}&id=${msg.picture_id}&user_id=${msg.chat_id}`;\nmsg.method = \"GET\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":3800,"wires":[["2ffa8d61.0c04c2"]]},{"id":"2ffa8d61.0c04c2","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":650,"y":3800,"wires":[["f5d42b7a.c1d478"]]},{"id":"28801b8.bec16e4","type":"function","z":"b6f7a7df.51a0e8","name":"artEditSelectedPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertisingSelectedPicture\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":3800,"wires":[["4a07dacf.a07964"]]},{"id":"4a07dacf.a07964","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1210,"y":3800,"wires":[["457bbd5a.79a8f4"]]},{"id":"f5d42b7a.c1d478","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\nmsg.picture.hashtags = msg.picture.Hashtags.map(hashtag => {return hashtag.tag; }).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":820,"y":3800,"wires":[["5ac7c4fc.d1031c"]]},{"id":"5ceba7c7.132798","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    // settings: {\n    //     currentViewPicture: msg.picture\n    // }\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1820,"y":3800,"wires":[["b54ffc39.2af81"]]},{"id":"b54ffc39.2af81","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1990,"y":3800,"wires":[[]]},{"id":"457bbd5a.79a8f4","type":"function","z":"b6f7a7df.51a0e8","name":"artAdvertisingPictureButton","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artAdvertisingPictureButton\",\n    templateVars: {\n        picture_id: msg.picture_id,\n    },\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1420,"y":3800,"wires":[["f94aa213.03ec5"]]},{"id":"f94aa213.03ec5","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1650,"y":3800,"wires":[["5ceba7c7.132798"]]},{"id":"d828764.5a09888","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":790,"y":820,"wires":[]},{"id":"683d173a.825338","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":950,"y":820,"wires":[]},{"id":"a31e298d.9ff7f8","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1110,"y":800,"wires":[]},{"id":"f3f05e71.b21a9","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1290,"y":800,"wires":[]},{"id":"bd8fb7db.064118","type":"debug","z":"b6f7a7df.51a0e8","name":"121","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1390,"y":2040,"wires":[]},{"id":"9ac67ba9.d8a3a8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture_id = msg.text.split('_')[1];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":200,"y":4260,"wires":[["20641cc1.a0ff74"]]},{"id":"e741b180.299b3","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost +`/categories`;\nmsg.method = \"GET\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":4080,"wires":[["d4a26d52.76909"]]},{"id":"d4a26d52.76909","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":650,"y":4080,"wires":[["47ce3ae9.1431b4"]]},{"id":"47ce3ae9.1431b4","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.categories = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":800,"y":4080,"wires":[["71a50dba.225434"]]},{"id":"b1727844.8b5a38","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.picture_id = msg.currentViewPicture.id;\nmsg.payload = {\n    id: msg.picture_id,\n    category_id: msg.category_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1340,"y":4760,"wires":[["8a8958f8.e038e8"]]},{"id":"8a8958f8.e038e8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1510,"y":4760,"wires":[["46897755.5c0828","1280ba5a.5d2a76"]]},{"id":"25d71d10.662502","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture_id = msg.state.split('_')[1];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":160,"y":4920,"wires":[["cd5c8af9.70b138"]]},{"id":"1be06dd7.9dcde2","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.category_id = msg.text.split('_')[1];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1180,"y":4760,"wires":[["b1727844.8b5a38"]]},{"id":"1280ba5a.5d2a76","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1690,"y":4700,"wires":[]},{"id":"9258801.8190e8","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"backFromEditPost\",\n    settings: {\n    picture_id: msg.picture_id,\n    }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2540,"y":4860,"wires":[["2a00a264.213b2e","c9caec10.c7274"]]},{"id":"2a00a264.213b2e","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2710,"y":4860,"wires":[[]]},{"id":"eb825791.635678","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1850,"y":4560,"wires":[]},{"id":"c9caec10.c7274","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2530,"y":4820,"wires":[]},{"id":"ee50c798.428948","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1330,"y":4800,"wires":[["7f1b96dd.d111e8"]]},{"id":"af72eb12.2233e8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = \"https://api.telegram.org/bot1730284858:AAHdzHY6NkNnPRuHMtl6PF1evR8BpcejtyY/getFile\";\nmsg.method = \"GET\";\nmsg.payload = {\n    file_id: msg.text,\n    //url: msg.text\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1160,"y":4800,"wires":[["ee50c798.428948"]]},{"id":"bec16400.081e3","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1670,"y":4800,"wires":[["e6e4481.374acb8"]]},{"id":"7f1b96dd.d111e8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.picture_id = msg.currentViewPicture.id;\nmsg.payload = {\n    id: msg.picture_id,\n    externalPictureUrl: \"https://api.telegram.org/file/bot1730284858:AAHdzHY6NkNnPRuHMtl6PF1evR8BpcejtyY/\"+msg.payload.result.file_path,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1500,"y":4800,"wires":[["bec16400.081e3"]]},{"id":"c3b82a05.01c778","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.picture_id = msg.currentViewPicture.id;\nmsg.payload = {\n    //id: msg.picture_id,\n    id: msg.picture_id,\n    description: msg.text,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1160,"y":4840,"wires":[["d91e60cb.a1e68"]]},{"id":"d91e60cb.a1e68","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1330,"y":4840,"wires":[["58c7a7f1.bb60c8"]]},{"id":"4bad5ca2.ca88b4","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1330,"y":4880,"wires":[["af110d4b.240ca"]]},{"id":"338c4f43.4ae87","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.size = msg.text.split(\"-\");\n\nmsg.picture_id = msg.currentViewPicture.id;\n\nmsg.payload = {\n    id: msg.picture_id,\n    //height: msg.text.split('-')[0],\n    //width: msg.text.split('-')[1]\n    height: msg.size[0],\n    width: msg.size[1]\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1160,"y":4880,"wires":[["4bad5ca2.ca88b4"]]},{"id":"45da387c.b054c8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1630,"y":4920,"wires":[["db6d21a2.23f65"]]},{"id":"78cbe61d.c28848","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"let text = msg.text;\n\n//text = text.replace(/\\s/g, '');\n\ntext = text.replace(/# /g, \"#\");\n\ntext = text.replace(',', \"\");\n\nif(text[0] == '#') {\ntext = text.substring(1, text.length);\nconsole.log(text);\n}\n\nmsg.hashtags = text.split('#');\n\nreturn msg;\n//msg.picture.hashtags = msg.picture.hashtags.replace(/# /g, \"#\");","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1340,"y":4920,"wires":[["ebb67dad.63c43"]]},{"id":"ebb67dad.63c43","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/hashtags\";\nmsg.method = \"POST\";\nmsg.payload = {\n  picture_id: msg.picture_id, \n  hashtags: msg.hashtags,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1480,"y":4920,"wires":[["45da387c.b054c8"]]},{"id":"7c5d87de.c44e48","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1190,"y":4920,"wires":[["78cbe61d.c28848"]]},{"id":"45504fa6.32ac2","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture_id = msg.currentViewPicture.id;\n\nmsg.url = msg.imageApiHost +`/hashtags/${msg.picture_id}`;\nmsg.method = \"DELETE\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":4920,"wires":[["7c5d87de.c44e48"]]},{"id":"cf7b8ded.1d367","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.picture_id = msg.currentViewPicture.id;\nmsg.payload = {\n    id: msg.picture_id,\n    name: msg.text,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":4960,"wires":[["8d8c0a0f.c18eb8"]]},{"id":"8d8c0a0f.c18eb8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1290,"y":4960,"wires":[["787cf5ac.9539dc"]]},{"id":"eda21d5e.bdd5a","type":"function","z":"b7ea2501.259358","name":"helloBuyer","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"helloBuyer\"\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":590,"y":1640,"wires":[["fa594d34.f47b4"]]},{"id":"fa594d34.f47b4","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":750,"y":1640,"wires":[["e9aa89fc.b9fa18"]]},{"id":"e9aa89fc.b9fa18","type":"function","z":"b7ea2501.259358","name":"helloBuyerStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"helloBuyerStiker\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":1640,"wires":[["7fa5a6d9.2d31f8"]]},{"id":"7fa5a6d9.2d31f8","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1110,"y":1640,"wires":[["ac772675.440d68"]]},{"id":"ac772675.440d68","type":"function","z":"b7ea2501.259358","name":"buyerMenu","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    type: msg.buyerType,\n    lang: msg.lang,\n    templateName: \"buyerMenu\"\n};\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1270,"y":1640,"wires":[["8c67fb7.2067308"]]},{"id":"8c67fb7.2067308","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1450,"y":1640,"wires":[["2a99d300.2f3a7e"]]},{"id":"d60676e5.98f478","type":"switch","z":"902edb22.d683d8","name":"","property":"text","propertyType":"msg","rules":[{"t":"eq","v":"searchPictures","vt":"str"},{"t":"eq","v":"searchByArtist","vt":"str"},{"t":"eq","v":"searchByCategory","vt":"str"},{"t":"eq","v":"searchBySize","vt":"str"},{"t":"eq","v":"searchByHashtag","vt":"str"},{"t":"cont","v":"categIdSPic","vt":"str"},{"t":"cont","v":"artistIdSPic","vt":"str"},{"t":"eq","v":"nextPicture","vt":"str"},{"t":"eq","v":"backPicture","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":10,"x":230,"y":340,"wires":[["dc887f7a.04034","48c6fd69.df7a54"],["36a220e3.c0893"],["23adb97e.e22d56"],["2c5e9c8.1780064"],["2940a23.6fedc5e"],["668ed1be.89ee7"],["17212412.11491c"],["58b27d25.6bb384"],["aabe644d.2e1548"],["d8d1eb90.214f08"]]},{"id":"bfca82c2.55ff","type":"comment","z":"902edb22.d683d8","name":"пошук картин","info":"","x":650,"y":140,"wires":[]},{"id":"335432b5.fe907e","type":"link in","z":"902edb22.d683d8","name":"","links":["c6c13a30.aa4188","11a91b72.7f2615"],"x":125,"y":340,"wires":[["d60676e5.98f478","f9654741.b69288"]]},{"id":"6353ebe0.36e7e4","type":"function","z":"902edb22.d683d8","name":"buyerSerchPictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerSerchPictures\"\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":670,"y":120,"wires":[["bdaa3fdb.9df31"]]},{"id":"bdaa3fdb.9df31","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":850,"y":120,"wires":[["2893f2b.10cb20e"]]},{"id":"c6c13a30.aa4188","type":"link out","z":"b7ea2501.259358","name":"searchPictures","links":["335432b5.fe907e"],"x":600,"y":1680,"wires":[],"l":true},{"id":"e9de4b25.810848","type":"function","z":"902edb22.d683d8","name":"buyerSearchPicturesByArtist","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerSearchPicturesByArtist\",\n    templateVars: {\n        artists: msg.artists,\n    }\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1360,"y":220,"wires":[["c07775df.0faf78"]]},{"id":"c07775df.0faf78","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1570,"y":220,"wires":[[]]},{"id":"87aee35c.87e3a","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":570,"y":200,"wires":[["f10a4e80.1ca11"]]},{"id":"36a220e3.c0893","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost + \"/artists\";\nmsg.method = \"GET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":420,"y":220,"wires":[["87aee35c.87e3a"]]},{"id":"f10a4e80.1ca11","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist_ids = msg.payload.map(artist => artist.artist_id);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":220,"wires":[["7be2d678.065968"]]},{"id":"b129a6ed.522d18","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1010,"y":220,"wires":[["c360c213.944f2"]]},{"id":"7be2d678.065968","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/findUsers\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.artist_ids,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":220,"wires":[["b129a6ed.522d18"]]},{"id":"c360c213.944f2","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artists = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1160,"y":220,"wires":[["e9de4b25.810848"]]},{"id":"dcd5dcc8.d253d","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":250,"y":580,"wires":[["355d7c2.0f91984","ee50638a.d06c8"]]},{"id":"17212412.11491c","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist_id = msg.text.split('_')[1];\nmsg.url = msg.imageApiHost+`/picture?artist_id=${msg.artist_id}&user_id=${msg.chat_id}`;\nmsg.method = \"GET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":100,"y":580,"wires":[["dcd5dcc8.d253d"]]},{"id":"24a011df.8479de","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":560,"y":580,"wires":[["e97ef23b.e1c0c"]]},{"id":"578566e.ed7c798","type":"function","z":"902edb22.d683d8","name":"buyerViewPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerViewPicture\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   \n\t   //category: msg.picture.category.settings[msg.lang],\n\t   \n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t   liked: !!msg.picture.likes.length,\n\t   \n\t }\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1170,"y":580,"wires":[["64683c8b.fc6f64"]]},{"id":"64683c8b.fc6f64","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1350,"y":580,"wires":[["b99791b1.55fff"]]},{"id":"b99791b1.55fff","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: 0,\n        searchType: msg.byArtistSearchType,\n        artist_id: msg.artist_id,\n    }\n};\nmsg.settings.searchType = msg.byArtistSearchType;\nmsg.settings.artist_id = msg.artist_id;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1500,"y":580,"wires":[["4782ab35.b34f04"]]},{"id":"4782ab35.b34f04","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1650,"y":580,"wires":[["576ccb61.0428f4"]]},{"id":"d838944c.836b08","type":"switch","z":"b7ea2501.259358","name":"","property":"text","propertyType":"msg","rules":[{"t":"eq","v":"/start","vt":"str"},{"t":"regex","v":"((\\+38)?\\(?\\d{3}\\)?[\\s\\.-]?(\\d{7}|\\d{3}[\\s\\.-]\\d{2}[\\s\\.-]\\d{2}|\\d{3}-\\d{4}))","vt":"str","case":false},{"t":"eq","v":"uk","vt":"str"},{"t":"eq","v":"ru","vt":"str"},{"t":"eq","v":"en","vt":"str"},{"t":"eq","v":"artist","vt":"str"},{"t":"eq","v":"buyer","vt":"str"},{"t":"eq","v":"buyerSettings","vt":"str"},{"t":"eq","v":"changeType","vt":"str"},{"t":"eq","v":"changeArtistName","vt":"str"},{"t":"cont","v":"advertising_","vt":"str"},{"t":"cont","v":"statisic_","vt":"str"},{"t":"eq","v":"artistSettings","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":14,"x":240,"y":560,"wires":[["76212031.cf29e"],["76212031.cf29e"],["76212031.cf29e"],["76212031.cf29e"],["76212031.cf29e"],["76212031.cf29e"],["76212031.cf29e","64919c35.e21a74"],["76212031.cf29e"],["76212031.cf29e"],["76212031.cf29e"],["e4597c47.4f181"],["e4597c47.4f181"],["76212031.cf29e"],["66221561.86d3ac"]]},{"id":"66a93ff2.bff58","type":"link in","z":"e35da61b.7ab028","name":"","links":["797efec.2a7aa","76212031.cf29e","8ad96a68.cabe58"],"x":155,"y":240,"wires":[["86234c61.ae562","ecf78b61.3d1c08"]]},{"id":"8a2b3669.eb59c8","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":750,"y":180,"wires":[["53638cb.dd33e74","574b5087.b4bb6"]]},{"id":"9957eaec.11d238","type":"function","z":"e35da61b.7ab028","name":"startNumberMessage","func":"//msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.url = msg.messageApiHost+\"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    templateName: \"startNumberMessage\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":560,"y":180,"wires":[["8a2b3669.eb59c8"]]},{"id":"a607796b.515168","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":770,"y":260,"wires":[["68d8cec6.9c976"]]},{"id":"b6a5a69.6a42758","type":"function","z":"e35da61b.7ab028","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.text\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":260,"wires":[["a607796b.515168"]]},{"id":"b0295c.ba09a6a8","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1170,"y":260,"wires":[["e4eef3cf.50fd9"]]},{"id":"68d8cec6.9c976","type":"function","z":"e35da61b.7ab028","name":"chooseWhoAreYou","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.text,\n    templateName: \"chooseWhoAreYou\",\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":970,"y":260,"wires":[["b0295c.ba09a6a8"]]},{"id":"5b3e4267.51e55c","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1070,"y":220,"wires":[["dd2e90e4.ff929"]]},{"id":"f47ee58f.3c62a8","type":"function","z":"e35da61b.7ab028","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    phone: msg.text,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":800,"y":220,"wires":[["5b3e4267.51e55c"]]},{"id":"dd2e90e4.ff929","type":"function","z":"e35da61b.7ab028","name":"succesRegistration","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"succesRegistration\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1270,"y":220,"wires":[["62a45e98.85da6"]]},{"id":"62a45e98.85da6","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1490,"y":220,"wires":[["8fd37a1a.3f5968"]]},{"id":"a29dae3a.8be17","type":"function","z":"e35da61b.7ab028","name":"chooseLanguage","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    //lang: msg.lang,\n    templateName: \"chooseLanguage\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2130,"y":220,"wires":[["21a903c3.ff7dac"]]},{"id":"21a903c3.ff7dac","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2310,"y":220,"wires":[["1e42fb96.eae254","afcc8e2e.d2a88"]]},{"id":"8fd37a1a.3f5968","type":"function","z":"e35da61b.7ab028","name":"succesRegistrationStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    //lang: msg.lang,\n    templateName: \"succesRegistrationStiker\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1710,"y":220,"wires":[["c0980bae.f3fd08"]]},{"id":"c0980bae.f3fd08","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1930,"y":220,"wires":[["a29dae3a.8be17"]]},{"id":"76212031.cf29e","type":"link out","z":"b7ea2501.259358","name":"","links":["66a93ff2.bff58"],"x":385,"y":480,"wires":[]},{"id":"86234c61.ae562","type":"switch","z":"e35da61b.7ab028","name":"","property":"text","propertyType":"msg","rules":[{"t":"eq","v":"/start","vt":"str"},{"t":"regex","v":"((\\+38)?\\(?\\d{3}\\)?[\\s\\.-]?(\\d{7}|\\d{3}[\\s\\.-]\\d{2}[\\s\\.-]\\d{2}|\\d{3}-\\d{4}))","vt":"str","case":false},{"t":"eq","v":"uk","vt":"str"},{"t":"eq","v":"ru","vt":"str"},{"t":"eq","v":"en","vt":"str"},{"t":"eq","v":"artist","vt":"str"},{"t":"eq","v":"buyer","vt":"str"},{"t":"eq","v":"buyerSettings","vt":"str"},{"t":"eq","v":"artistSettings","vt":"str"},{"t":"eq","v":"changeType","vt":"str"},{"t":"eq","v":"changeArtistName","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":12,"x":310,"y":240,"wires":[["9957eaec.11d238"],["67a45cae.ec4694"],["b6a5a69.6a42758","1d36ffa6.eb799"],["b6a5a69.6a42758","1d36ffa6.eb799"],["b6a5a69.6a42758"],["eec50dcd.65b57","1b68efc6.45d6"],["8e4c78fd.0e8c98","8e7c64e4.6591e8"],["9f3861d8.a91ec","99fbedff.b3f4e"],["db49769c.e024a8","454dbf1a.c1f62"],["54dfb14.39f565"],["5da1f535.69567c","6f5d1c9f.7d54a4"],["a91a57e1.925278"]]},{"id":"8e4c78fd.0e8c98","type":"link out","z":"e35da61b.7ab028","name":"buyer","links":["53880733.6647b8"],"x":470,"y":340,"wires":[],"l":true},{"id":"eec50dcd.65b57","type":"link out","z":"e35da61b.7ab028","name":"artist","links":["2415268a.14b25a"],"x":490,"y":300,"wires":[],"l":true},{"id":"2415268a.14b25a","type":"link in","z":"b7ea2501.259358","name":"","links":["eec50dcd.65b57","fb6cd115.dfff5","e6dd5da4.115aa"],"x":1055,"y":500,"wires":[["587c6fd7.98d99"]]},{"id":"58b27d25.6bb384","type":"function","z":"902edb22.d683d8","name":"","func":"msg.method = \"GET\";\nif(msg.settings.searchType == msg.byArtistSearchType){\n    msg.url = msg.imageApiHost +`/picture?artist_id=${msg.settings.artist_id}&user_id=${msg.chat_id}`;\n}\nif(msg.settings.searchType == msg.byCategorySearchType){\n    msg.url = msg.imageApiHost +`/picture?category_id=${msg.settings.category_id}&user_id=${msg.chat_id}`;\n}\nif(msg.settings.searchType == msg.byHistorySearchType){\n    msg.url = msg.imageApiHost +`/findPicturesByHistory?user_id=${msg.chat_id}`;\n}\nif(msg.settings.searchType == msg.byLikedSearchType){\n    msg.url = msg.imageApiHost +`/findPicturesByLiked?user_id=${msg.chat_id}`;\n}\nif(msg.settings.searchType == msg.bySizeSearchType){\n    msg.url = msg.imageApiHost +`/findPicturesBySize`;\n    msg.method = \"POST\";\n    msg.payload = {\n        minSize: msg.settings.minSize,\n        maxSize: msg.settings.maxSize,\n        user_id: msg.chat_id,\n    };\n}\nif(msg.settings.searchType == msg.byHashtagSearchType){\n    msg.url = msg.imageApiHost +`/pictureByHashtags`;\n    msg.method = \"POST\";\n    msg.payload = {\n        hashtags: msg.settings.searchHashtags,\n        user_id: msg.chat_id,\n    };\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":400,"y":700,"wires":[["35b78092.ec137"]]},{"id":"35b78092.ec137","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":550,"y":700,"wires":[["e8cfe30b.ab808"]]},{"id":"e8cfe30b.ab808","type":"function","z":"902edb22.d683d8","name":"","func":"msg.numberOfArtistsPictures = msg.payload.length;\nmsg.picture_index = msg.settings.picture_index;\nif(!msg.picture_index) {\n    msg.picture_index = 1;\n} else {\n    msg.picture_index++;\n}\nif(msg.picture_index >= msg.numberOfArtistsPictures) {\n    msg.picture_index = 0;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":700,"wires":[["c6aa9f99.79fa6"]]},{"id":"3641fbd7.3dab94","type":"comment","z":"902edb22.d683d8","name":"3 ❤️ натискання кнопки \"далі\"","info":"","x":470,"y":660,"wires":[]},{"id":"3c4b33c6.4e3d6c","type":"comment","z":"902edb22.d683d8","name":"4 ❤️ натискання кнопки \"назад\"","info":"","x":480,"y":740,"wires":[]},{"id":"c6aa9f99.79fa6","type":"function","z":"902edb22.d683d8","name":"","func":"msg.method = \"GET\";\nif(msg.settings.searchType == msg.byArtistSearchType){\n    msg.url = msg.imageApiHost +`/picture?user_id=${msg.chat_id}&artist_id=${msg.settings.artist_id}&limit=1&offset=${msg.picture_index}`;\n}\nif(msg.settings.searchType == msg.byCategorySearchType){\n    msg.url = msg.imageApiHost +`/picture?user_id=${msg.chat_id}&category_id=${msg.settings.category_id}&limit=1&offset=${msg.picture_index}`;\n}\nif(msg.settings.searchType == msg.byHistorySearchType){\n    msg.url = msg.imageApiHost +`/findPicturesByHistory?user_id=${msg.chat_id}&limit=1&offset=${msg.picture_index}`;\n}\nif(msg.settings.searchType == msg.byLikedSearchType){\n    msg.url = msg.imageApiHost +`/findPicturesByLiked?user_id=${msg.chat_id}&limit=1&offset=${msg.picture_index}`;\n}\nif(msg.settings.searchType == msg.bySizeSearchType){\n    msg.url = msg.imageApiHost +`/findPicturesBySize`;\n    msg.method = \"POST\";\n    msg.payload = {\n        minSize: msg.settings.minSize,\n        maxSize: msg.settings.maxSize,\n        limit: 1,\n        offset: msg.picture_index,\n        user_id: msg.chat_id,\n    };\n}\nif(msg.settings.searchType == msg.byHashtagSearchType){\n    msg.url = msg.imageApiHost +`/pictureByHashtags`;\n    msg.method = \"POST\";\n    msg.payload = {\n        hashtags: msg.settings.searchHashtags,\n        limit: 1,\n        offset: msg.picture_index,\n        user_id: msg.chat_id,\n    };\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":840,"y":700,"wires":[["55b4d35f.544fac"]]},{"id":"55b4d35f.544fac","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":990,"y":700,"wires":[["d9669895.17d4f8"]]},{"id":"d9669895.17d4f8","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture = msg.payload[0].Picture ? msg.payload[0].Picture : msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1140,"y":700,"wires":[["7d3ebc08.26e7b4"]]},{"id":"aabe644d.2e1548","type":"function","z":"902edb22.d683d8","name":"","func":"msg.method = \"GET\";\nif(msg.settings.searchType == msg.byArtistSearchType){\n    msg.url = msg.imageApiHost +`/picture?artist_id=${msg.settings.artist_id}&user_id=${msg.chat_id}`;\n}\nif(msg.settings.searchType == msg.byCategorySearchType){\n    msg.url = msg.imageApiHost +`/picture?category_id=${msg.settings.category_id}&user_id=${msg.chat_id}`;\n}\nif(msg.settings.searchType == msg.byHistorySearchType){\n    msg.url = msg.imageApiHost +`/findPicturesByHistory?user_id=${msg.chat_id}`;\n}\nif(msg.settings.searchType == msg.byLikedSearchType){\n    msg.url = msg.imageApiHost +`/findPicturesByLiked?user_id=${msg.chat_id}`;\n}\nif(msg.settings.searchType == msg.bySizeSearchType){\n    msg.url = msg.imageApiHost +`/findPicturesBySize`;\n    msg.method = \"POST\";\n    msg.payload = {\n        minSize: msg.settings.minSize,\n        maxSize: msg.settings.maxSize,\n        user_id: msg.chat_id,\n    };\n}\nif(msg.settings.searchType == msg.byHashtagSearchType){\n    msg.url = msg.imageApiHost +`/pictureByHashtags`;\n    msg.method = \"POST\";\n    msg.payload = {\n        hashtags: msg.settings.searchHashtags,\n        user_id: msg.chat_id,\n    };\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":400,"y":780,"wires":[["6cacba3f.7c5184","65987700.aa4a68"]]},{"id":"6cacba3f.7c5184","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":550,"y":780,"wires":[["a180e4cf.833268","16a8a2ac.5d15fd"]]},{"id":"a180e4cf.833268","type":"function","z":"902edb22.d683d8","name":"","func":"msg.numberOfArtistsPictures = msg.payload.length;\nmsg.picture_index = msg.settings.picture_index;\nif(!msg.picture_index) {\n    msg.picture_index = msg.numberOfArtistsPictures - 1;\n} else {\n    msg.picture_index--;\n}\nif(msg.picture_index < 0) {\n    msg.picture_index = msg.numberOfArtistsPictures - 1;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":780,"wires":[["17ba91b6.15995e"]]},{"id":"17ba91b6.15995e","type":"function","z":"902edb22.d683d8","name":"","func":"msg.method = \"GET\";\nif(msg.settings.searchType == msg.byArtistSearchType){\n    msg.url = msg.imageApiHost +`/picture?user_id=${msg.chat_id}&artist_id=${msg.settings.artist_id}&limit=1&offset=${msg.picture_index}`;\n}\nif(msg.settings.searchType == msg.byCategorySearchType){\n    msg.url = msg.imageApiHost +`/picture?user_id=${msg.chat_id}&category_id=${msg.settings.category_id}&limit=1&offset=${msg.picture_index}`;\n}\nif(msg.settings.searchType == msg.byHistorySearchType){\n    msg.url = msg.imageApiHost +`/findPicturesByHistory?user_id=${msg.chat_id}&limit=1&offset=${msg.picture_index}`;\n}\nif(msg.settings.searchType == msg.byLikedSearchType){\n    msg.url = msg.imageApiHost +`/findPicturesByLiked?user_id=${msg.chat_id}&limit=1&offset=${msg.picture_index}`;\n}\nif(msg.settings.searchType == msg.bySizeSearchType){\n    msg.url = msg.imageApiHost +`/findPicturesBySize`;\n    msg.method = \"POST\";\n    msg.payload = {\n        minSize: msg.settings.minSize,\n        maxSize: msg.settings.maxSize,\n        limit: 1,\n        offset: msg.picture_index,\n        user_id: msg.chat_id,\n    };\n}\nif(msg.settings.searchType == msg.byHashtagSearchType){\n    msg.url = msg.imageApiHost +`/pictureByHashtags`;\n    msg.method = \"POST\";\n    msg.payload = {\n        hashtags: msg.settings.searchHashtags,\n        limit: 1,\n        offset: msg.picture_index,\n        user_id: msg.chat_id,\n    };\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":840,"y":780,"wires":[["e8e054bd.cc1558"]]},{"id":"e8e054bd.cc1558","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":990,"y":780,"wires":[["960cc4d3.16efc8","87581be9.4a9798"]]},{"id":"960cc4d3.16efc8","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture = msg.payload[0].Picture ? msg.payload[0].Picture : msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1140,"y":780,"wires":[["7d3ebc08.26e7b4"]]},{"id":"7d3ebc08.26e7b4","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: msg.picture_index,\n    }\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1320,"y":740,"wires":[["51cf6376.a90cdc","c316dfe0.0b16a"]]},{"id":"51cf6376.a90cdc","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1470,"y":740,"wires":[["26892b69.7b3404","539c30cd.a2cfd"]]},{"id":"c316dfe0.0b16a","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1310,"y":700,"wires":[]},{"id":"26892b69.7b3404","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1490,"y":700,"wires":[]},{"id":"65987700.aa4a68","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":390,"y":820,"wires":[]},{"id":"16a8a2ac.5d15fd","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":530,"y":820,"wires":[]},{"id":"87581be9.4a9798","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":970,"y":820,"wires":[]},{"id":"e5d2bce8.5ec82","type":"function","z":"902edb22.d683d8","name":"bayerSearchCategoryId","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"bayerSearchCategoryId\",\n    templateVars: {\n        categories: msg.categories,\n    }\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":910,"y":260,"wires":[["511be467.d1c84c"]]},{"id":"511be467.d1c84c","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1110,"y":260,"wires":[[]]},{"id":"cdb4fef3.2e431","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":570,"y":260,"wires":[["ed3e3406.60cad8"]]},{"id":"23adb97e.e22d56","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost + \"/categories\";\nmsg.method = \"GET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":420,"y":260,"wires":[["cdb4fef3.2e431"]]},{"id":"ed3e3406.60cad8","type":"function","z":"902edb22.d683d8","name":"","func":"msg.categories = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":260,"wires":[["e5d2bce8.5ec82"]]},{"id":"55488738.6191e8","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":550,"y":500,"wires":[["4a9ea644.799408"]]},{"id":"668ed1be.89ee7","type":"function","z":"902edb22.d683d8","name":"","func":"msg.category_id = msg.text.split('_')[1];\nmsg.url = msg.imageApiHost +`/picture?category_id=${msg.category_id}&user_id=${msg.chat_id}`;\nmsg.method = \"GET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":400,"y":500,"wires":[["55488738.6191e8","7b41cab0.866d04"]]},{"id":"47981ae9.751314","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":500,"wires":[["4bcdf402.a1786c"]]},{"id":"db1c05a.40855f8","type":"function","z":"902edb22.d683d8","name":"buyerViewPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerViewPicture\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\t   \n\t   liked: !!msg.picture.likes.length\n\t }\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":500,"wires":[["57d1e03c.986d5","a157bbde.cfa598"]]},{"id":"57d1e03c.986d5","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1070,"y":500,"wires":[["166f2499.07e48b"]]},{"id":"166f2499.07e48b","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: 0,\n        searchType: msg.byCategorySearchType,\n        category_id: msg.category_id,\n    }\n};\nmsg.settings.searchType = msg.byCategorySearchType;\nmsg.settings.category_id = msg.category_id;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1220,"y":500,"wires":[["352e28e9.ec6af8"]]},{"id":"352e28e9.ec6af8","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1370,"y":500,"wires":[["309178d6.505838"]]},{"id":"7b41cab0.866d04","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":450,"y":460,"wires":[]},{"id":"a157bbde.cfa598","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":830,"y":540,"wires":[]},{"id":"57b91bf.d5a04e4","type":"function","z":"b6f7a7df.51a0e8","name":"changeTypeToArtistStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    //templateName: \"changeWhoAreYou\"\n    templateName: \"changeTypeToArtistStiker\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":650,"y":660,"wires":[["d3cba4ef.fbed88"]]},{"id":"d3cba4ef.fbed88","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":870,"y":660,"wires":[["b1ea68f1.787d58"]]},{"id":"8a7934ba.085bc8","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":510,"y":420,"wires":[]},{"id":"f9654741.b69288","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":164,"y":232,"wires":[]},{"id":"9f3861d8.a91ec","type":"debug","z":"e35da61b.7ab028","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":90,"y":580,"wires":[]},{"id":"99fbedff.b3f4e","type":"function","z":"e35da61b.7ab028","name":"changeTypeToArtistStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"changeTypeToArtistStiker\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":380,"wires":[["81077910.08e558"]]},{"id":"81077910.08e558","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":670,"y":380,"wires":[["63f923e.7fd58dc"]]},{"id":"63f923e.7fd58dc","type":"function","z":"e35da61b.7ab028","name":"changeTypeToArtist","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"changeTypeToArtist\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":850,"y":380,"wires":[["77becde1.950bc4"]]},{"id":"77becde1.950bc4","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1030,"y":380,"wires":[[]]},{"id":"fb6cd115.dfff5","type":"link out","z":"b7ea2501.259358","name":"","links":["2415268a.14b25a"],"x":475,"y":1660,"wires":[]},{"id":"54dfb14.39f565","type":"function","z":"e35da61b.7ab028","name":"changeTypeToArtistStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"changeTypeToArtistStiker\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":460,"wires":[["f52eb816.2aab48"]]},{"id":"f52eb816.2aab48","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":670,"y":460,"wires":[["93a1a2c7.f191f"]]},{"id":"93a1a2c7.f191f","type":"function","z":"e35da61b.7ab028","name":"changeTypeToBuyer","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"changeTypeToBuyer\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":460,"wires":[["a8f7859d.4860c8"]]},{"id":"a8f7859d.4860c8","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1050,"y":460,"wires":[["1fa487ed.13cbe8"]]},{"id":"b51dc91c.e2c9b8","type":"function","z":"b7ea2501.259358","name":"buyerMenu","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerMenu\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":610,"y":1840,"wires":[["54557294.2a0c1c"]]},{"id":"54557294.2a0c1c","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":770,"y":1840,"wires":[["54f2fdf0.8e4b74"]]},{"id":"2c5e9c8.1780064","type":"function","z":"902edb22.d683d8","name":"buyerSearchBySizeSetMin","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerSearchBySizeSetMin\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":300,"wires":[["4c735836.7b5cf8"]]},{"id":"4c735836.7b5cf8","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":910,"y":300,"wires":[["a988d9ce.d31608"]]},{"id":"a988d9ce.d31608","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    state: 'inputMinSize',\n    settings: {\n        picture_index: 0,\n        searchType: msg.bySizeSearchType,\n    }\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":300,"wires":[["c5cf8440.a31f48"]]},{"id":"c5cf8440.a31f48","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1250,"y":300,"wires":[[]]},{"id":"703c4439.8622fc","type":"switch","z":"902edb22.d683d8","name":"state","property":"state","propertyType":"msg","rules":[{"t":"eq","v":"inputMinSize","vt":"str"},{"t":"eq","v":"inputMaxSize","vt":"str"},{"t":"eq","v":"inputSearchHashtags","vt":"str"},{"t":"eq","v":"contactWithAdministrator","vt":"str"},{"t":"eq","v":"buyerSerchPictures","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":6,"x":210,"y":1060,"wires":[["bc965819.f9c268"],["40498ac.041a474"],["be4979ca.8688c8"],["34fe999.b290166"],["be4979ca.8688c8"],["95318822.805768"]]},{"id":"77796d85.9e74c4","type":"link in","z":"902edb22.d683d8","name":"","links":["d56bdfa4.887f6"],"x":115,"y":1060,"wires":[["703c4439.8622fc"]]},{"id":"d56bdfa4.887f6","type":"link out","z":"b7ea2501.259358","name":"","links":["77796d85.9e74c4"],"x":735,"y":2060,"wires":[]},{"id":"cdc25d4.560e6a","type":"function","z":"902edb22.d683d8","name":"buyerSearchBySizeSetMax","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerSearchBySizeSetMax\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":620,"y":980,"wires":[["d8893843.157388"]]},{"id":"d8893843.157388","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":830,"y":980,"wires":[["a1a9b8ec.57f508"]]},{"id":"a1a9b8ec.57f508","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    state: 'inputMaxSize',\n    settings: {\n        picture_index: 0,\n        searchType: msg.bySizeSearchType,\n        searchMinSize: msg.text,\n    }\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":980,"wires":[["584bfe43.7e38a"]]},{"id":"584bfe43.7e38a","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1130,"y":980,"wires":[[]]},{"id":"644b9b3b.eef744","type":"function","z":"902edb22.d683d8","name":"","func":"msg.minSize = msg.settings.searchMinSize.split('-');\nmsg.maxSize = msg.text.split('-');\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":380,"y":1060,"wires":[["6e1c0967.e08338"]]},{"id":"b9f0b30c.27a02","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":670,"y":1060,"wires":[["ed74124d.3a797","21d5e9cf.b8c556"]]},{"id":"6e1c0967.e08338","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost +`/findPicturesBySize`;\nmsg.method = \"POST\";\nmsg.payload = {\n    minSize: msg.minSize,\n    maxSize: msg.maxSize,\n    limit: 1,\n    user_id: msg.chat_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1060,"wires":[["b9f0b30c.27a02"]]},{"id":"4e95f733.a3b768","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;\n\n// msg.picture = msg.payload[0].Picture ? msg.payload[0].Picture : msg.payload[0];\n// if(msg.picture.Hashtags.length) {\n//     msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n// }\n// return msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":960,"y":1060,"wires":[["c01de3e.38b922"]]},{"id":"84ccb949.05e1d8","type":"function","z":"902edb22.d683d8","name":"buyerViewPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerViewPicture\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t   liked: !!msg.picture.likes.length\n\t }\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1130,"y":1060,"wires":[["e21b1050.a25b3"]]},{"id":"e21b1050.a25b3","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1310,"y":1060,"wires":[["184546fe.0d7419"]]},{"id":"184546fe.0d7419","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: 0,\n        searchType: msg.bySizeSearchType,\n        category_id: msg.category_id,\n        maxSize: msg.maxSize,\n        minSize: msg.minSize,\n    },\n};\nmsg.settings.searchType = msg.bySizeSearchType;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1460,"y":1060,"wires":[["be805e4.6074ba"]]},{"id":"be805e4.6074ba","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1610,"y":1060,"wires":[["c20a8460.cff968"]]},{"id":"2940a23.6fedc5e","type":"function","z":"902edb22.d683d8","name":"buyerSearchByHashtag","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerSearchByHashtag\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":340,"wires":[["a49ebb5c.20c188"]]},{"id":"a49ebb5c.20c188","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":690,"y":340,"wires":[["e365108a.fc80a"]]},{"id":"e365108a.fc80a","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    state: 'inputSearchHashtags',\n    settings: {\n        picture_index: 0,\n        searchType: msg.byHashtagSearchType,\n    }\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":340,"wires":[["b80e2e00.333da"]]},{"id":"b80e2e00.333da","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1030,"y":340,"wires":[[]]},{"id":"be4979ca.8688c8","type":"function","z":"902edb22.d683d8","name":"","func":"msg.text = msg.text.toLowerCase();\nmsg.hashtags = msg.text.replace(/\\s,./g, '');\nmsg.hashtags = msg.hashtags.split('#');\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":380,"y":1100,"wires":[["69685709.29dd78","2acf8a6d.bf9446"]]},{"id":"5368faab.0bf224","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":670,"y":1100,"wires":[["2acf8a6d.bf9446","aa6b7723.bd6ce8"]]},{"id":"69685709.29dd78","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost +`/pictureByHashtags`;\nmsg.method = \"POST\";\nmsg.payload = {\n    hashtags: msg.hashtags,\n    limit: 1,\n    user_id: msg.chat_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":520,"y":1100,"wires":[["5368faab.0bf224","2acf8a6d.bf9446"]]},{"id":"b094db15.784278","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":1100,"wires":[["6beefa67.fb0ee4"]]},{"id":"52260118.639db","type":"function","z":"902edb22.d683d8","name":"buyerViewPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerViewPicture\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t   liked: !!msg.picture.likes.length\n\t }\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1130,"y":1100,"wires":[["8691f2c8.c0211"]]},{"id":"8691f2c8.c0211","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1310,"y":1100,"wires":[["b62bb6c5.823308"]]},{"id":"b62bb6c5.823308","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: 0,\n        searchType: msg.byHashtagSearchType,\n        category_id: msg.category_id,\n        searchHashtags: msg.hashtags,\n    },\n};\nmsg.settings.searchHashtags = msg.hashtags;\nmsg.settings.searchType = msg.byHashtagSearchType;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1460,"y":1100,"wires":[["aa910334.ac2d9"]]},{"id":"aa910334.ac2d9","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1610,"y":1100,"wires":[["5c61b5bb.3907fc"]]},{"id":"2acf8a6d.bf9446","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":690,"y":1160,"wires":[]},{"id":"64ad49ca.825418","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost + \"/history\";\nmsg.method = \"POST\";\nmsg.payload = {\n    user_id: msg.chat_id,\n    search_type: msg.settings.searchType,\n    picture_id: msg.picture.id,\n};\nif(msg.settings.searchType == msg.byHashtagSearchType){\n    msg.payload.hashtags_history_view_ids = msg.hashtags_history_view_ids;\n}\nif(msg.settings.searchType == msg.byArtistSearchType){\n    msg.payload.nickname = msg.artist.nickname;\n}\nif(msg.settings.searchType == msg.byCategorySearchType){\n    msg.payload.category_id = msg.settings.category_id;\n    \n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2800,"y":760,"wires":[["91a09fbf.f355c","3c027192.e3b80e"]]},{"id":"91a09fbf.f355c","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2950,"y":760,"wires":[["8f9cec44.ed0c7","7ed811c0.eab32"]]},{"id":"3c027192.e3b80e","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2810,"y":720,"wires":[]},{"id":"8f9cec44.ed0c7","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2970,"y":720,"wires":[]},{"id":"ced01efa.cee56","type":"switch","z":"902edb22.d683d8","name":"","property":"settings.searchType","propertyType":"msg","rules":[{"t":"eq","v":"byHashtagSearchType","vt":"msg"},{"t":"eq","v":"byArtistSearchType","vt":"msg"},{"t":"eq","v":"byCategorySearchType","vt":"msg"},{"t":"eq","v":"bySizeSearchType","vt":"msg"},{"t":"eq","v":"byHistorySearchType","vt":"msg"},{"t":"else"}],"checkall":"true","repair":false,"outputs":6,"x":2050,"y":740,"wires":[["8e0b9a4b.ed9468"],["e71a954c.c57428"],["64ad49ca.825418"],["64ad49ca.825418"],["922880fe.14ead"],[]]},{"id":"e71a954c.c57428","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.settings.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2180,"y":700,"wires":[["4cac8acb.7f7eb4"]]},{"id":"4cac8acb.7f7eb4","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2350,"y":720,"wires":[["7dd43b7f.68c0d4"]]},{"id":"8e0b9a4b.ed9468","type":"function","z":"902edb22.d683d8","name":"","func":"msg.Hashtags = msg.picture.Hashtags;\nmsg.searchHashtags = msg.settings.searchHashtags;\nmsg.searchHashtags = msg.searchHashtags.map(hashtag => hashtag.toLowerCase());\nmsg.Hashtags = msg.Hashtags.map(hashtag => ({\n    id: hashtag.id,\n    tag: hashtag.tag.toLowerCase(),\n}));\n\n\nmsg.hashtags_history_view_ids = msg.Hashtags.filter(hashtag => {\n    return msg.searchHashtags.includes(hashtag.tag);\n}).map(hashtag => hashtag.id);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2380,"y":660,"wires":[["64ad49ca.825418"]]},{"id":"7dd43b7f.68c0d4","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2520,"y":720,"wires":[["64ad49ca.825418"]]},{"id":"c307b461.edd188","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost + \"/history\";\nmsg.method = \"POST\";\nmsg.payload = {\n    user_id: msg.chat_id,\n    search_type: msg.settings.searchType,\n    picture_id: msg.picture.id,\n};\nif(msg.settings.searchType == msg.byHashtagSearchType){\n    msg.payload.hashtags_history_view_ids = msg.hashtags_history_view_ids;\n}\nif(msg.settings.searchType == msg.byArtistSearchType){\n    msg.payload.nickname = msg.artist.nickname;\n}\nif(msg.settings.searchType == msg.byCategorySearchType){\n    msg.payload.category_id = msg.settings.category_id;\n    \n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2320,"y":580,"wires":[["1e8917f.7499de8","2c90a1dd.d33abe"]]},{"id":"1e8917f.7499de8","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2470,"y":580,"wires":[["cbd1d3cd.8819e"]]},{"id":"2c90a1dd.d33abe","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2330,"y":540,"wires":[]},{"id":"cbd1d3cd.8819e","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2490,"y":540,"wires":[]},{"id":"576ccb61.0428f4","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.settings.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1820,"y":580,"wires":[["b344930.070b47"]]},{"id":"b344930.070b47","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1990,"y":580,"wires":[["5165681b.2a2388"]]},{"id":"5165681b.2a2388","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2160,"y":580,"wires":[["c307b461.edd188"]]},{"id":"309178d6.505838","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost + \"/history\";\nmsg.method = \"POST\";\nmsg.payload = {\n    user_id: msg.chat_id,\n    search_type: msg.settings.searchType,\n    picture_id: msg.picture.id,\n};\nif(msg.settings.searchType == msg.byHashtagSearchType){\n    msg.payload.hashtags_history_view_ids = msg.hashtags_history_view_ids;\n}\nif(msg.settings.searchType == msg.byArtistSearchType){\n    msg.payload.nickname = msg.artist.nickname;\n}\nif(msg.settings.searchType == msg.byCategorySearchType){\n    msg.payload.category_id = msg.settings.category_id;\n    \n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1540,"y":500,"wires":[["9a6071f7.8e432","91692877.9f7ee8"]]},{"id":"9a6071f7.8e432","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1690,"y":500,"wires":[["632ad4d0.e3e70c"]]},{"id":"91692877.9f7ee8","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1550,"y":460,"wires":[]},{"id":"632ad4d0.e3e70c","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1710,"y":460,"wires":[]},{"id":"c20a8460.cff968","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost + \"/history\";\nmsg.method = \"POST\";\nmsg.payload = {\n    user_id: msg.chat_id,\n    search_type: msg.settings.searchType,\n    picture_id: msg.picture.id,\n};\nif(msg.settings.searchType == msg.byHashtagSearchType){\n    msg.payload.hashtags_history_view_ids = msg.hashtags_history_view_ids;\n}\nif(msg.settings.searchType == msg.byArtistSearchType){\n    msg.payload.nickname = msg.artist.nickname;\n}\nif(msg.settings.searchType == msg.byCategorySearchType){\n    msg.payload.category_id = msg.settings.category_id;\n    \n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1780,"y":1060,"wires":[["62d6dd88.8ae444","bd36aa3c.1810a8"]]},{"id":"62d6dd88.8ae444","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1930,"y":1060,"wires":[["3c1debc8.bfc954","a4c0ecce.23f19"]]},{"id":"bd36aa3c.1810a8","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1650,"y":1020,"wires":[]},{"id":"3c1debc8.bfc954","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1810,"y":1020,"wires":[]},{"id":"5c61b5bb.3907fc","type":"function","z":"902edb22.d683d8","name":"","func":"msg.Hashtags = msg.picture.Hashtags;\nmsg.searchHashtags = msg.settings.searchHashtags;\nmsg.searchHashtags = msg.searchHashtags.map(hashtag => hashtag.toLowerCase());\nmsg.Hashtags = msg.Hashtags.map(hashtag => ({\n    id: hashtag.id,\n    tag: hashtag.tag.toLowerCase(),\n}));\n\n\nmsg.hashtags_history_view_ids = msg.Hashtags.filter(hashtag => {\n    return msg.searchHashtags.includes(hashtag.tag);\n}).map(hashtag => hashtag.id);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1760,"y":1100,"wires":[["25938a8c.ba3626"]]},{"id":"25938a8c.ba3626","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost + \"/history\";\nmsg.method = \"POST\";\nmsg.payload = {\n    user_id: msg.chat_id,\n    search_type: msg.settings.searchType,\n    picture_id: msg.picture.id,\n};\nif(msg.settings.searchType == msg.byHashtagSearchType){\n    msg.payload.hashtags_history_view_ids = msg.hashtags_history_view_ids;\n}\nif(msg.settings.searchType == msg.byArtistSearchType){\n    msg.payload.nickname = msg.artist.nickname;\n}\nif(msg.settings.searchType == msg.byCategorySearchType){\n    msg.payload.category_id = msg.settings.category_id;\n    \n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1900,"y":1100,"wires":[["2bd52d98.50bc62","15fd52d9.08a4dd"]]},{"id":"15fd52d9.08a4dd","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1910,"y":1140,"wires":[]},{"id":"f596478b.fb7988","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2070,"y":1140,"wires":[]},{"id":"2bd52d98.50bc62","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2050,"y":1100,"wires":[["f596478b.fb7988","dd21ca47.17a348"]]},{"id":"f0b5a25d.fc993","type":"switch","z":"902edb22.d683d8","name":"","property":"text","propertyType":"msg","rules":[{"t":"eq","v":"viewHistory","vt":"str"},{"t":"eq","v":"viewLiked","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":230,"y":1340,"wires":[["3262a6ed.81ac9a"],["6262b791.047238"]]},{"id":"d743e818.6ed0c8","type":"link in","z":"902edb22.d683d8","name":"","links":["937b6b69.86ea58"],"x":115,"y":1340,"wires":[["f0b5a25d.fc993"]]},{"id":"937b6b69.86ea58","type":"link out","z":"b7ea2501.259358","name":"","links":["d743e818.6ed0c8","5d43bcf3.5f73c4"],"x":535,"y":1720,"wires":[]},{"id":"3262a6ed.81ac9a","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost +`/findPicturesByHistory?user_id=${msg.chat_id}`;\nmsg.method = \"GET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":360,"y":1280,"wires":[["4a905e53.38d8e","51b37de2.040e44"]]},{"id":"51b37de2.040e44","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":390,"y":1260,"wires":[]},{"id":"4a905e53.38d8e","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":510,"y":1280,"wires":[["8f3258e7.48c338","9786e975.8e9e68"]]},{"id":"d9667d84.b140e","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture = msg.payload[0].Picture;\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":1300,"wires":[["93db5ac5.b51bd8"]]},{"id":"a16dc465.95ef28","type":"function","z":"902edb22.d683d8","name":"buyerViewPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerViewPicture\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t   liked: !!msg.picture.likes.length\n\t }\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":870,"y":1300,"wires":[["b9d9f383.eb12a"]]},{"id":"b9d9f383.eb12a","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1070,"y":1300,"wires":[["ae1bb96d.b0ea38"]]},{"id":"ae1bb96d.b0ea38","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: 0,\n        searchType: msg.byHistorySearchType,\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1220,"y":1300,"wires":[["152a1d89.903a72"]]},{"id":"152a1d89.903a72","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1370,"y":1300,"wires":[["fc4ed391.41f3c"]]},{"id":"a8901beb.511bd8","type":"switch","z":"902edb22.d683d8","name":"","property":"text","propertyType":"msg","rules":[{"t":"cont","v":"like","vt":"str"},{"t":"cont","v":"apply","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":210,"y":1460,"wires":[["a2ff2349.39919"],["99f851a9.57e2b"]]},{"id":"38ead90b.681856","type":"link in","z":"902edb22.d683d8","name":"","links":["3e7bb15c.c3fb5e"],"x":95,"y":1460,"wires":[["a8901beb.511bd8"]]},{"id":"3e7bb15c.c3fb5e","type":"link out","z":"b7ea2501.259358","name":"","links":["38ead90b.681856"],"x":515,"y":1860,"wires":[]},{"id":"a2ff2349.39919","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture_id = msg.text.split('_')[1];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":360,"y":1440,"wires":[["bdd45442.e33c18"]]},{"id":"bdd45442.e33c18","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost + \"/like\";\nmsg.method = \"POST\";\nmsg.payload = {\n    user_id: msg.chat_id,\n    picture_id: msg.picture_id,\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":1440,"wires":[["273fde71.020da2"]]},{"id":"273fde71.020da2","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":650,"y":1440,"wires":[["db02485c.5212b8"]]},{"id":"702301d6.216a3","type":"function","z":"902edb22.d683d8","name":"buyerEditViewPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    message_id: msg.originalMessage.callback_query.message.message_id,\n    templateName: \"buyerEditViewPicture\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t   liked: !!msg.picture.likes.length\n\t }\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1480,"y":1440,"wires":[["8537b9a4.d16368","8b159962.7bf6e8"]]},{"id":"8537b9a4.d16368","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1670,"y":1440,"wires":[["e12c92b1.f4faf"]]},{"id":"db02485c.5212b8","type":"function","z":"902edb22.d683d8","name":"","func":"msg.like = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":800,"y":1440,"wires":[["b1fee5df.e47728"]]},{"id":"b1fee5df.e47728","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost +`/picture?id=${msg.picture_id}&user_id=${msg.chat_id}`;\nmsg.method = \"GET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":960,"y":1440,"wires":[["a8558185.a9dd2"]]},{"id":"a8558185.a9dd2","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1110,"y":1440,"wires":[["f8461a03.629b28"]]},{"id":"d06e5393.ba081","type":"function","z":"902edb22.d683d8","name":"buyerEditViewPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    message_id: msg.originalMessage.callback_query.message.message_id,\n    templateName: \"buyerEditViewPicture\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t   liked: !!msg.picture.likes.length\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1720,"y":740,"wires":[["891a09e2.bab5a8"]]},{"id":"891a09e2.bab5a8","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1910,"y":740,"wires":[["ced01efa.cee56"]]},{"id":"f0cf9153.86ffe","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: msg.picture_index,\n    }\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1400,"y":3040,"wires":[["96688fdf.e3eee"]]},{"id":"96688fdf.e3eee","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1550,"y":3040,"wires":[["274ece84.ac7822","bfebcad7.172f28"]]},{"id":"274ece84.ac7822","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1530,"y":3000,"wires":[]},{"id":"1446f94b.ad7a17","type":"function","z":"b6f7a7df.51a0e8","name":"artEditDeletePictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    message_id: msg.originalMessage.callback_query.message.message_id,\n    templateName: \"artEditDeletePictures\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   nickname: msg.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1960,"y":2940,"wires":[["7b8f2091.928e9"]]},{"id":"7b8f2091.928e9","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2150,"y":2940,"wires":[[]]},{"id":"6782ec11.2e8174","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"settings.action","propertyType":"msg","rules":[{"t":"eq","v":"delete_picture_action","vt":"msg"},{"t":"eq","v":"edit_picture_action","vt":"msg"},{"t":"eq","v":"advertise_picture_action","vt":"msg"}],"checkall":"true","repair":false,"outputs":3,"x":1770,"y":3000,"wires":[["1446f94b.ad7a17"],["355e3453.728f5c"],["f6f2a833.6d4f18"]]},{"id":"355e3453.728f5c","type":"function","z":"b6f7a7df.51a0e8","name":"artEditEditPictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    message_id: msg.originalMessage.callback_query.message.message_id,\n    templateName: \"artEditEditPictures\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   nickname: msg.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1950,"y":2980,"wires":[["da1ecb11.aa5598"]]},{"id":"da1ecb11.aa5598","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2150,"y":2980,"wires":[[]]},{"id":"f6f2a833.6d4f18","type":"function","z":"b6f7a7df.51a0e8","name":"artEditAdvertisingAllPictures","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    message_id: msg.originalMessage.callback_query.message.message_id,\n    templateName: \"artEditAdvertisingAllPictures\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   nickname: msg.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1960,"y":3020,"wires":[["5ca320e1.4207f"]]},{"id":"5ca320e1.4207f","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2150,"y":3020,"wires":[["4948dd5a.965bc4"]]},{"id":"6262b791.047238","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost +`/findPicturesByLiked?user_id=${msg.chat_id}`;\nmsg.method = \"GET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":400,"y":1360,"wires":[["9fe166a1.1b4a58","adde2326.91783"]]},{"id":"adde2326.91783","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":390,"y":1400,"wires":[]},{"id":"9fe166a1.1b4a58","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":550,"y":1360,"wires":[["25e36ca6.038d24"]]},{"id":"bba92113.71523","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":1360,"wires":[["10a52442.b93b5c"]]},{"id":"e430b781.0d93b8","type":"function","z":"902edb22.d683d8","name":"buyerViewPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerViewPicture\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   //nickname: msg.nickname,\n\t   nickname: msg.artist.nickname,\n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n\t   liked: !!msg.picture.likes.length\n\t }\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":1360,"wires":[["9f086981.849958"]]},{"id":"9f086981.849958","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1070,"y":1360,"wires":[["1d6a32cd.8838ad"]]},{"id":"1d6a32cd.8838ad","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    settings: {\n        picture_index: 0,\n        searchType: msg.byLikedSearchType,\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1220,"y":1360,"wires":[["2183c348.a22eac"]]},{"id":"2183c348.a22eac","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1370,"y":1360,"wires":[["4bdafdc3.f5ee74"]]},{"id":"2825222a.71768e","type":"function","z":"902edb22.d683d8","name":"applicationWasSent","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"applicationWasSent\",\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":1480,"wires":[["65a5b8d8.a11518"]]},{"id":"65a5b8d8.a11518","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":710,"y":1480,"wires":[["2515b3b3.6b33dc"]]},{"id":"99f851a9.57e2b","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture_id = msg.text.split('_')[1];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":360,"y":1480,"wires":[["2825222a.71768e"]]},{"id":"2515b3b3.6b33dc","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.imageApiHost +`/picture?id=${msg.picture_id}&user_id=${msg.chat_id}`;\nmsg.method = \"GET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":1480,"wires":[["af25da27.e1a6a8"]]},{"id":"af25da27.e1a6a8","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1010,"y":1480,"wires":[["d2277b61.621b08"]]},{"id":"e48ebcdd.98923","type":"function","z":"902edb22.d683d8","name":"notificationToAstistAboutApplying","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\n//msg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.picture.artist_id,\n    lang: msg.artist.lang,\n    templateName: \"notificationToAstistAboutApplying\",\n    templateVars: {\n        user_login: msg.originalMessage.callback_query.from.username,\n        phone: msg.phone,\n        picture_name: msg.picture.name,\n\t }\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1260,"y":1480,"wires":[["dc562730.1e7248"]]},{"id":"dc562730.1e7248","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1490,"y":1480,"wires":[["7a7060d7.0c8d4"]]},{"id":"85e29d7a.ee53","type":"switch","z":"ee99e200.220c5","name":"","property":"payload.pre_checkout_query","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":380,"y":120,"wires":[["7bf49045.04194"],["fd13988.5e80068"]]},{"id":"7bf49045.04194","type":"function","z":"ee99e200.220c5","name":"","func":"msg.url = `https://api.telegram.org/bot1730284858:AAHdzHY6NkNnPRuHMtl6PF1evR8BpcejtyY/answerPreCheckoutQuery`\nmsg.payload = {\n    \"pre_checkout_query_id\": msg.payload.pre_checkout_query.id,\n    \"ok\": \"true\",\n    \"error_message\": \"\"\n};\nmsg.method = 'POST';\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":560,"y":100,"wires":[["950b36d6.a57eb8"]]},{"id":"950b36d6.a57eb8","type":"http request","z":"ee99e200.220c5","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":730,"y":100,"wires":[["8c446f3.eeb779"]]},{"id":"6e1a4702.5d1348","type":"comment","z":"b7ea2501.259358","name":"сюди оплата зайшла","info":"","x":2120,"y":880,"wires":[]},{"id":"2d3f47ad.2f5888","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":900,"y":3920,"wires":[]},{"id":"ba6199f2.cf0fe8","type":"mqtt out","z":"ee99e200.220c5","name":"","topic":"","qos":"0","retain":"false","broker":"4ebb61a7.26508","x":390,"y":420,"wires":[]},{"id":"902e620f.51c14","type":"inject","z":"ee99e200.220c5","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"advertising","payload":"","payloadType":"date","x":160,"y":420,"wires":[["ba6199f2.cf0fe8"]]},{"id":"c77524d.65020d8","type":"link in","z":"b6f7a7df.51a0e8","name":"","links":["9461190b.bf0578","e4597c47.4f181"],"x":2935,"y":360,"wires":[["2985350d.a9d3ca"]]},{"id":"9948040a.89acb8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture_id = msg.text.split('_')[1];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3280,"y":360,"wires":[["e25c62c8.42bec"]]},{"id":"31de654a.9114fa","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost +`/findUsers`;\nmsg.method = \"POST\";\nmsg.payload = {\n    type: msg.buyerType\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4160,"y":360,"wires":[["741fb60.a85ab4c","6217d004.99012"]]},{"id":"741fb60.a85ab4c","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":4330,"y":360,"wires":[["a5d77775.598318","d61adbc1.34a258"]]},{"id":"d61adbc1.34a258","type":"split","z":"b6f7a7df.51a0e8","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":4470,"y":360,"wires":[["76691307.222a6c","2af46247.550a2e"]]},{"id":"dfd1421d.3442f","type":"mqtt out","z":"b6f7a7df.51a0e8","name":"","topic":"","qos":"0","retain":"false","broker":"4ebb61a7.26508","x":4790,"y":360,"wires":[]},{"id":"2af46247.550a2e","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.topic = \"advertising\";\nmsg.payload = {\n    chat_id: msg.payload.chat_id,\n    lang: msg.payload.lang,\n    \n    //nickname: msg.payload.nickname,\n    nickname: msg.artist.nickname,\n    \n    picture: msg.picture,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4640,"y":360,"wires":[["dfd1421d.3442f","1f409d11.14a663"]]},{"id":"76691307.222a6c","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":4750,"y":220,"wires":[]},{"id":"d995cf0a.378a6","type":"inject","z":"ee99e200.220c5","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":120,"y":240,"wires":[["c63d1ad3.bce508"]]},{"id":"c63d1ad3.bce508","type":"function","z":"ee99e200.220c5","name":"","func":"msg.payload = {\n    \"update_id\": 642369448,\n    \"message\": {\n        \"message_id\": 5492,\n        \"from\": {\n            \"id\": 467013671,\n            \"is_bot\": false,\n            \"first_name\": \"Ірина\",\n            \"last_name\": \"Макар\",\n            \"username\": \"makarova_16\",\n            \"language_code\": \"uk\"\n        },\n        \"chat\": {\n            \"id\": 467013671,\n            \"first_name\": \"Ірина\",\n            \"last_name\": \"Макар\",\n            \"username\": \"makarova_16\",\n            \"type\": \"private\"\n        },\n        \"date\": 1616356947,\n        \"successful_payment\": {\n            \"currency\": \"UAH\",\n            \"total_amount\": 100,\n            \"invoice_payload\": \"advertising_52\",\n            \"telegram_payment_charge_id\": \"_\",\n            \"provider_payment_charge_id\": \"1597733822\"\n        }\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":280,"y":240,"wires":[["85e29d7a.ee53"]]},{"id":"a5d77775.598318","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":4430,"y":200,"wires":[]},{"id":"6217d004.99012","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":3930,"y":180,"wires":[]},{"id":"e4597c47.4f181","type":"link out","z":"b7ea2501.259358","name":"","links":["c77524d.65020d8"],"x":395,"y":520,"wires":[]},{"id":"e25c62c8.42bec","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost +`/picture?id=${msg.picture_id}&user_id=${msg.chat_id}`;\nmsg.method = \"GET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3420,"y":360,"wires":[["fcdb89f5.c04cf8"]]},{"id":"fcdb89f5.c04cf8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":3570,"y":360,"wires":[["63f35cfb.857e14"]]},{"id":"63f35cfb.857e14","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.picture = msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3720,"y":360,"wires":[["48ef2c9e.7f4ed4"]]},{"id":"104ebd1f.bc0073","type":"mqtt in","z":"902edb22.d683d8","name":"","topic":"advertising","qos":"2","datatype":"auto","broker":"4ebb61a7.26508","x":160,"y":1800,"wires":[["f5239f0d.476ac"]]},{"id":"f5239f0d.476ac","type":"function","z":"902edb22.d683d8","name":"","func":"msg.payload = JSON.parse(msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":320,"y":1800,"wires":[["56560f7.1921bf","32d244d4.6ba2cc"]]},{"id":"2d10bb82.533824","type":"function","z":"902edb22.d683d8","name":"","func":"//msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.messageApiHost = \"https://messageapi-pdp-art-bot.herokuapp.com\";\nmsg.url = msg.messageApiHost+\"/sendMessage\";\nmsg.method = \"POST\";\n\nmsg.picture = msg.payload.picture;\n\nmsg.payload = {\n    chat_id: msg.payload.chat_id,\n    lang: msg.payload.lang,\n    templateName: \"advertisingPictureMessage\",\n    templateVars: {\n\t   name: msg.picture.name,\n\t   description: msg.picture.description,\n\t   height:msg.picture.height,\n\t   width:msg.picture.width,\n\t   \n\t   nickname: msg.payload.nickname,\n\t   \n\t   hashtags: msg.picture.hashtags ? \"#\"+msg.picture.hashtags : '',\n\t   photoUrl:msg.picture.url,\n\t   picture_id: msg.picture.id,\n    }\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":600,"y":1800,"wires":[["9c71f66.6add908"]]},{"id":"9c71f66.6add908","type":"http request","z":"902edb22.d683d8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":770,"y":1800,"wires":[[]]},{"id":"28894019.9563e","type":"inject","z":"ee99e200.220c5","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":120,"y":560,"wires":[["abbeb75e.2a9a48"]]},{"id":"b61b372e.f4d6b8","type":"http request","z":"ee99e200.220c5","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":610,"y":560,"wires":[["a1438480.0234c8","408b1a0a.7a6cd4"]]},{"id":"a1438480.0234c8","type":"function","z":"ee99e200.220c5","name":"","func":"msg.statistic = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":760,"y":560,"wires":[["f32439c9.05ddf8","dc61606e.cd0fb"]]},{"id":"f32439c9.05ddf8","type":"debug","z":"ee99e200.220c5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":750,"y":520,"wires":[]},{"id":"188c0a8.dd1f6f6","type":"function","z":"ee99e200.220c5","name":"","func":"msg.url = msg.imageApiHost +`/getTotalStatisticByArtist?artist_id=${msg.chat_id}`;\nmsg.method = \"GET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":420,"y":560,"wires":[["45de836f.9e281c","b61b372e.f4d6b8"]]},{"id":"45de836f.9e281c","type":"debug","z":"ee99e200.220c5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":410,"y":520,"wires":[]},{"id":"408b1a0a.7a6cd4","type":"debug","z":"ee99e200.220c5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":590,"y":520,"wires":[]},{"id":"abbeb75e.2a9a48","type":"function","z":"ee99e200.220c5","name":"","func":"msg.chat_id = 467013671;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":280,"y":560,"wires":[["188c0a8.dd1f6f6"]]},{"id":"dc61606e.cd0fb","type":"function","z":"ee99e200.220c5","name":"showStatisticByArtist","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: 'uk',\n    templateName: \"showStatisticByArtist\",\n    templateVars: msg.statistic\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":560,"wires":[["738dae09.30f81"]]},{"id":"738dae09.30f81","type":"http request","z":"ee99e200.220c5","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1310,"y":560,"wires":[[]]},{"id":"2985350d.a9d3ca","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"text","propertyType":"msg","rules":[{"t":"cont","v":"advertising_","vt":"str"},{"t":"cont","v":"statisic_","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":3060,"y":360,"wires":[["9948040a.89acb8"],["d48f46d4.3f1768"]]},{"id":"77f3bc5c.7e20e4","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":3510,"y":460,"wires":[["fabaab49.9d5fc8","c1c49d28.16753"]]},{"id":"fabaab49.9d5fc8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.statistic = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3660,"y":460,"wires":[["443c6193.a623d","63267c49.273304"]]},{"id":"443c6193.a623d","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":3650,"y":420,"wires":[]},{"id":"d48f46d4.3f1768","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost +`/getTotalStatisticByArtist?artist_id=${msg.chat_id}`;\nmsg.method = \"GET\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3320,"y":460,"wires":[["86a7ee2c.a25a1","77f3bc5c.7e20e4"]]},{"id":"86a7ee2c.a25a1","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":3310,"y":420,"wires":[]},{"id":"c1c49d28.16753","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":3490,"y":420,"wires":[]},{"id":"63267c49.273304","type":"function","z":"b6f7a7df.51a0e8","name":"showStatisticByArtist","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"showStatisticByArtist\",\n    templateVars: msg.statistic\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3940,"y":460,"wires":[["a9208e17.db5b9"]]},{"id":"a9208e17.db5b9","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":4210,"y":460,"wires":[[]]},{"id":"383d49e5.3f7fd6","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"use","ret":"obj","paytoqs":"query","url":"","tls":"","persist":false,"proxy":"","authType":"","x":830,"y":940,"wires":[["b2a77674.009468","43f0e7d8.9e4f38"]]},{"id":"903cda02.b26e08","type":"debug","z":"b6f7a7df.51a0e8","name":"21","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":750,"y":1060,"wires":[]},{"id":"43f0e7d8.9e4f38","type":"debug","z":"b6f7a7df.51a0e8","name":"21","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":950,"y":1060,"wires":[]},{"id":"63f07561.14520c","type":"comment","z":"b7ea2501.259358","name":"","info":"","x":600,"y":1880,"wires":[]},{"id":"6e67269d.60e138","type":"function","z":"b7ea2501.259358","name":"contactWithAdministratorStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"contactWithAdministratorStiker\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":670,"y":1800,"wires":[["dae07faf.13748"]]},{"id":"dae07faf.13748","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":890,"y":1800,"wires":[["563093c6.18f06c"]]},{"id":"563093c6.18f06c","type":"function","z":"b7ea2501.259358","name":"contactWithAdministrator","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"contactWithAdministrator\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1090,"y":1800,"wires":[["70afc7f9.8e2c08"]]},{"id":"70afc7f9.8e2c08","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1290,"y":1800,"wires":[["9b43597c.1cf8c8"]]},{"id":"9b43597c.1cf8c8","type":"function","z":"b7ea2501.259358","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"contactWithAdministrator\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1480,"y":1800,"wires":[["54562780.214228"]]},{"id":"54562780.214228","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1650,"y":1800,"wires":[[]]},{"id":"34fe999.b290166","type":"link out","z":"902edb22.d683d8","name":"to contact with administrator","links":["78985f88.4f951"],"x":480,"y":1180,"wires":[],"l":true},{"id":"10ff7e90.bc3841","type":"switch","z":"7edc0cb0.8be9f4","name":"","property":"type","propertyType":"msg","rules":[{"t":"eq","v":"buyer","vt":"str"},{"t":"eq","v":"artist","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1530,"y":480,"wires":[["bd7766ea.c49328"],["d7d77100.f37be"]]},{"id":"c236840.1bca78","type":"function","z":"7edc0cb0.8be9f4","name":"helloBuyer","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"helloBuyer\"\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1710,"y":540,"wires":[["c4156fb1.ced96"]]},{"id":"c4156fb1.ced96","type":"http request","z":"7edc0cb0.8be9f4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1870,"y":540,"wires":[[]]},{"id":"bd7766ea.c49328","type":"function","z":"7edc0cb0.8be9f4","name":"helloBuyerStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"helloBuyerStiker\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2060,"y":480,"wires":[["4ea59a70.40b9b4"]]},{"id":"4ea59a70.40b9b4","type":"http request","z":"7edc0cb0.8be9f4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2230,"y":480,"wires":[["64650330.0aa79c"]]},{"id":"64650330.0aa79c","type":"function","z":"7edc0cb0.8be9f4","name":"buyerMenu","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerMenu\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2390,"y":480,"wires":[["ce208bc9.f1ef58"]]},{"id":"ce208bc9.f1ef58","type":"http request","z":"7edc0cb0.8be9f4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2570,"y":480,"wires":[["6dac6ba9.a03204"]]},{"id":"c47d30dc.ad5d2","type":"function","z":"b7ea2501.259358","name":"","func":"nickname = msg.originalMessage.message.text;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":880,"wires":[["21727057.3e2a4"]]},{"id":"21727057.3e2a4","type":"debug","z":"b7ea2501.259358","name":"otherwise","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1140,"y":920,"wires":[]},{"id":"e42f1e02.5c28e","type":"debug","z":"b7ea2501.259358","name":"otherwise","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1320,"y":932.857177734375,"wires":[]},{"id":"1b3ebdbd.ac2432","type":"switch","z":"b7ea2501.259358","name":"","property":"nickname","propertyType":"msg","rules":[{"t":"nnull"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":90,"y":720,"wires":[["94201ad6.cf6da8","7ae454f7.9cf0ac","e6dd5da4.115aa"],["4d6a1d7.f5770e4"]]},{"id":"94201ad6.cf6da8","type":"function","z":"b7ea2501.259358","name":"helloArtist","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"helloArtistStiker\",\n    /*templateVars: {\n\t   name: msg.text\n\n\t}*/\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":160,"y":880,"wires":[["954fa435.0d3a38"]]},{"id":"954fa435.0d3a38","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":370,"y":880,"wires":[[]]},{"id":"7ae454f7.9cf0ac","type":"debug","z":"b7ea2501.259358","name":"1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":270,"y":740,"wires":[]},{"id":"4d6a1d7.f5770e4","type":"debug","z":"b7ea2501.259358","name":"2","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":250,"y":820,"wires":[]},{"id":"64919c35.e21a74","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":430,"y":640,"wires":[]},{"id":"53638cb.dd33e74","type":"debug","z":"e35da61b.7ab028","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":674.2857055664062,"y":111.42857360839844,"wires":[]},{"id":"d0703b63.deee58","type":"debug","z":"e35da61b.7ab028","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":950,"y":80,"wires":[]},{"id":"1e42fb96.eae254","type":"debug","z":"e35da61b.7ab028","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2070,"y":140,"wires":[]},{"id":"1d36ffa6.eb799","type":"debug","z":"e35da61b.7ab028","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":610,"y":260,"wires":[]},{"id":"e4eef3cf.50fd9","type":"debug","z":"e35da61b.7ab028","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1310,"y":260,"wires":[]},{"id":"1b68efc6.45d6","type":"debug","z":"e35da61b.7ab028","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":630,"y":20,"wires":[]},{"id":"8e7c64e4.6591e8","type":"debug","z":"e35da61b.7ab028","name":"to","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":510,"y":320,"wires":[]},{"id":"db49769c.e024a8","type":"debug","z":"e35da61b.7ab028","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":637.1428833007812,"y":534.2857055664062,"wires":[]},{"id":"2a99d300.2f3a7e","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1510,"y":1680,"wires":[]},{"id":"24255bac.c6e8f4","type":"debug","z":"e35da61b.7ab028","name":"1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":630,"y":580,"wires":[]},{"id":"4921488f.f26bc8","type":"function","z":"b7ea2501.259358","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    type: msg.buyerType,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":1460,"wires":[["7df0a022.6b1a8"]]},{"id":"7df0a022.6b1a8","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":875.7142333984375,"y":1450,"wires":[["eda21d5e.bdd5a"]]},{"id":"fc4ed391.41f3c","type":"function","z":"902edb22.d683d8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"viewHistory\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1540,"y":1300,"wires":[["65ec99c9.3f6898"]]},{"id":"65ec99c9.3f6898","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1710,"y":1300,"wires":[["18cdf998.02acb6"]]},{"id":"99be3a00.9ebae8","type":"comment","z":"902edb22.d683d8","name":"viewHistory","info":"","x":1560,"y":1260,"wires":[]},{"id":"48c6fd69.df7a54","type":"switch","z":"902edb22.d683d8","name":"","property":"state","propertyType":"msg","rules":[{"t":"eq","v":"viewHistory","vt":"str"},{"t":"eq","v":"viewLiked","vt":"str"},{"t":"eq","v":"buyerMenu","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":4,"x":450,"y":100,"wires":[["74676d60.d0abc4"],["74676d60.d0abc4"],["6353ebe0.36e7e4"],["6353ebe0.36e7e4"]]},{"id":"4bdafdc3.f5ee74","type":"function","z":"902edb22.d683d8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"viewLiked\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1540,"y":1360,"wires":[["abf5de43.cbab6"]]},{"id":"abf5de43.cbab6","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1710,"y":1360,"wires":[["78b5f331.bc8b1c"]]},{"id":"78b5f331.bc8b1c","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1890,"y":1360,"wires":[]},{"id":"18cdf998.02acb6","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1890,"y":1300,"wires":[]},{"id":"dc887f7a.04034","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":630,"y":180,"wires":[]},{"id":"74676d60.d0abc4","type":"function","z":"902edb22.d683d8","name":"buyerMenu","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    type: msg.buyerType,\n    lang: msg.lang,\n    templateName: \"buyerMenu\"\n};\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":650,"y":60,"wires":[["1bccfb67.2bad25"]]},{"id":"1bccfb67.2bad25","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":830,"y":60,"wires":[["d073ff7f.e0495"]]},{"id":"d073ff7f.e0495","type":"function","z":"902edb22.d683d8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"buyerMenu\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1000,"y":60,"wires":[["51f50135.42cc8"]]},{"id":"51f50135.42cc8","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1170,"y":60,"wires":[["6a2d87d7.ec4508"]]},{"id":"6a2d87d7.ec4508","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1350,"y":60,"wires":[]},{"id":"aa6b7723.bd6ce8","type":"switch","z":"902edb22.d683d8","name":"","property":"payload.length","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":1140,"wires":[["b094db15.784278"],["ce79941c.af9028"]]},{"id":"ce79941c.af9028","type":"function","z":"902edb22.d683d8","name":"buyerNOTSearchByHashtag","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerNOTSearchByHashtag\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":1140,"wires":[["713b0a2a.e27b44"]]},{"id":"713b0a2a.e27b44","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1230,"y":1140,"wires":[[]]},{"id":"5f01ddc1.2736b4","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsNOTPictureSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTPictureSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1460,"y":2180,"wires":[["3ea5c421.ff63bc"]]},{"id":"3ea5c421.ff63bc","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1670,"y":2180,"wires":[[]]},{"id":"7869c634.237448","type":"debug","z":"b6f7a7df.51a0e8","name":"121","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":910,"y":2060,"wires":[]},{"id":"222aa8ca.aae898","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"if(msg.originalMessage.message.photo) {\n    msg.QQ = true;\n} \nelse msg.QQ = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":2120,"wires":[["6ae84ba.d4e04b4"]]},{"id":"6ae84ba.d4e04b4","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"QQ","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":870,"y":2120,"wires":[["971d6799.da2188"],["3021475d.295f38"]]},{"id":"666e2c86.6db734","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.size = msg.text.split(\"-\");\n\nif (msg.size[0]!= 0 && msg.size[1]!= 0 && msg.size[1]!= null && msg.size[2]== null) {\n    \n    msg.size = true\n} else msg.size = false\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":2280,"wires":[["df19997f.d2e8d8","a5c3782d.e8fed8"]]},{"id":"df19997f.d2e8d8","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"size","propertyType":"msg","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1150,"y":2280,"wires":[["b562de77.b834e","9d8e8049.d13a1"],["9937d440.e74288","1310a857.a787b8"]]},{"id":"9937d440.e74288","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsNOTSizeSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTSizeSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1550,"y":2320,"wires":[["ca4c2b18.fa3df8"]]},{"id":"ca4c2b18.fa3df8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1770,"y":2320,"wires":[[]]},{"id":"7ed79e5b.d9b97","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"state","propertyType":"msg","rules":[{"t":"eq","v":"addPictureSize","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":340,"y":2360,"wires":[[]]},{"id":"2f7bd538.90f86a","type":"function","z":"e35da61b.7ab028","name":"artActionsNOTPictureSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"errorNumber\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1060,"y":340,"wires":[["a1af87e0.661918"]]},{"id":"a1af87e0.661918","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1270,"y":340,"wires":[[]]},{"id":"b562de77.b834e","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"text","propertyType":"msg","rules":[{"t":"regex","v":"(?=.*[a-zA-Zа-яА-Я])(?=.*)[a-zA-Zа-яА-Я]+","vt":"str","case":false},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1310,"y":2260,"wires":[["9937d440.e74288","18a4872d.5d2c69"],["74f62f9b.19a03","d1a137b4.5898e8"]]},{"id":"574b5087.b4bb6","type":"function","z":"e35da61b.7ab028","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"startNumberMessage\",\n    settings: {\n        restart: true,\n    }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":180,"wires":[["67c6e10c.76771"]]},{"id":"67c6e10c.76771","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1110,"y":180,"wires":[[]]},{"id":"67a45cae.ec4694","type":"switch","z":"e35da61b.7ab028","name":"","property":"state","propertyType":"msg","rules":[{"t":"eq","v":"startNumberMessage","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":570,"y":220,"wires":[["f47ee58f.3c62a8"],["cb222ca7.a5b4d","9ee45bf8.e12518"]]},{"id":"68c17ed1.dec53","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"if(msg.originalMessage.message.text) {\n    msg.TT = true;\n} \nelse msg.TT = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":2240,"wires":[["ef9d89c2.01ba98"]]},{"id":"ef9d89c2.01ba98","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"TT","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":870,"y":2240,"wires":[["e54631ad.9779f"],["5da48bb6.92d9d4"]]},{"id":"5da48bb6.92d9d4","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsNOTDescriotionSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTDescriotionSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1070,"y":2240,"wires":[["dd6dc6de.cbcd78"]]},{"id":"dd6dc6de.cbcd78","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1290,"y":2240,"wires":[[]]},{"id":"293f5954.c36976","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"if(msg.originalMessage.message.text) {\n    msg.SS = true;\n} \nelse msg.SS = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":2300,"wires":[["9c406cd0.88d28"]]},{"id":"9c406cd0.88d28","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"SS","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":870,"y":2300,"wires":[["666e2c86.6db734","1cfac09a.bbd95f"],["9937d440.e74288","affe801f.aea9"]]},{"id":"12957950.c19727","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"if(msg.originalMessage.message.text) {\n    msg.HH = true;\n} \nelse msg.HH = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":2500,"wires":[["c8065e8d.de129"]]},{"id":"c8065e8d.de129","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"HH","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":870,"y":2500,"wires":[["880f4a7f.dc3c78"],["400d3535.fcf1dc"]]},{"id":"400d3535.fcf1dc","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsNOTDescriotionSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTDescriotionSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1090,"y":2540,"wires":[["5448d1b9.33b35"]]},{"id":"5448d1b9.33b35","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1310,"y":2540,"wires":[[]]},{"id":"d59e1b83.e24c58","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"if(msg.originalMessage.message.text) {\n    msg.DD = true;\n} \nelse msg.DD = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":580,"y":2660,"wires":[["7f08fbfe.3dd934"]]},{"id":"7f08fbfe.3dd934","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"DD","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":730,"y":2660,"wires":[["dd0397f.87c7968"],["c2d324d0.c850c8"]]},{"id":"c2d324d0.c850c8","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsNOTDescriotionSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTDescriotionSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":950,"y":2660,"wires":[["71d7b998.a69918"]]},{"id":"71d7b998.a69918","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1170,"y":2660,"wires":[[]]},{"id":"587c6fd7.98d99","type":"switch","z":"b7ea2501.259358","name":"","property":"nickname","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"nnull"},{"t":"else"}],"checkall":"false","repair":false,"outputs":3,"x":1130,"y":500,"wires":[["bc3e2584.805b18"],["58eed663.df5018","21babddc.15d992"],["bc3e2584.805b18","e0633ebc.c171a"]]},{"id":"84b73f5a.b5446","type":"function","z":"b7ea2501.259358","name":"helloArtistStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"helloArtistStiker\",\n    type: msg.artistType,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1800,"y":520,"wires":[["29b8fdeb.bdcd42"]]},{"id":"29b8fdeb.bdcd42","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1990,"y":520,"wires":[["1e167ac1.a19af5"]]},{"id":"b88efa2b.4a4d28","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1610,"y":520,"wires":[["e6914266.fd0d5"]]},{"id":"8fafa03d.a42ef","type":"function","z":"b7ea2501.259358","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    type: msg.artistType,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1440,"y":520,"wires":[["b88efa2b.4a4d28"]]},{"id":"e6dd5da4.115aa","type":"link out","z":"b7ea2501.259358","name":"","links":["2415268a.14b25a"],"x":225,"y":960,"wires":[]},{"id":"58eed663.df5018","type":"debug","z":"b7ea2501.259358","name":"OOOOOOLLLLIIIIIIIAAAAA","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1340,"y":600,"wires":[]},{"id":"e0633ebc.c171a","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1470,"y":640,"wires":[]},{"id":"afcc8e2e.d2a88","type":"function","z":"e35da61b.7ab028","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    // nickname: msg.text,\n    //nickname: \"0\"\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2400,"y":280,"wires":[["a7180dd1.c81d6"]]},{"id":"a7180dd1.c81d6","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2570,"y":280,"wires":[["9eb3092d.306a18","25a5c874.7a0948"]]},{"id":"9eb3092d.306a18","type":"debug","z":"e35da61b.7ab028","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2710,"y":220,"wires":[]},{"id":"4b53eee6.a699e","type":"switch","z":"b7ea2501.259358","name":"","property":"nickname","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1490,"y":480,"wires":[[],[]]},{"id":"e6914266.fd0d5","type":"function","z":"b7ea2501.259358","name":"helloArtist","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"helloArtist\"\n    \n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1740,"y":580,"wires":[["cb7bd43.ddd6728"]]},{"id":"cb7bd43.ddd6728","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1890,"y":580,"wires":[["84b73f5a.b5446"]]},{"id":"823338d0.a93288","type":"debug","z":"b7ea2501.259358","name":"Dialogflow","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":870,"y":1340,"wires":[]},{"id":"80ae6c1c.d4af6","type":"function","z":"b7ea2501.259358","name":"errorTextStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"errorTextStiker\"\n};\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":1240,"wires":[["49d02c97.512234"]]},{"id":"49d02c97.512234","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1190,"y":1240,"wires":[["afbff88.00bb408"]]},{"id":"afbff88.00bb408","type":"function","z":"b7ea2501.259358","name":"errorText","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"errorText\"\n};\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1340,"y":1240,"wires":[["688cce57.e5ecd"]]},{"id":"688cce57.e5ecd","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1530,"y":1240,"wires":[[]]},{"id":"7bbd4234.18c83c","type":"function","z":"7edc0cb0.8be9f4","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"artistMenu\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2260,"y":420,"wires":[["966dab0b.21f028"]]},{"id":"966dab0b.21f028","type":"http request","z":"7edc0cb0.8be9f4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2430,"y":420,"wires":[["e0377a13.36af08"]]},{"id":"454dbf1a.c1f62","type":"function","z":"e35da61b.7ab028","name":"changeTypeToArtistStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artistSettings\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":470,"y":420,"wires":[["828f55d4.a959a8"]]},{"id":"828f55d4.a959a8","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":670,"y":420,"wires":[[]]},{"id":"5da1f535.69567c","type":"link out","z":"e35da61b.7ab028","name":"","links":["7d8aa145.cb51a"],"x":415,"y":540,"wires":[]},{"id":"7d8aa145.cb51a","type":"link in","z":"b7ea2501.259358","name":"","links":["5da1f535.69567c"],"x":2235,"y":460,"wires":[["33c1b04e.0336e"]]},{"id":"6f5d1c9f.7d54a4","type":"debug","z":"e35da61b.7ab028","name":"uuuu","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":450,"y":500,"wires":[]},{"id":"9bc60b12.87b968","type":"debug","z":"b6f7a7df.51a0e8","name":"126","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1350,"y":4720,"wires":[]},{"id":"e97ef23b.e1c0c","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":580,"wires":[["bef02d98.d2eb7"]]},{"id":"bef02d98.d2eb7","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":830,"y":580,"wires":[["ddd21114.dbf8a"]]},{"id":"ddd21114.dbf8a","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":580,"wires":[["578566e.ed7c798","e8350d16.45cb6"]]},{"id":"e8350d16.45cb6","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1050,"y":540,"wires":[]},{"id":"539c30cd.a2cfd","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1220,"y":860,"wires":[["f601d69b.5b6b28"]]},{"id":"f601d69b.5b6b28","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1370,"y":860,"wires":[["42ea27cf.ac3ca8"]]},{"id":"42ea27cf.ac3ca8","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1540,"y":860,"wires":[["d06e5393.ba081","bfa08616.d6b9b8"]]},{"id":"bfa08616.d6b9b8","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1730,"y":860,"wires":[]},{"id":"4ca8e564.77cb7c","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":260,"y":1940,"wires":[["111ce9c5.18c956"]]},{"id":"111ce9c5.18c956","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":410,"y":1940,"wires":[["41eae839.7ba998"]]},{"id":"41eae839.7ba998","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":580,"y":1940,"wires":[[]]},{"id":"546de809.e31548","type":"comment","z":"902edb22.d683d8","name":"чи тут треба оце?","info":"","x":350,"y":1980,"wires":[]},{"id":"ebf845fd.12a5e8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1340,"y":1940,"wires":[["19ef754d.db1f1b"]]},{"id":"19ef754d.db1f1b","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1490,"y":1940,"wires":[["ebc8c033.d34a5"]]},{"id":"ebc8c033.d34a5","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1660,"y":1940,"wires":[["b4a57069.7bf2b"]]},{"id":"725b8f01.862b1","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1862,"y":3674,"wires":[["3cc2c14b.66c28e"]]},{"id":"3cc2c14b.66c28e","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2022,"y":3674,"wires":[["1810f2ad.fb264d"]]},{"id":"1810f2ad.fb264d","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2182,"y":3674,"wires":[["4d7ef873.e644f8"]]},{"id":"5ac7c4fc.d1031c","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":900,"y":3860,"wires":[["73665a63.ef3434"]]},{"id":"73665a63.ef3434","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1060,"y":3860,"wires":[["d1777df1.dc77c"]]},{"id":"d1777df1.dc77c","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1220,"y":3860,"wires":[["28801b8.bec16e4"]]},{"id":"99ecc878.6190e8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1680,"y":1340,"wires":[["38293ae2.2d2cd6"]]},{"id":"38293ae2.2d2cd6","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1830,"y":1340,"wires":[["90f30e62.dc652"]]},{"id":"90f30e62.dc652","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2000,"y":1340,"wires":[["941bf354.72114"]]},{"id":"e13ff493.e9e8b8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":880,"y":3140,"wires":[["fed48f1e.31c5d"]]},{"id":"fed48f1e.31c5d","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1030,"y":3140,"wires":[["875fad31.e2533"]]},{"id":"875fad31.e2533","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1200,"y":3140,"wires":[["9a98b706.38f3f8"]]},{"id":"8cbb0dea.d36b3","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2398,"y":3152,"wires":[["353c4c7e.7c9694"]]},{"id":"353c4c7e.7c9694","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2558,"y":3152,"wires":[["db8fb8c4.35bb78"]]},{"id":"db8fb8c4.35bb78","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2718,"y":3152,"wires":[["4ffabcb.23cff44"]]},{"id":"2c82cd85.3619d2","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2300,"y":3280,"wires":[["14d1cfc8.a4b04"]]},{"id":"14d1cfc8.a4b04","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2460,"y":3280,"wires":[["b3d53317.5885c"]]},{"id":"b3d53317.5885c","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2620,"y":3280,"wires":[["2943c4d8.fcdb1c"]]},{"id":"d29a7aeb.6b10a8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2272,"y":3470,"wires":[["ebb11516.1127d8"]]},{"id":"ebb11516.1127d8","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2442,"y":3470,"wires":[["5d3fc7a.eb4a538"]]},{"id":"5d3fc7a.eb4a538","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2592,"y":3470,"wires":[["81427b9d.a3af08"]]},{"id":"287d158d.169a8a","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1924,"y":922,"wires":[["88d7134b.6b01b"]]},{"id":"88d7134b.6b01b","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2094,"y":922,"wires":[["2f8c3f1f.1d471"]]},{"id":"2f8c3f1f.1d471","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2244,"y":922,"wires":[["8bb219e2.720e78"]]},{"id":"15500165.01ad1f","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":3460,"wires":[["1b53b044.03d2f"]]},{"id":"1b53b044.03d2f","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":840,"y":3460,"wires":[["f88f65ed.211828"]]},{"id":"f88f65ed.211828","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1000,"y":3460,"wires":[["37e47bc6.bc5ef4"]]},{"id":"355d7c2.0f91984","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":450,"y":540,"wires":[]},{"id":"6910a526.2bc51c","type":"comment","z":"902edb22.d683d8","name":"category","info":"","x":1170,"y":620,"wires":[]},{"id":"f7b63d3b.ef3f8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":4560,"wires":[["ea355ce9.3ce1d"]]},{"id":"ea355ce9.3ce1d","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1130,"y":4560,"wires":[["c7a2bfb4.7bfe7"]]},{"id":"c7a2bfb4.7bfe7","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1300,"y":4560,"wires":[["d259be56.305d3"]]},{"id":"69841088.be464","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1220,"y":1580,"wires":[["ca4242c8.ff33b"]]},{"id":"ca4242c8.ff33b","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1370,"y":1580,"wires":[["81793045.fcee7"]]},{"id":"81793045.fcee7","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1540,"y":1580,"wires":[["702301d6.216a3"]]},{"id":"4bcdf402.a1786c","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":660,"y":460,"wires":[["f87e4c65.9d5c8"]]},{"id":"f87e4c65.9d5c8","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":810,"y":460,"wires":[["eaddc6b2.f17098"]]},{"id":"eaddc6b2.f17098","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":460,"wires":[["db1c05a.40855f8"]]},{"id":"c01de3e.38b922","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":940,"wires":[["f9e8d23e.6f8ae"]]},{"id":"f9e8d23e.6f8ae","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1146,"y":948,"wires":[["a1b57aa9.166348"]]},{"id":"a1b57aa9.166348","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1306,"y":948,"wires":[["84ccb949.05e1d8"]]},{"id":"6beefa67.fb0ee4","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":1200,"wires":[["c194b617.dd1318"]]},{"id":"c194b617.dd1318","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1130,"y":1200,"wires":[["ec1d3a57.cb3dc8"]]},{"id":"ec1d3a57.cb3dc8","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1300,"y":1200,"wires":[["52260118.639db"]]},{"id":"93db5ac5.b51bd8","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":740,"y":1240,"wires":[["d314b759.d2bb58"]]},{"id":"d314b759.d2bb58","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":890,"y":1240,"wires":[["e3557b47.521798"]]},{"id":"e3557b47.521798","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1060,"y":1240,"wires":[["a16dc465.95ef28"]]},{"id":"10a52442.b93b5c","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":800,"y":1400,"wires":[["f5963a0c.d6a3a8"]]},{"id":"f5963a0c.d6a3a8","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":950,"y":1400,"wires":[["5366bd6d.583c44"]]},{"id":"5366bd6d.583c44","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":1400,"wires":[["e430b781.0d93b8"]]},{"id":"556d8de7.e54644","type":"comment","z":"b6f7a7df.51a0e8","name":"тут додала","info":"","x":4420,"y":420,"wires":[]},{"id":"48ef2c9e.7f4ed4","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3800,"y":280,"wires":[["45f9a6b1.b01888"]]},{"id":"45f9a6b1.b01888","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":3950,"y":280,"wires":[["d2a083bf.997d9"]]},{"id":"d2a083bf.997d9","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":4120,"y":280,"wires":[["612a815a.34c78","31de654a.9114fa"]]},{"id":"1f409d11.14a663","type":"debug","z":"b6f7a7df.51a0e8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":4730,"y":440,"wires":[]},{"id":"612a815a.34c78","type":"debug","z":"b6f7a7df.51a0e8","name":"11","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":4710,"y":300,"wires":[]},{"id":"56560f7.1921bf","type":"debug","z":"902edb22.d683d8","name":"PPPPP","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":620,"y":1740,"wires":[]},{"id":"c12c274b.06bd58","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":1600,"wires":[["cc7cbc10.9eb6b"]]},{"id":"cc7cbc10.9eb6b","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":830,"y":1600,"wires":[["aec1d747.73d328"]]},{"id":"aec1d747.73d328","type":"function","z":"902edb22.d683d8","name":"","func":"msg.artist = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1000,"y":1600,"wires":[["e48ebcdd.98923","65c5391a.e96058"]]},{"id":"d2277b61.621b08","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture = msg.payload[0];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":1520,"wires":[["c12c274b.06bd58"]]},{"id":"22064ebe.9fb362","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = \"https://api.telegram.org/bot1642349293:AAFs_rRylHYO5VWf0uJe-A897aBfjtoJdu8/getFile\";\nmsg.method = \"GET\";\nmsg.payload = {\n    file_id: msg.text,\n    //url: msg.text\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1060,"y":2060,"wires":[[]]},{"id":"ac7ec8b9.128c28","type":"comment","z":"ee99e200.220c5","name":"1730284858:AAHdzHY6NkNnPRuHMtl6PF1evR8BpcejtyY","info":"","x":890,"y":380,"wires":[]},{"id":"1cffc525.f1089b","type":"comment","z":"ee99e200.220c5","name":"1642349293:AAFs_rRylHYO5VWf0uJe-A897aBfjtoJdu8","info":"","x":880,"y":420,"wires":[]},{"id":"eef15abc.f12d68","type":"comment","z":"7edc0cb0.8be9f4","name":"","info":"","x":1880,"y":300,"wires":[]},{"id":"797efec.2a7aa","type":"link out","z":"b7ea2501.259358","name":"","links":["66a93ff2.bff58"],"x":1015,"y":1180,"wires":[]},{"id":"5bf54365.cb0fbc","type":"debug","z":"b7ea2501.259358","name":"otherwise","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1140,"y":1200,"wires":[]},{"id":"ecf78b61.3d1c08","type":"debug","z":"e35da61b.7ab028","name":"Base","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":290,"y":120,"wires":[]},{"id":"b5704605.303b28","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":710,"y":640,"wires":[[]]},{"id":"a91a57e1.925278","type":"function","z":"e35da61b.7ab028","name":"startNumberMessage","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    templateName: \"startNOTNumberMessage\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":640,"wires":[["b5704605.303b28","24255bac.c6e8f4"]]},{"id":"25a5c874.7a0948","type":"function","z":"e35da61b.7ab028","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"chooseLanguage\",\n    // settings: {\n    //     restart: true,\n    // }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2760,"y":280,"wires":[["9c14f021.ba3ed"]]},{"id":"9c14f021.ba3ed","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2930,"y":280,"wires":[[]]},{"id":"74f62f9b.19a03","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"text","propertyType":"msg","rules":[{"t":"cont","v":"(","vt":"str"},{"t":"cont","v":")","vt":"str"},{"t":"cont","v":".","vt":"str"},{"t":"cont","v":",","vt":"str"},{"t":"cont","v":":","vt":"str"},{"t":"cont","v":";","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":7,"x":1470,"y":2420,"wires":[["9937d440.e74288"],["9937d440.e74288"],["9937d440.e74288"],["9937d440.e74288"],["9937d440.e74288"],["9937d440.e74288"],["691d07d6.5caae8","c68b9dba.1aca6"]]},{"id":"65c5391a.e96058","type":"debug","z":"902edb22.d683d8","name":"PPPPP","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1420,"y":1540,"wires":[]},{"id":"7a7060d7.0c8d4","type":"debug","z":"902edb22.d683d8","name":"PPPPP","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1738.5714111328125,"y":1520,"wires":[]},{"id":"4d9b437.d4eabbc","type":"function","z":"b7ea2501.259358","name":"changeArtistName","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artistName\",\n    type: msg.artistType,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2570,"y":600,"wires":[["20d4ecbd.d93924"]]},{"id":"20d4ecbd.d93924","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2770,"y":560,"wires":[["426e70a.7b8ac9"]]},{"id":"a04d9308.e1658","type":"debug","z":"b7ea2501.259358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2930,"y":520,"wires":[]},{"id":"426e70a.7b8ac9","type":"function","z":"b7ea2501.259358","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"changeArtistName\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2940,"y":560,"wires":[["a04d9308.e1658","c807f6d9.1199d8"]]},{"id":"c807f6d9.1199d8","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":3110,"y":560,"wires":[[]]},{"id":"21babddc.15d992","type":"switch","z":"b7ea2501.259358","name":"","property":"payload.settings.restart","propertyType":"msg","rules":[{"t":"true"},{"t":"false"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":1290,"y":500,"wires":[["bc3e2584.805b18"],["8fafa03d.a42ef"],["bc3e2584.805b18","a9edadca.480a5"]]},{"id":"1fa487ed.13cbe8","type":"function","z":"e35da61b.7ab028","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"chooseLanguage\",\n    settings: {\n        restart: false,\n    }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1220,"y":460,"wires":[["284a082d.801018"]]},{"id":"284a082d.801018","type":"http request","z":"e35da61b.7ab028","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1390,"y":460,"wires":[[]]},{"id":"868e8f63.39a82","type":"switch","z":"b7ea2501.259358","name":"","property":"originalMessage.message.text","propertyType":"msg","rules":[{"t":"nnull"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":1100,"wires":[["80ae6c1c.d4af6"],["7ffe7719.cf69c8"]]},{"id":"cc6a74c5.90df18","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsNOTPictureSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTPictureSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1000,"y":4600,"wires":[["6329d654.36e788"]]},{"id":"6329d654.36e788","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1210,"y":4600,"wires":[[]]},{"id":"9db0e866.4889a8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"if(msg.originalMessage.message.photo) {\n    msg.QQ = true;\n} \nelse msg.QQ = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":640,"y":4600,"wires":[["9fb91ec2.a1061"]]},{"id":"9fb91ec2.a1061","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"QQ","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":4600,"wires":[["af72eb12.2233e8"],["cc6a74c5.90df18"]]},{"id":"d0e4b7a6.099b88","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"if(msg.originalMessage.message.text) {\n    msg.TT = true;\n} \nelse msg.TT = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":640,"y":4640,"wires":[["387378ef.2578a8"]]},{"id":"387378ef.2578a8","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"TT","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":4640,"wires":[["c3b82a05.01c778"],["30bfe1b1.1ff58e"]]},{"id":"30bfe1b1.1ff58e","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsNOTDescriotionSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTDescriotionSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":990,"y":4640,"wires":[["52ef40b4.f4cbc"]]},{"id":"52ef40b4.f4cbc","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1210,"y":4640,"wires":[[]]},{"id":"f6e07129.6ae1b","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"state","propertyType":"msg","rules":[{"t":"cont","v":"editPostImage_","vt":"msg"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":470,"y":800,"wires":[["f8e8f451.93ac88"],["4e59b6d0.4fab78"]]},{"id":"c82f38d8.7887b8","type":"debug","z":"b6f7a7df.51a0e8","name":"= 0","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1070,"y":3420,"wires":[]},{"id":"4643a2f1.d3a4fc","type":"debug","z":"b6f7a7df.51a0e8","name":"= 0","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1670,"y":3420,"wires":[]},{"id":"67b345d4.577e6c","type":"debug","z":"b7ea2501.259358","name":"otherwise","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":720,"y":1140,"wires":[]},{"id":"bf2ec33d.fd3b3","type":"debug","z":"b6f7a7df.51a0e8","name":"= 0","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1410,"y":3420,"wires":[]},{"id":"5aa7fd05.198714","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":3170,"y":4800,"wires":[["1d662f8c.d2422"]]},{"id":"82366acf.fc15d8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.url = msg.imageApiHost + \"/picture\";\nmsg.method = \"POST\";\nmsg.size = msg.text.split(\"-\");\nmsg.payload = {\n    id: msg.payload.settings.picture_id,\n    //height: msg.text.split('-')[0],\n    //width: msg.text.split('-')[1]\n    height: msg.size[0],\n    width: msg.size[1]\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3000,"y":4800,"wires":[["5aa7fd05.198714"]]},{"id":"1d662f8c.d2422","type":"link out","z":"b6f7a7df.51a0e8","name":"","links":["2f8f2d9c.5fcee2"],"x":3295,"y":4800,"wires":[]},{"id":"6dbd07e6.6c5d08","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"msg.size = msg.text.split(\"-\");\n\nif (msg.size[0]!= 0 && msg.size[1]!= 0 && msg.size[1]!= null && msg.size[2]== null) {\n    \n    msg.size = true\n} else msg.size = false\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2420,"y":4560,"wires":[["8bf16ff6.c90e6"]]},{"id":"8bf16ff6.c90e6","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"size","propertyType":"msg","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2550,"y":4560,"wires":[["c11d9f06.a65ee"],["d38c1d7.dc7cbe"]]},{"id":"d38c1d7.dc7cbe","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsNOTSizeSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTSizeSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2990,"y":4640,"wires":[["4f16c194.6f42e"]]},{"id":"4f16c194.6f42e","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":3230,"y":4640,"wires":[[]]},{"id":"c11d9f06.a65ee","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"text","propertyType":"msg","rules":[{"t":"regex","v":"(?=.*[a-zA-Zа-яА-Я])(?=.*)[a-zA-Zа-яА-Я]+","vt":"str","case":false},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2690,"y":4560,"wires":[["d38c1d7.dc7cbe"],["749b9ef4.1f78"]]},{"id":"e59950d7.3ef99","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"if(msg.originalMessage.message.text) {\n    msg.SS = true;\n} \nelse msg.SS = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2140,"y":4580,"wires":[["2dd72a13.7a1846"]]},{"id":"2dd72a13.7a1846","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"SS","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":2270,"y":4580,"wires":[["6dbd07e6.6c5d08"],["d38c1d7.dc7cbe"]]},{"id":"bb72b6e9.ba3008","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"if(msg.originalMessage.message.text) {\n    msg.HH = true;\n} \nelse msg.HH = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":640,"y":4680,"wires":[["a9baf6a.fc39a08"]]},{"id":"a9baf6a.fc39a08","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"HH","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":4680,"wires":[["45504fa6.32ac2"],["b637d210.06ef2"]]},{"id":"b637d210.06ef2","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsNOTDescriotionSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTDescriotionSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1010,"y":4680,"wires":[["3c122702.3ff608"]]},{"id":"3c122702.3ff608","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1230,"y":4680,"wires":[[]]},{"id":"22c0a752.a76dd8","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"if(msg.originalMessage.message.text) {\n    msg.DD = true;\n} \nelse msg.DD = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":640,"y":4720,"wires":[["759a04d7.1b7dbc"]]},{"id":"759a04d7.1b7dbc","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"DD","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":4720,"wires":[["cf7b8ded.1d367"],["bc3899d7.07eb28"]]},{"id":"bc3899d7.07eb28","type":"function","z":"b6f7a7df.51a0e8","name":"artActionsNOTDescriotionSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTDescriotionSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1010,"y":4720,"wires":[["6c164f4b.fd571"]]},{"id":"6c164f4b.fd571","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1230,"y":4720,"wires":[[]]},{"id":"f8e8f451.93ac88","type":"link out","z":"b6f7a7df.51a0e8","name":"","links":["55d9536f.32858c"],"x":605,"y":740,"wires":[]},{"id":"3242454e.4725da","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"backToArtistMenu\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1380,"y":880,"wires":[["7641b37a.608cbc"]]},{"id":"7641b37a.608cbc","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1550,"y":880,"wires":[[]]},{"id":"e84c7b58.b71268","type":"comment","z":"b6f7a7df.51a0e8","name":"","info":"","x":1490,"y":880,"wires":[]},{"id":"3021475d.295f38","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"state","propertyType":"msg","rules":[{"t":"eq","v":"artActionsPostPictureImage","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1010,"y":2140,"wires":[["81d84d98.86476"],["5f01ddc1.2736b4"]]},{"id":"e68c987d.dd03e8","type":"link out","z":"b6f7a7df.51a0e8","name":"","links":["ab50fcfc.4f406"],"x":1615,"y":2140,"wires":[]},{"id":"ab50fcfc.4f406","type":"link in","z":"b7ea2501.259358","name":"","links":["e68c987d.dd03e8"],"x":875,"y":1280,"wires":[["80ae6c1c.d4af6"]]},{"id":"81d84d98.86476","type":"function","z":"b6f7a7df.51a0e8","name":"","func":"if(msg.originalMessage.message.sticker || msg.originalMessage.message.document) {\n    msg.QQ = true;\n} \nelse msg.QQ = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1260,"y":2140,"wires":[["bdde6b2e.efbfe8"]]},{"id":"bdde6b2e.efbfe8","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"QQ","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1410,"y":2140,"wires":[["5f01ddc1.2736b4"],["e68c987d.dd03e8"]]},{"id":"e39e93bf.4db7b","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"state","propertyType":"msg","rules":[{"t":"cont","v":"editPostSize_","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1730,"y":2100,"wires":[["856c83b6.d33bf"],["95353f6d.fca0c"]]},{"id":"856c83b6.d33bf","type":"link out","z":"b6f7a7df.51a0e8","name":"","links":["55d9536f.32858c"],"x":1875,"y":2060,"wires":[]},{"id":"5c335876.26c2e8","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"state","propertyType":"msg","rules":[{"t":"cont","v":"editPostSize_","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":710,"y":1580,"wires":[["fd36dae.09e2328"],["8b432f14.79a5c"]]},{"id":"fd36dae.09e2328","type":"link out","z":"b6f7a7df.51a0e8","name":"","links":["55d9536f.32858c"],"x":835,"y":1580,"wires":[]},{"id":"9ea5ab5.0aa2d58","type":"function","z":"b7ea2501.259358","name":"errorTextStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"errorTextStiker\"\n};\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":600,"y":1960,"wires":[["778be2e3.ee21dc"]]},{"id":"778be2e3.ee21dc","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":770,"y":1960,"wires":[["9a8df5ca.3e5768"]]},{"id":"9a8df5ca.3e5768","type":"function","z":"b7ea2501.259358","name":"errorText","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"errorText\"\n};\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":920,"y":1960,"wires":[["b85298aa.f19fa8"]]},{"id":"b85298aa.f19fa8","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1110,"y":1960,"wires":[[]]},{"id":"296bec18.3fb474","type":"switch","z":"b7ea2501.259358","name":"","property":"state","propertyType":"msg","rules":[{"t":"eq","v":"contactWithAdministrator","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":470,"y":2040,"wires":[[],[]]},{"id":"ad50e279.266bc","type":"switch","z":"b7ea2501.259358","name":"","property":"originalMessage.message.text","propertyType":"msg","rules":[{"t":"nnull"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":350,"y":2040,"wires":[[],[]]},{"id":"95318822.805768","type":"function","z":"902edb22.d683d8","name":"errorTextStiker","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"errorTextStiker\"\n};\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":260,"y":1200,"wires":[["6fb3ceb0.35bdf"]]},{"id":"6fb3ceb0.35bdf","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":430,"y":1200,"wires":[["5e000b49.a66124"]]},{"id":"5e000b49.a66124","type":"function","z":"902edb22.d683d8","name":"errorText","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"errorText\"\n};\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":580,"y":1200,"wires":[["37dc5e0d.a729e2"]]},{"id":"37dc5e0d.a729e2","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":770,"y":1200,"wires":[[]]},{"id":"44a1305b.b602c","type":"comment","z":"902edb22.d683d8","name":"otut","info":"","x":270,"y":960,"wires":[]},{"id":"d2b81d43.b7dd5","type":"function","z":"902edb22.d683d8","name":"","func":"msg.size = msg.text.split(\"-\");\n\nif (msg.size[0]!= 0 && msg.size[1]!= 0 && msg.size[1]!= null && msg.size[2]== null) {\n    \n    msg.size = true\n} else msg.size = false\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":860,"wires":[["dc563694.c24b28"]]},{"id":"dc563694.c24b28","type":"switch","z":"902edb22.d683d8","name":"","property":"size","propertyType":"msg","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":670,"y":860,"wires":[["9f874527.8d8f18"],["c93dd58f.deb458"]]},{"id":"c93dd58f.deb458","type":"function","z":"902edb22.d683d8","name":"artActionsNOTSizeSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTSizeSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1050,"y":900,"wires":[["c52c1da0.cabc5"]]},{"id":"c52c1da0.cabc5","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1270,"y":900,"wires":[[]]},{"id":"9f874527.8d8f18","type":"switch","z":"902edb22.d683d8","name":"","property":"text","propertyType":"msg","rules":[{"t":"regex","v":"(?=.*[a-zA-Zа-яА-Я])(?=.*)[a-zA-Zа-яА-Я]+","vt":"str","case":false},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":860,"wires":[["c93dd58f.deb458"],["a52782f7.5c108"]]},{"id":"cbcddf23.0187c","type":"function","z":"902edb22.d683d8","name":"","func":"if(msg.originalMessage.message.text) {\n    msg.SS = true;\n} \nelse msg.SS = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":260,"y":880,"wires":[["156aae83.2ad271"]]},{"id":"156aae83.2ad271","type":"switch","z":"902edb22.d683d8","name":"","property":"SS","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":390,"y":880,"wires":[["d2b81d43.b7dd5"],["c93dd58f.deb458"]]},{"id":"a52782f7.5c108","type":"switch","z":"902edb22.d683d8","name":"","property":"text","propertyType":"msg","rules":[{"t":"cont","v":".","vt":"str"},{"t":"cont","v":"(","vt":"str"},{"t":"cont","v":")","vt":"str"},{"t":"cont","v":",","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":5,"x":730,"y":900,"wires":[["c93dd58f.deb458"],["c93dd58f.deb458"],["c93dd58f.deb458"],["c93dd58f.deb458"],["cdc25d4.560e6a"]]},{"id":"bc965819.f9c268","type":"switch","z":"902edb22.d683d8","name":"","property":"originalMessage.callback_query.data","propertyType":"msg","rules":[{"t":"eq","v":"artActionsPostPictureDescript","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":130,"y":940,"wires":[["dca1a821.07f628"],["cbcddf23.0187c"]]},{"id":"8a87ab26.e272c8","type":"link in","z":"902edb22.d683d8","name":"","links":["1ebd0f98.fd84b","35b8074c.315968"],"x":385,"y":420,"wires":[["2c5e9c8.1780064"]]},{"id":"9150094e.f272a8","type":"function","z":"902edb22.d683d8","name":"","func":"msg.size = msg.text.split(\"-\");\n\nif (msg.size[0]!= 0 && msg.size[1]!= 0 && msg.size[1]!= null && msg.size[2]== null) {\n    \n    msg.size = true\n} else msg.size = false\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":920,"y":380,"wires":[["83181b32.1c5108"]]},{"id":"83181b32.1c5108","type":"switch","z":"902edb22.d683d8","name":"","property":"size","propertyType":"msg","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1050,"y":380,"wires":[["b33771c5.3ac83"],["80a7d326.5ee8e"]]},{"id":"80a7d326.5ee8e","type":"function","z":"902edb22.d683d8","name":"artActionsNOTSizeSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTSizeSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1430,"y":420,"wires":[["d1e675a4.e19218"]]},{"id":"d1e675a4.e19218","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1650,"y":420,"wires":[[]]},{"id":"b33771c5.3ac83","type":"switch","z":"902edb22.d683d8","name":"","property":"text","propertyType":"msg","rules":[{"t":"regex","v":"(?=.*[a-zA-Zа-яА-Я])(?=.*)[a-zA-Zа-яА-Я]+","vt":"str","case":false},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1190,"y":380,"wires":[["80a7d326.5ee8e"],["6357e1d7.67208"]]},{"id":"a2a29181.44a6b","type":"function","z":"902edb22.d683d8","name":"","func":"if(msg.originalMessage.message.text) {\n    msg.SS = true;\n} \nelse msg.SS = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":640,"y":400,"wires":[["2a900876.e13198"]]},{"id":"2a900876.e13198","type":"switch","z":"902edb22.d683d8","name":"","property":"SS","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":400,"wires":[["9150094e.f272a8"],["80a7d326.5ee8e"]]},{"id":"6357e1d7.67208","type":"switch","z":"902edb22.d683d8","name":"","property":"text","propertyType":"msg","rules":[{"t":"cont","v":".","vt":"str"},{"t":"cont","v":"(","vt":"str"},{"t":"cont","v":")","vt":"str"},{"t":"cont","v":",","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":5,"x":1110,"y":420,"wires":[["80a7d326.5ee8e"],["80a7d326.5ee8e"],["80a7d326.5ee8e"],["80a7d326.5ee8e"],[]]},{"id":"f6d77b7e.2a94c8","type":"function","z":"902edb22.d683d8","name":"","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {\n    //lang: msg.lang,\n    chat_id: msg.picture.artist_id,\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2520,"y":940,"wires":[["a53a6061.d026"]]},{"id":"a53a6061.d026","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2670,"y":940,"wires":[[]]},{"id":"2d0d08fe.936768","type":"function","z":"902edb22.d683d8","name":"","func":"msg.size = msg.text.split(\"-\");\n\nif (msg.size[0]!= 0 && msg.size[1]!= 0 && msg.size[1]!= null && msg.size[2]== null) {\n    \n    msg.size = true\n} else msg.size = false\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1840,"y":940,"wires":[["c9592483.12b6e8"]]},{"id":"c9592483.12b6e8","type":"switch","z":"902edb22.d683d8","name":"","property":"size","propertyType":"msg","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1970,"y":940,"wires":[["d1ed00f.e69ca"],["6a97111e.1c07e"]]},{"id":"6a97111e.1c07e","type":"function","z":"902edb22.d683d8","name":"artActionsNOTSizeSend","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"artActionsNOTSizeSend\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2350,"y":980,"wires":[["60f01987.1c0ba8"]]},{"id":"60f01987.1c0ba8","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2570,"y":980,"wires":[[]]},{"id":"d1ed00f.e69ca","type":"switch","z":"902edb22.d683d8","name":"","property":"text","propertyType":"msg","rules":[{"t":"regex","v":"(?=.*[a-zA-Zа-яА-Я])(?=.*)[a-zA-Zа-яА-Я]+","vt":"str","case":false},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2110,"y":940,"wires":[["6a97111e.1c07e"],["93844672.d1dc68"]]},{"id":"68b25a0b.509884","type":"function","z":"902edb22.d683d8","name":"","func":"if(msg.originalMessage.message.text) {\n    msg.SS = true;\n} \nelse msg.SS = false;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1560,"y":960,"wires":[["c204f94f.8e7e08"]]},{"id":"c204f94f.8e7e08","type":"switch","z":"902edb22.d683d8","name":"","property":"SS","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1690,"y":960,"wires":[["2d0d08fe.936768"],["6a97111e.1c07e"]]},{"id":"93844672.d1dc68","type":"switch","z":"902edb22.d683d8","name":"","property":"text","propertyType":"msg","rules":[{"t":"cont","v":".","vt":"str"},{"t":"cont","v":"(","vt":"str"},{"t":"cont","v":")","vt":"str"},{"t":"cont","v":",","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":5,"x":2030,"y":980,"wires":[["6a97111e.1c07e"],["6a97111e.1c07e"],["6a97111e.1c07e"],["6a97111e.1c07e"],["644b9b3b.eef744"]]},{"id":"40498ac.041a474","type":"switch","z":"902edb22.d683d8","name":"","property":"originalMessage.callback_query.data","propertyType":"msg","rules":[{"t":"eq","v":"artActionsPostPictureDescript","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":430,"y":1020,"wires":[["22fa7fcc.86afa"],["68b25a0b.509884"]]},{"id":"2893f2b.10cb20e","type":"function","z":"902edb22.d683d8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    //state: \"buyerSerchPictures\"\n    state: \"buyerSerchPicturesssss\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":120,"wires":[["daa497b8.77c258"]]},{"id":"daa497b8.77c258","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1190,"y":120,"wires":[[]]},{"id":"1d62638b.81ec0c","type":"link in","z":"902edb22.d683d8","name":"","links":["dca1a821.07f628","22fa7fcc.86afa"],"x":535,"y":160,"wires":[["6353ebe0.36e7e4"]]},{"id":"dca1a821.07f628","type":"link out","z":"902edb22.d683d8","name":"","links":["1d62638b.81ec0c"],"x":225,"y":940,"wires":[]},{"id":"22fa7fcc.86afa","type":"link out","z":"902edb22.d683d8","name":"","links":["1d62638b.81ec0c"],"x":515,"y":1008,"wires":[]},{"id":"dd21ca47.17a348","type":"function","z":"902edb22.d683d8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"backToAdministrator\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2380,"y":1100,"wires":[["43cd5178.e969"]]},{"id":"43cd5178.e969","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2550,"y":1100,"wires":[[]]},{"id":"7ed811c0.eab32","type":"function","z":"902edb22.d683d8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    //state: \"buyerSerchPictures\"backToAdministrator\n    state: \"backToAdministrator\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3220,"y":760,"wires":[["c7f2c9f6.073ce8"]]},{"id":"c7f2c9f6.073ce8","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":3390,"y":760,"wires":[[]]},{"id":"6dac6ba9.a03204","type":"function","z":"7edc0cb0.8be9f4","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"backFromAdministrator\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2880,"y":480,"wires":[["ceaf58ca.14afe8"]]},{"id":"ceaf58ca.14afe8","type":"http request","z":"7edc0cb0.8be9f4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":3050,"y":480,"wires":[[]]},{"id":"54f2fdf0.8e4b74","type":"function","z":"b7ea2501.259358","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"buyerMenuAfterAdministrator\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":1840,"wires":[["bd4e804e.69822"]]},{"id":"bd4e804e.69822","type":"http request","z":"b7ea2501.259358","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1190,"y":1840,"wires":[[]]},{"id":"e0377a13.36af08","type":"function","z":"7edc0cb0.8be9f4","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"backFromAdministrator\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2740,"y":420,"wires":[["2266d6ff.1b9d6a"]]},{"id":"2266d6ff.1b9d6a","type":"http request","z":"7edc0cb0.8be9f4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2910,"y":420,"wires":[[]]},{"id":"53d91523.bdd8bc","type":"comment","z":"7edc0cb0.8be9f4","name":"otut1","info":"","x":2730,"y":380,"wires":[]},{"id":"8c446f3.eeb779","type":"debug","z":"ee99e200.220c5","name":"OOOOOOO","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":950,"y":80,"wires":[]},{"id":"32d244d4.6ba2cc","type":"switch","z":"902edb22.d683d8","name":"","property":"payload.picture","propertyType":"msg","rules":[{"t":"nempty"}],"checkall":"true","repair":false,"outputs":1,"x":470,"y":1800,"wires":[["2d10bb82.533824"]]},{"id":"8b159962.7bf6e8","type":"debug","z":"902edb22.d683d8","name":"PPPPP","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1720,"y":1480,"wires":[]},{"id":"e12c92b1.f4faf","type":"debug","z":"902edb22.d683d8","name":"PPPPP","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1820,"y":1430,"wires":[]},{"id":"18c784e6.e4ac9b","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture = msg.payload[0];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1280,"y":1420,"wires":[[]]},{"id":"f8461a03.629b28","type":"function","z":"902edb22.d683d8","name":"","func":"msg.picture = msg.payload[0].Picture ? msg.payload[0].Picture : msg.payload[0];\nif(msg.picture.Hashtags.length) {\n    msg.picture.hashtags = msg.picture.Hashtags.map(Hashtag => Hashtag.tag).join(' #');\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1208.5714111328125,"y":1518.5714111328125,"wires":[["69841088.be464"]]},{"id":"5fb9817f.11264","type":"comment","z":"902edb22.d683d8","name":"otut","info":"","x":350,"y":1140,"wires":[]},{"id":"ffe802b0.2fac4","type":"comment","z":"b7ea2501.259358","name":"OOOOO","info":"","x":1080,"y":280,"wires":[]},{"id":"affe801f.aea9","type":"debug","z":"b6f7a7df.51a0e8","name":"123","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":890,"y":2360,"wires":[]},{"id":"1cfac09a.bbd95f","type":"debug","z":"b6f7a7df.51a0e8","name":"123","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":890,"y":2400,"wires":[]},{"id":"a5c3782d.e8fed8","type":"debug","z":"b6f7a7df.51a0e8","name":"123","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1050,"y":2340,"wires":[]},{"id":"9d8e8049.d13a1","type":"debug","z":"b6f7a7df.51a0e8","name":"123","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1130,"y":2380,"wires":[]},{"id":"1310a857.a787b8","type":"debug","z":"b6f7a7df.51a0e8","name":"123","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1131.1112060546875,"y":2424.444580078125,"wires":[]},{"id":"18a4872d.5d2c69","type":"debug","z":"b6f7a7df.51a0e8","name":"123","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1310,"y":2360,"wires":[]},{"id":"d1a137b4.5898e8","type":"debug","z":"b6f7a7df.51a0e8","name":"123","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1310,"y":2400,"wires":[]},{"id":"cbda0c05.f3d64","type":"debug","z":"b6f7a7df.51a0e8","name":"123","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1690,"y":2360,"wires":[]},{"id":"c68b9dba.1aca6","type":"debug","z":"b6f7a7df.51a0e8","name":"123","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1690,"y":2400,"wires":[]},{"id":"749b9ef4.1f78","type":"switch","z":"b6f7a7df.51a0e8","name":"","property":"text","propertyType":"msg","rules":[{"t":"cont","v":"(","vt":"str"},{"t":"cont","v":")","vt":"str"},{"t":"cont","v":".","vt":"str"},{"t":"cont","v":",","vt":"str"},{"t":"cont","v":":","vt":"str"},{"t":"cont","v":";","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":7,"x":2590,"y":4660,"wires":[["d38c1d7.dc7cbe"],["d38c1d7.dc7cbe"],["d38c1d7.dc7cbe"],["d38c1d7.dc7cbe"],["d38c1d7.dc7cbe"],["d38c1d7.dc7cbe"],["338c4f43.4ae87"]]},{"id":"f59a9c8f.1ff3","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"backToAdministrator\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2660,"y":2600,"wires":[["82fc6e08.775d1"]]},{"id":"82fc6e08.775d1","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2830,"y":2600,"wires":[[]]},{"id":"7760a800.956188","type":"comment","z":"b6f7a7df.51a0e8","name":"otut","info":"","x":2640,"y":2560,"wires":[]},{"id":"7f7d1116.43de7","type":"function","z":"902edb22.d683d8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"buyerSerchPictures\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1520,"y":300,"wires":[["6fa8d2cf.fb36bc"]]},{"id":"6fa8d2cf.fb36bc","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1700,"y":300,"wires":[[]]},{"id":"98377912.2d2df8","type":"comment","z":"902edb22.d683d8","name":"otut","info":"","x":1510,"y":260,"wires":[]},{"id":"2c8aafb6.fe745","type":"comment","z":"902edb22.d683d8","name":"otut","info":"","x":1030,"y":160,"wires":[]},{"id":"ea3268bd.359628","type":"comment","z":"902edb22.d683d8","name":"?","info":"","x":650,"y":1080,"wires":[]},{"id":"21d5e9cf.b8c556","type":"switch","z":"902edb22.d683d8","name":"","property":"payload.length","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":1060,"wires":[["4e95f733.a3b768"],["a2be1edc.9c484"]]},{"id":"ed74124d.3a797","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":790,"y":1020,"wires":[]},{"id":"a2be1edc.9c484","type":"function","z":"902edb22.d683d8","name":"buyerNOTSearchBySize","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerNOTSearchBySize\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1010,"y":1160,"wires":[["609aca5f.412734"]]},{"id":"609aca5f.412734","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1230,"y":1160,"wires":[[]]},{"id":"a4c0ecce.23f19","type":"function","z":"902edb22.d683d8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"backToAdministrator\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2380,"y":1060,"wires":[["8fcfc497.9b3038"]]},{"id":"8fcfc497.9b3038","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":2550,"y":1060,"wires":[[]]},{"id":"ee50638a.d06c8","type":"switch","z":"902edb22.d683d8","name":"","property":"payload.length","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":470,"y":620,"wires":[["24a011df.8479de"],["aeab7f9e.bb256"]]},{"id":"aeab7f9e.bb256","type":"function","z":"902edb22.d683d8","name":"buyerNOTSearchByArtist","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerNOTSearchByArtist\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":710,"y":620,"wires":[["c5d7f50a.93ba98"]]},{"id":"c5d7f50a.93ba98","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":930,"y":620,"wires":[[]]},{"id":"4a9ea644.799408","type":"switch","z":"902edb22.d683d8","name":"","property":"payload.length","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":650,"y":540,"wires":[["47981ae9.751314"],["6a91afcc.46e4b"]]},{"id":"6a91afcc.46e4b","type":"function","z":"902edb22.d683d8","name":"buyerNOTSearchByCategory","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerNOTSearchByCategory\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":900,"y":540,"wires":[["8bc9eb58.021b98"]]},{"id":"8bc9eb58.021b98","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":1110,"y":540,"wires":[[]]},{"id":"fcbe043b.cfa248","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":590,"y":1540,"wires":[]},{"id":"25e36ca6.038d24","type":"switch","z":"902edb22.d683d8","name":"","property":"payload.length","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":410,"y":1540,"wires":[["bba92113.71523"],["1e206f8f.dcb6f"]]},{"id":"1e206f8f.dcb6f","type":"function","z":"902edb22.d683d8","name":"buyerNOTFavouritePicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerNOTFavouritePicture\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":660,"y":1540,"wires":[["e279b3b3.92e14"]]},{"id":"e279b3b3.92e14","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":870,"y":1540,"wires":[[]]},{"id":"8f3258e7.48c338","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":650,"y":1260,"wires":[]},{"id":"a227b59f.36a8d8","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":690,"y":1340,"wires":[]},{"id":"9786e975.8e9e68","type":"switch","z":"902edb22.d683d8","name":"","property":"payload.length","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":510,"y":1320,"wires":[["d9667d84.b140e"],["b27a67e.0299198"]]},{"id":"b27a67e.0299198","type":"function","z":"902edb22.d683d8","name":"buyerNOTViewedPicture","func":"msg.url = msg.messageApiHost + \"/sendMessage\";\nmsg.method = \"POST\";\nmsg.type = msg.payload.type;\nmsg.payload = {\n    chat_id: msg.chat_id,\n    lang: msg.lang,\n    templateName: \"buyerNOTViewedPicture\",\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":750,"y":1340,"wires":[["7c62d1c2.0b3e6"]]},{"id":"7c62d1c2.0b3e6","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":970,"y":1340,"wires":[[]]},{"id":"3177a68d.345d6a","type":"comment","z":"902edb22.d683d8","name":"5 byHistorySearchType","info":"","x":2240,"y":780,"wires":[]},{"id":"a9edadca.480a5","type":"debug","z":"b7ea2501.259358","name":"OOOOOOLLLLIIIIIIIAAAAA","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1460,"y":560,"wires":[]},{"id":"cb222ca7.a5b4d","type":"switch","z":"e35da61b.7ab028","name":"","property":"state","propertyType":"msg","rules":[{"t":"eq","v":"buyerSerchPicturesssss","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":690,"y":300,"wires":[["11a91b72.7f2615"],["4ea2ccd.464fb34","f9fba446.f1dc08"]]},{"id":"4ea2ccd.464fb34","type":"switch","z":"e35da61b.7ab028","name":"","property":"text","propertyType":"msg","rules":[{"t":"cont","v":"statisic","vt":"str"},{"t":"cont","v":"artistIdSPic","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":830,"y":320,"wires":[[],["7d746bb4.ce82d4"],["2f7bd538.90f86a","2afffb2f.b1f154"]]},{"id":"11a91b72.7f2615","type":"link out","z":"e35da61b.7ab028","name":"","links":["335432b5.fe907e"],"x":1035,"y":300,"wires":[]},{"id":"e85ef12.be68d1","type":"link in","z":"e35da61b.7ab028","name":"","links":["d8d1eb90.214f08"],"x":875,"y":360,"wires":[["2f7bd538.90f86a"]]},{"id":"d8d1eb90.214f08","type":"link out","z":"902edb22.d683d8","name":"","links":["e85ef12.be68d1"],"x":205,"y":500,"wires":[]},{"id":"66221561.86d3ac","type":"switch","z":"b7ea2501.259358","name":"","property":"state","propertyType":"msg","rules":[{"t":"eq","v":"startNumberMessage","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":350,"y":680,"wires":[["8ad96a68.cabe58"],["eb2682b.220b48"]]},{"id":"8ad96a68.cabe58","type":"link out","z":"b7ea2501.259358","name":"","links":["66a93ff2.bff58"],"x":435,"y":700,"wires":[]},{"id":"922880fe.14ead","type":"function","z":"902edb22.d683d8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    //state: \"buyerSerchPictures\"backToAdministrator\n    //state: \"backToAdministratorAndBuyerMenu\"\n    state: \"viewHistory\"\n    \n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3220,"y":820,"wires":[["640d86fa.94b2d8"]]},{"id":"640d86fa.94b2d8","type":"http request","z":"902edb22.d683d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":3390,"y":820,"wires":[["2f22a7b2.e092c8"]]},{"id":"2f22a7b2.e092c8","type":"debug","z":"902edb22.d683d8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":3470,"y":880,"wires":[]},{"id":"eaa89f43.248e8","type":"comment","z":"902edb22.d683d8","name":"http://localhost:300","info":"","x":180,"y":660,"wires":[]},{"id":"72a28b6e.df0034","type":"dialogflowv2","z":"7edc0cb0.8be9f4","dialogflow":"2da1a901.60cf06","language":"uk","debug":false,"queryParamsOK":false,"x":560,"y":260,"wires":[["d54db84a.7b2298","cb81bc1f.bb9e4"]]},{"id":"d5f58e9c.29b7c","type":"function","z":"b6f7a7df.51a0e8","name":"set state","func":"msg.url = msg.userApiHost + \"/user\";\nmsg.method = \"POST\";\nmsg.payload = {  \n    chat_id: msg.chat_id,\n    state: \"backToAdministrator\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":820,"y":1300,"wires":[["f3a67aa9.eeb308"]]},{"id":"f3a67aa9.eeb308","type":"http request","z":"b6f7a7df.51a0e8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"","persist":false,"proxy":"","authType":"","x":990,"y":1300,"wires":[[]]},{"id":"c96edbde.b10b18","type":"comment","z":"b6f7a7df.51a0e8","name":"otut","info":"","x":810,"y":1260,"wires":[]},{"id":"6dfa2fc1.c023d","type":"link in","z":"902edb22.d683d8","name":"","links":["94e12094.4b113","7d746bb4.ce82d4"],"x":35,"y":540,"wires":[["17212412.11491c"]]},{"id":"1fc1a187.e00f5e","type":"comment","z":"902edb22.d683d8","name":"artistIdSPic","info":"","x":70,"y":460,"wires":[]},{"id":"9ee45bf8.e12518","type":"debug","z":"e35da61b.7ab028","name":"1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":630,"y":340,"wires":[]},{"id":"f9fba446.f1dc08","type":"debug","z":"e35da61b.7ab028","name":"1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":830,"y":520,"wires":[]},{"id":"2afffb2f.b1f154","type":"debug","z":"e35da61b.7ab028","name":"1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1018,"y":540,"wires":[]},{"id":"7d746bb4.ce82d4","type":"link out","z":"e35da61b.7ab028","name":"","links":["6dfa2fc1.c023d"],"x":935,"y":320,"wires":[]}]